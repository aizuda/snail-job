import{b9 as de,ba as se,d as F,aj as Z,bb as st,cg as it,r as y,a as ne,i as Ve,cd as Vt,ch as Bt,q as W,an as pe,bK as He,b8 as Q,ci as Tt,cj as Ct,bx as Dt,ck as Lt,cl as Ut,bt as Rt,b_ as et,U as It,bD as Mt,cm as jt,cn as Et,bc as dt,co as zt,cp as At,bM as Ot,be as Ht,cq as Yt,aR as ie,b as C,o as p,e as b,cr as ye,v as fe,a3 as K,a4 as ae,s as ce,x as we,l as ve,cs as qt,ct as Xt,c as I,D as Xe,aZ as De,w as l,g as S,f as n,t as $,B as re,cu as Le,cv as Ue,H as Re,C as Ie,ad as Me,E as je,h,cw as Wt,cx as We,Z as _e,$ as R,aA as Pt,a7 as ke,ai as Ft,cy as rt,cz as Pe,a0 as Gt,a1 as Jt,cA as ut,cB as Zt,Q as B,at as Kt,au as Qt,as as ct,aI as Se,cC as J,cD as tt,cE as ot,cF as nt,N as Fe,cG as eo,ah as pt,_ as Ee,cH as to,cI as mt,cJ as oo,cK as Ye,cL as no,aM as lo,aN as ft,cM as ao,cN as so,aH as io,bj as ro,cO as uo}from "./index-DWIswSJW.js";import{H as co,j as po,e as mo,_ as fo,g as vt}from "./job-task-list-table.vue_vue_type_script_setup_true_lang-CYWU96B2.js";import{j as vo,k as ho,l as bo,m as go}from "./workflow-C4ZkKhO8.js";import{k as _o,l as wo}from "./job-DBpejsO9.js";import{L as yo}from "./label-list-GpdzQygX.js";import{_ as ze,a as Ae,e as ko,c as No,d as xo}from "./Grid-DoBPPIj4.js";import{_ as Be}from "./detail-drawer-BKXWqHWo.js";import{_ as Ne,a as xe}from "./DescriptionsItem-BBDEmqXH.js";import{_ as $o}from "./log-drawer-BB9PXuVe.js";import{_ as ht}from "./dynamic-input.vue_vue_type_script_setup_true_lang-ButiGr3s.js";import{_ as So,s as Vo,o as Bo,j as To}from "./code-mirror-DNOiCYNp.js";import{_ as Co}from "./system-user.vue_vue_type_script_setup_true_lang-D4BoOiCA.js";import{_ as Do}from "./job-trigger-interval.vue_vue_type_script_setup_true_lang-CHmYvSq4.js";import{f as Lo}from "./notify-0dRZi4kM.js";import{g as Uo}from "./group-pdx_vdG9.js";function Ro(e){return typeof e=="string"?document.querySelector(e):typeof e=="function"?e():e}const Io=de("affix",[se("affixed",{position:"fixed"},[se("absolute-positioned",{position:"absolute"})])]);function Mo(e){return e instanceof HTMLElement?e.scrollTop:window.scrollY}function jo(e){return e instanceof HTMLElement?e.getBoundingClientRect():{top:0,bottom:window.innerHeight}}const Eo={listenTo:[String,Object,Function],top:Number,bottom:Number,triggerTop:Number,triggerBottom:Number,position:{type:String,default:"fixed"},offsetTop:{type:Number,validator:()=>!0,default:void 0},offsetBottom:{type:Number,validator:()=>!0,default:void 0},target:{type:Function,validator:()=>!0,default:void 0}},zo=F({name:"Affix",props:Eo,setup(e){const{mergedClsPrefixRef:a}=st(e);it("-affix",Io,a);let i=null;const f=y(!1),s=y(!1),t=y(null),o=y(null),g=ne(()=>s.value||f.value),u=ne(()=>{var T,_;return(_=(T=e.triggerTop)!==null&&T!==void 0?T:e.offsetTop)!==null&&_!==void 0?_:e.top}),d=ne(()=>{var T,_;return(_=(T=e.top)!==null&&T!==void 0?T:e.triggerTop)!==null&&_!==void 0?_:e.offsetTop}),r=ne(()=>{var T,_;return(_=(T=e.bottom)!==null&&T!==void 0?T:e.triggerBottom)!==null&&_!==void 0?_:e.offsetBottom}),c=ne(()=>{var T,_;return(_=(T=e.triggerBottom)!==null&&T!==void 0?T:e.offsetBottom)!==null&&_!==void 0?_:e.bottom}),N=y(null),w=()=>{const{target:T,listenTo:_}=e;T?i=T():_?i=Ro(_):i=document,i&&(i.addEventListener("scroll",m),m())};function m(){Bt(x)}function x(){const{value:T}=N;if(!i||!T)return;const _=Mo(i);if(g.value){o.value!==null&&_<o.value&&(f.value=!1,o.value=null),t.value!==null&&_>t.value&&(s.value=!1,t.value=null);return}const D=jo(i),M=T.getBoundingClientRect(),L=M.top-D.top,P=D.bottom-M.bottom,v=u.value,V=c.value;v!==void 0&&L<=v?(f.value=!0,o.value=_-(v-L)):(f.value=!1,o.value=null),V!==void 0&&P<=V?(s.value=!0,t.value=_+V-P):(s.value=!1,t.value=null)}return Ve(()=>{w()}),Vt(()=>{i&&i.removeEventListener("scroll",m)}),{selfRef:N,affixed:g,mergedClsPrefix:a,mergedstyle:ne(()=>{const T={};return f.value&&u.value!==void 0&&d.value!==void 0&&(T.top=`${d.value}px`),s.value&&c.value!==void 0&&r.value!==void 0&&(T.bottom=`${r.value}px`),T})}},render(){const{mergedClsPrefix:e}=this;return Z("div",{ref:"selfRef",class:[`${e}-affix`,{[`${e}-affix--affixed`]:this.affixed,[`${e}-affix--absolute-positioned`]:this.position==="absolute"}],style:this.mergedstyle},this.$slots)}}),lt=F({name:"SlotMachineNumber",props:{clsPrefix:{type:String,required:!0},value:{type:[Number,String],required:!0},oldOriginalNumber:{type:Number,default:void 0},newOriginalNumber:{type:Number,default:void 0}},setup(e){const a=y(null),i=y(e.value),f=y(e.value),s=y("up"),t=y(!1),o=ne(()=>t.value?`${e.clsPrefix}-base-slot-machine-current-number--${s.value}-scroll`:null),g=ne(()=>t.value?`${e.clsPrefix}-base-slot-machine-old-number--${s.value}-scroll`:null);W(He(e,"value"),(r, c)=>{i.value=c,f.value=r,pe(u)});function u(){const r=e.newOriginalNumber,c=e.oldOriginalNumber;c===void 0||r===void 0||(r>c?d("up"):c>r&&d("down"))}function d(r){s.value=r,t.value=!1,pe(()=>{var c;(c=a.value)===null||c===void 0||c.offsetWidth,t.value=!0})}return()=>{const{clsPrefix:r}=e;return Z("span",{ref:a,class:`${r}-base-slot-machine-number`},i.value!==null?Z("span",{class:[`${r}-base-slot-machine-old-number ${r}-base-slot-machine-old-number--top`,g.value]},i.value):null,Z("span",{class:[`${r}-base-slot-machine-current-number`,o.value]},Z("span",{ref:"numberWrapper",class:[`${r}-base-slot-machine-current-number__inner`,typeof e.value!="number"&&`${r}-base-slot-machine-current-number__inner--not-number`]},f.value)),i.value!==null?Z("span",{class:[`${r}-base-slot-machine-old-number ${r}-base-slot-machine-old-number--bottom`,g.value]},i.value):null)}}}),{cubicBezierEaseOut:ge}=Tt;function Ao({duration:e=".2s"}={}){return[Q("&.fade-up-width-expand-transition-leave-active",{transition:`
 opacity ${e} ${ge},
 max-width ${e} ${ge},
 transform ${e} ${ge}
 `}),Q("&.fade-up-width-expand-transition-enter-active",{transition:`
 opacity ${e} ${ge},
 max-width ${e} ${ge},
 transform ${e} ${ge}
 `}),Q("&.fade-up-width-expand-transition-enter-to",{opacity:1,transform:"translateX(0) translateY(0)"}),Q("&.fade-up-width-expand-transition-enter-from",{maxWidth:"0 !important",opacity:0,transform:"translateY(60%)"}),Q("&.fade-up-width-expand-transition-leave-from",{opacity:1,transform:"translateY(0)"}),Q("&.fade-up-width-expand-transition-leave-to",{maxWidth:"0 !important",opacity:0,transform:"translateY(60%)"})]}const Oo=Q([Q("@keyframes n-base-slot-machine-fade-up-in",`
 from {
 transform: translateY(60%);
 opacity: 0;
 }
 to {
 transform: translateY(0);
 opacity: 1;
 }
 `),Q("@keyframes n-base-slot-machine-fade-down-in",`
 from {
 transform: translateY(-60%);
 opacity: 0;
 }
 to {
 transform: translateY(0);
 opacity: 1;
 }
 `),Q("@keyframes n-base-slot-machine-fade-up-out",`
 from {
 transform: translateY(0%);
 opacity: 1;
 }
 to {
 transform: translateY(-60%);
 opacity: 0;
 }
 `),Q("@keyframes n-base-slot-machine-fade-down-out",`
 from {
 transform: translateY(0%);
 opacity: 1;
 }
 to {
 transform: translateY(60%);
 opacity: 0;
 }
 `),de("base-slot-machine",`
 overflow: hidden;
 white-space: nowrap;
 display: inline-block;
 height: 18px;
 line-height: 18px;
 `,[de("base-slot-machine-number",`
 display: inline-block;
 position: relative;
 height: 18px;
 width: .6em;
 max-width: .6em;
 `,[Ao({duration:".2s"}),Ct({duration:".2s",delay:"0s"}),de("base-slot-machine-old-number",`
 display: inline-block;
 opacity: 0;
 position: absolute;
 left: 0;
 right: 0;
 `,[se("top",{transform:"translateY(-100%)"}),se("bottom",{transform:"translateY(100%)"}),se("down-scroll",{animation:"n-base-slot-machine-fade-down-out .2s cubic-bezier(0, 0, .2, 1)",animationIterationCount:1}),se("up-scroll",{animation:"n-base-slot-machine-fade-up-out .2s cubic-bezier(0, 0, .2, 1)",animationIterationCount:1})]),de("base-slot-machine-current-number",`
 display: inline-block;
 position: absolute;
 left: 0;
 top: 0;
 bottom: 0;
 right: 0;
 opacity: 1;
 transform: translateY(0);
 width: .6em;
 `,[se("down-scroll",{animation:"n-base-slot-machine-fade-down-in .2s cubic-bezier(0, 0, .2, 1)",animationIterationCount:1}),se("up-scroll",{animation:"n-base-slot-machine-fade-up-in .2s cubic-bezier(0, 0, .2, 1)",animationIterationCount:1}),Dt("inner",`
 display: inline-block;
 position: absolute;
 right: 0;
 top: 0;
 width: .6em;
 `,[se("not-number",`
 right: unset;
 left: 0;
 `)])])])])]),Ho=F({name:"BaseSlotMachine",props:{clsPrefix:{type:String,required:!0},value:{type:[Number,String],default:0},max:{type:Number,default:void 0},appeared:{type:Boolean,required:!0}},setup(e){it("-base-slot-machine",Oo,He(e,"clsPrefix"));const a=y(),i=y(),f=ne(()=>{if(typeof e.value=="string")return[];if(e.value<1)return[0];const s=[];let t=e.value;for(e.max!==void 0&&(t=Math.min(e.max,t));t>=1;)s.push(t%10),t/=10,t=Math.floor(t);return s.reverse(),s});return W(He(e,"value"),(s,t)=>{typeof s=="string"?(i.value=void 0,a.value=void 0):typeof t=="string"?(i.value=s,a.value=void 0):(i.value=s,a.value=t)}),()=>{const{value:s,clsPrefix:t}=e;return typeof s=="number"?Z("span",{class:`${t}-base-slot-machine`},Z(Lt,{name:"fade-up-width-expand-transition",tag:"span"},{default:()=>f.value.map((o,g)=>Z(lt,{clsPrefix:t,key:f.value.length-g-1,oldOriginalNumber:a.value,newOriginalNumber:i.value,value:o}))}),Z(Ut,{key:"+",width:!0},{default:()=>e.max!==void 0&&e.max<s?Z(lt,{clsPrefix:t,value:"+"}):null})):Z("span",{class:`${t}-base-slot-machine`},s)}}});function Yo(e){const{errorColor:a,infoColor:i,successColor:f,warningColor:s,fontFamily:t}=e;return{color:a,colorInfo:i,colorSuccess:f,colorError:a,colorWarning:s,fontSize:"12px",fontFamily:t}}const qo={common:Rt,self:Yo},Xo=Q([Q("@keyframes badge-wave-spread",{from:{boxShadow:"0 0 0.5px 0px var(--n-ripple-color)",opacity:.6},to:{boxShadow:"0 0 0.5px 4.5px var(--n-ripple-color)",opacity:0}}),de("badge",`
 display: inline-flex;
 position: relative;
 vertical-align: middle;
 font-family: var(--n-font-family);
 `,[se("as-is",[de("badge-sup",{position:"static",transform:"translateX(0)"},[et({transformOrigin:"left bottom",originalTransform:"translateX(0)"})])]),se("dot",[de("badge-sup",`
 height: 8px;
 width: 8px;
 padding: 0;
 min-width: 8px;
 left: 100%;
 bottom: calc(100% - 4px);
 `,[Q("::before","border-radius: 4px;")])]),de("badge-sup",`
 background: var(--n-color);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 color: #FFF;
 position: absolute;
 height: 18px;
 line-height: 18px;
 border-radius: 9px;
 padding: 0 6px;
 text-align: center;
 font-size: var(--n-font-size);
 transform: translateX(-50%);
 left: 100%;
 bottom: calc(100% - 9px);
 font-variant-numeric: tabular-nums;
 z-index: 2;
 display: flex;
 align-items: center;
 `,[et({transformOrigin:"left bottom",originalTransform:"translateX(-50%)"}),de("base-wave",{zIndex:1,animationDuration:"2s",animationIterationCount:"infinite",animationDelay:"1s",animationTimingFunction:"var(--n-ripple-bezier)",animationName:"badge-wave-spread"}),Q("&::before",`
 opacity: 0;
 transform: scale(1);
 border-radius: 9px;
 content: "";
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `)])])]),Wo=Object.assign(Object.assign({},dt.props),{value:[String,Number],max:Number,dot:Boolean,type:{type:String,default:"default"},show:{type:Boolean,default:!0},showZero:Boolean,processing:Boolean,color:String,offset:Array}),Te=F({name:"Badge",props:Wo,setup(e,{slots:a}){const{mergedClsPrefixRef:i,inlineThemeDisabled:f,mergedRtlRef:s}=st(e),t=dt("Badge","-badge",Xo,qo,e,i),o=y(!1),g=()=>{o.value=!0},u=()=>{o.value=!1},d=ne(()=>e.show&&(e.dot||e.value!==void 0&&!(!e.showZero&&Number(e.value)<=0)||!zt(a.value)));Ve(()=>{d.value&&(o.value=!0)});const r=At("Badge",s,i),c=ne(()=>{const{type:m,color:x}=e,{common:{cubicBezierEaseInOut:T,cubicBezierEaseOut:_},self:{[Ot("color",m)]:D,fontFamily:M,fontSize:L}}=t.value;return{"--n-font-size":L,"--n-font-family":M,"--n-color":x||D,"--n-ripple-color":x||D,"--n-bezier":T,"--n-ripple-bezier":_}}),N=f?Ht("badge",ne(()=>{let m="";const{type:x,color:T}=e;return x&&(m+=x[0]),T&&(m+=Yt(T)),m}),c,e):void 0,w=ne(()=>{const{offset:m}=e;if(!m)return;const[x,T]=m,_=typeof x=="number"?`${x}px`:x,D=typeof T=="number"?`${T}px`:T;return{transform:`translate(calc(${r!=null&&r.value?"50%":"-50%"} + ${_}), ${D})`}});return{rtlEnabled:r,mergedClsPrefix:i,appeared:o,showBadge:d,handleAfterEnter:g,handleAfterLeave:u,cssVars:f?void 0:c,themeClass:N==null?void 0:N.themeClass,onRender:N==null?void 0:N.onRender,offsetStyle:w}},render(){var e;const{mergedClsPrefix:a,onRender:i,themeClass:f,$slots:s}=this;i==null||i();const t=(e=s.default)===null||e===void 0?void 0:e.call(s);return Z("div",{class:[`${a}-badge`,this.rtlEnabled&&`${a}-badge--rtl`,f,{[`${a}-badge--dot`]:this.dot,[`${a}-badge--as-is`]:!t}],style:this.cssVars},t,Z(It,{name:"fade-in-scale-up-transition",onAfterEnter:this.handleAfterEnter,onAfterLeave:this.handleAfterLeave},{default:()=>this.showBadge?Z("sup",{class:`${a}-badge-sup`,title:Mt(this.value),style:this.offsetStyle},jt(s.value,()=>[this.dot?null:Z(Ho,{clsPrefix:a,appeared:this.appeared,max:this.max,value:this.value})]),this.processing?Z(Et,{clsPrefix:a}):null):null}))}}),Po={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function Fo(e,a){return p(),C("svg",Po,a[0]||(a[0]=[b("path",{fill:"currentColor",d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8"},null,-1),b("path",{fill:"currentColor",d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8Z"},null,-1)]))}const bt=ie({name:"ant-design-plus-outlined",render:Fo}),Go={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function Jo(e,a){return p(),C("svg",Go,a[0]||(a[0]=[b("path",{fill:"currentColor",d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8"},null,-1)]))}const Zo=ie({name:"ant-design-minus-outlined",render:Jo}),at={y:{t:"top",m:"marginTop",b:"bottom"},x:{l:"left",m:"marginLeft",r:"right"}};function Ko(e){e.forEach((a,i)=>{document.documentElement.addEventListener(i,a)})}function Qo(e){e.forEach((a,i)=>{document.documentElement.removeEventListener(i,a)})}const en={name:"vue-drag-resize",emits:["clicked","dragging","dragstop","resizing","resizestop","activated","deactivated"],props:{stickSize:{type:Number,default:8},parentScaleX:{type:Number,default:1},parentScaleY:{type:Number,default:1},isActive:{type:Boolean,default:!1},preventActiveBehavior:{type:Boolean,default:!1},isDraggable:{type:Boolean,default:!0},isResizable:{type:Boolean,default:!0},aspectRatio:{type:Boolean,default:!1},parentLimitation:{type:Boolean,default:!1},snapToGrid:{type:Boolean,default:!1},gridX:{type:Number,default:50,validator(e){return e>=0}},gridY:{type:Number,default:50,validator(e){return e>=0}},parentW:{type:Number,default:0,validator(e){return e>=0}},parentH:{type:Number,default:0,validator(e){return e>=0}},w:{type:[String,Number],default:200,validator(e){return typeof e=="string"?e==="auto":e>=0}},h:{type:[String,Number],default:200,validator(e){return typeof e=="string"?e==="auto":e>=0}},minw:{type:Number,default:50,validator(e){return e>=0}},minh:{type:Number,default:50,validator(e){return e>=0}},x:{type:Number,default:0,validator(e){return typeof e=="number"}},y:{type:Number,default:0,validator(e){return typeof e=="number"}},z:{type:[String,Number],default:"auto",validator(e){return typeof e=="string"?e==="auto":e>=0}},dragHandle:{type:String,default:null},dragCancel:{type:String,default:null},sticks:{type:Array,default(){return["tl","tm","tr","mr","br","bm","bl","ml"]}},axis:{type:String,default:"both",validator(e){return["x","y","both","none"].indexOf(e)!==-1}},contentClass:{type:String,required:!1,default:""}},data(){return{fixAspectRatio:null,active:null,zIndex:null,parentWidth:null,parentHeight:null,left:null,top:null,right:null,bottom:null,minHeight:null}},beforeCreate(){this.stickDrag=!1,this.bodyDrag=!1,this.dimensionsBeforeMove={pointerX:0,pointerY:0,x:0,y:0,w:0,h:0},this.limits={left:{min:null,max:null},right:{min:null,max:null},top:{min:null,max:null},bottom:{min:null,max:null}},this.currentStick=null},mounted(){this.parentElement=this.$el.parentNode,this.parentWidth=this.parentW?this.parentW:this.parentElement.clientWidth,this.parentHeight=this.parentH?this.parentH:this.parentElement.clientHeight,this.left=this.x,this.top=this.y,this.right=this.parentWidth-(this.w==="auto"?this.$refs.container.scrollWidth:this.w)-this.left,this.bottom=this.parentHeight-(this.h==="auto"?this.$refs.container.scrollHeight:this.h)-this.top,this.domEvents=new Map([["mousemove",this.move],["mouseup",this.up],["mouseleave",this.up],["mousedown",this.deselect],["touchmove",this.move],["touchend",this.up],["touchcancel",this.up],["touchstart",this.up]]),Ko(this.domEvents),this.dragHandle&&[...this.$el.querySelectorAll(this.dragHandle)].forEach(e=>{e.setAttribute("data-drag-handle",this._uid)}),this.dragCancel&&[...this.$el.querySelectorAll(this.dragCancel)].forEach(e=>{e.setAttribute("data-drag-cancel",this._uid)})},beforeDestroy(){Qo(this.domEvents)},methods:{deselect(){this.preventActiveBehavior||(this.active=!1)},move(e){if(!this.stickDrag&&!this.bodyDrag)return;e.stopPropagation();const a=typeof e.pageX<"u"?e.pageX:e.touches[0].pageX,i=typeof e.pageY<"u"?e.pageY:e.touches[0].pageY,{dimensionsBeforeMove:f}=this,s={x:(f.pointerX-a)/this.parentScaleX,y:(f.pointerY-i)/this.parentScaleY};if(this.stickDrag&&this.stickMove(s),this.bodyDrag){if(this.axis==="x")s.y=0;else if(this.axis==="y")s.x=0;else if(this.axis==="none")return;this.bodyMove(s)}},up(e){this.stickDrag?this.stickUp(e):this.bodyDrag&&this.bodyUp(e)},bodyDown(e){const{target:a,button:i}=e;if(this.preventActiveBehavior||(this.active=!0),i&&i!==0||(this.$emit("clicked",e),!this.active)||this.dragHandle&&a.getAttribute("data-drag-handle")!==this._uid.toString()||this.dragCancel&&a.getAttribute("data-drag-cancel")===this._uid.toString())return;typeof e.stopPropagation<"u"&&e.stopPropagation(),typeof e.preventDefault<"u"&&e.preventDefault(),this.isDraggable&&(this.bodyDrag=!0);const f=typeof e.pageX<"u"?e.pageX:e.touches[0].pageX,s=typeof e.pageY<"u"?e.pageY:e.touches[0].pageY;this.saveDimensionsBeforeMove({pointerX:f,pointerY:s}),this.parentLimitation&&(this.limits=this.calcDragLimitation())},bodyMove(e){const{dimensionsBeforeMove:a,parentWidth:i,parentHeight:f,gridX:s,gridY:t,width:o,height:g}=this;let u=a.top-e.y,d=a.bottom+e.y,r=a.left-e.x,c=a.right+e.x;if(this.snapToGrid){let N=!0,w=!0,m=u-Math.floor(u/t)*t,x=f-d-Math.floor((f-d)/t)*t,T=r-Math.floor(r/s)*s,_=i-c-Math.floor((i-c)/s)*s;m>t/2&&(m-=t),x>t/2&&(x-=t),T>s/2&&(T-=s),_>s/2&&(_-=s),Math.abs(x)<Math.abs(m)&&(N=!1),Math.abs(_)<Math.abs(T)&&(w=!1),u-=N?m:x,d=f-g-u,r-=w?T:_,c=i-o-r}({newLeft:this.left,newRight:this.right,newTop:this.top,newBottom:this.bottom}=this.rectCorrectionByLimit({newLeft:r,newRight:c,newTop:u,newBottom:d})),this.$emit("dragging",this.rect)},bodyUp(){this.bodyDrag=!1,this.$emit("dragging",this.rect),this.$emit("dragstop",this.rect),this.dimensionsBeforeMove={pointerX:0,pointerY:0,x:0,y:0,w:0,h:0},this.limits={left:{min:null,max:null},right:{min:null,max:null},top:{min:null,max:null},bottom:{min:null,max:null}}},stickDown(e,a,i=!1){if((!this.isResizable||!this.active)&&!i)return;this.stickDrag=!0;const f=typeof a.pageX<"u"?a.pageX:a.touches[0].pageX,s=typeof a.pageY<"u"?a.pageY:a.touches[0].pageY;this.saveDimensionsBeforeMove({pointerX:f,pointerY:s}),this.currentStick=e,this.limits=this.calcResizeLimits()},saveDimensionsBeforeMove({pointerX:e,pointerY:a}){this.dimensionsBeforeMove.pointerX=e,this.dimensionsBeforeMove.pointerY=a,this.dimensionsBeforeMove.left=this.left,this.dimensionsBeforeMove.right=this.right,this.dimensionsBeforeMove.top=this.top,this.dimensionsBeforeMove.bottom=this.bottom,this.dimensionsBeforeMove.width=this.width,this.dimensionsBeforeMove.height=this.height,this.aspectFactor=this.width/this.height},stickMove(e){const{currentStick:a,dimensionsBeforeMove:i,gridY:f,gridX:s,snapToGrid:t,parentHeight:o,parentWidth:g}=this;let u=i.top,d=i.bottom,r=i.left,c=i.right;switch(a[0]){case"b":d=i.bottom+e.y,t&&(d=o-Math.round((o-d)/f)*f);break;case"t":u=i.top-e.y,t&&(u=Math.round(u/f)*f);break}switch(a[1]){case"r":c=i.right+e.x,t&&(c=g-Math.round((g-c)/s)*s);break;case"l":r=i.left-e.x,t&&(r=Math.round(r/s)*s);break}({newLeft:r,newRight:c,newTop:u,newBottom:d}=this.rectCorrectionByLimit({newLeft:r,newRight:c,newTop:u,newBottom:d})),this.aspectRatio&&({newLeft:r,newRight:c,newTop:u,newBottom:d}=this.rectCorrectionByAspectRatio({newLeft:r,newRight:c,newTop:u,newBottom:d})),this.left=r,this.right=c,this.top=u,this.bottom=d,this.$emit("resizing",this.rect)},stickUp(){this.stickDrag=!1,this.dimensionsBeforeMove={pointerX:0,pointerY:0,x:0,y:0,w:0,h:0},this.limits={left:{min:null,max:null},right:{min:null,max:null},top:{min:null,max:null},bottom:{min:null,max:null}},this.$emit("resizing",this.rect),this.$emit("resizestop",this.rect)},calcDragLimitation(){const{parentWidth:e,parentHeight:a}=this;return{left:{min:0,max:e-this.width},right:{min:0,max:e-this.width},top:{min:0,max:a-this.height},bottom:{min:0,max:a-this.height}}},calcResizeLimits(){const{aspectFactor:e,width:a,height:i,bottom:f,top:s,left:t,right:o}=this;let{minh:g,minw:u}=this;const d=this.parentLimitation?0:null;this.aspectRatio&&(u/g>e?g=u/e:u=e*g);const r={left:{min:d,max:t+(a-u)},right:{min:d,max:o+(a-u)},top:{min:d,max:s+(i-g)},bottom:{min:d,max:f+(i-g)}};if(this.aspectRatio){const c={left:{min:t-Math.min(s,f)*e*2,max:t+(i-g)/2*e*2},right:{min:o-Math.min(s,f)*e*2,max:o+(i-g)/2*e*2},top:{min:s-Math.min(t,o)/e*2,max:s+(a-u)/2/e*2},bottom:{min:f-Math.min(t,o)/e*2,max:f+(a-u)/2/e*2}};this.currentStick[0]==="m"?(r.left={min:Math.max(r.left.min,c.left.min),max:Math.min(r.left.max,c.left.max)},r.right={min:Math.max(r.right.min,c.right.min),max:Math.min(r.right.max,c.right.max)}):this.currentStick[1]==="m"&&(r.top={min:Math.max(r.top.min,c.top.min),max:Math.min(r.top.max,c.top.max)},r.bottom={min:Math.max(r.bottom.min,c.bottom.min),max:Math.min(r.bottom.max,c.bottom.max)})}return r},sideCorrectionByLimit(e,a){let i=a;return e.min!==null&&a<e.min?i=e.min:e.max!==null&&e.max<a&&(i=e.max),i},rectCorrectionByLimit(e){const{limits:a}=this;let{newRight:i,newLeft:f,newBottom:s,newTop:t}=e;return f=this.sideCorrectionByLimit(a.left,f),i=this.sideCorrectionByLimit(a.right,i),t=this.sideCorrectionByLimit(a.top,t),s=this.sideCorrectionByLimit(a.bottom,s),{newLeft:f,newRight:i,newTop:t,newBottom:s}},rectCorrectionByAspectRatio(e){let{newLeft:a,newRight:i,newTop:f,newBottom:s}=e;const{parentWidth:t,parentHeight:o,currentStick:g,aspectFactor:u,dimensionsBeforeMove:d}=this;let r=t-a-i,c=o-f-s;if(g[1]==="m"){const N=c-d.height;a-=N*u/2,i-=N*u/2}else if(g[0]==="m"){const N=r-d.width;f-=N/u/2,s-=N/u/2}else r/c>u?(r=u*c,g[1]==="l"?a=t-i-r:i=t-a-r):(c=r/u,g[0]==="t"?f=o-s-c:s=o-f-c);return{newLeft:a,newRight:i,newTop:f,newBottom:s}}},computed:{positionStyle(){return{top:this.top+"px",left:this.left+"px",zIndex:this.zIndex}},sizeStyle(){return{width:this.w=="auto"?"auto":this.width+"px",height:this.h=="auto"?"auto":this.height+"px"}},vdrStick(){return e=>{const a={width:`${this.stickSize/this.parentScaleX}px`,height:`${this.stickSize/this.parentScaleY}px`};return a[at.y[e[0]]]=`${this.stickSize/this.parentScaleX/-2}px`,a[at.x[e[1]]]=`${this.stickSize/this.parentScaleX/-2}px`,a}},width(){return this.parentWidth-this.left-this.right},height(){return this.parentHeight-this.top-this.bottom},rect(){return{left:Math.round(this.left),top:Math.round(this.top),width:Math.round(this.width),height:Math.round(this.height)}}},watch:{active(e){e?this.$emit("activated"):this.$emit("deactivated")},isActive:{immediate:!0,handler(e){this.active=e}},z:{immediate:!0,handler(e){(e>=0||e==="auto")&&(this.zIndex=e)}},x:{handler(e,a){if(this.stickDrag||this.bodyDrag||e===this.left)return;const i=a-e;this.bodyDown({pageX:this.left,pageY:this.top}),this.bodyMove({x:i,y:0}),this.$nextTick(()=>{this.bodyUp()})}},y:{handler(e,a){if(this.stickDrag||this.bodyDrag||e===this.top)return;const i=a-e;this.bodyDown({pageX:this.left,pageY:this.top}),this.bodyMove({x:0,y:i}),this.$nextTick(()=>{this.bodyUp()})}},w:{handler(e,a){if(this.stickDrag||this.bodyDrag||e===this.width)return;const i="mr",f=a-e;this.stickDown(i,{pageX:this.right,pageY:this.top+this.height/2},!0),this.stickMove({x:f,y:0}),this.$nextTick(()=>{this.stickUp()})}},h:{handler(e,a){if(this.stickDrag||this.bodyDrag||e===this.height)return;const i="bm",f=a-e;this.stickDown(i,{pageX:this.left+this.width/2,pageY:this.bottom},!0),this.stickMove({x:0,y:f}),this.$nextTick(()=>{this.stickUp()})}},parentW(e){this.right=e-this.width-this.left,this.parentWidth=e},parentH(e){this.bottom=e-this.height-this.top,this.parentHeight=e}}},tn=["onMousedown","onTouchstart"];function on(e,a,i,f,s,t){return p(),C("div",{class:we(["vdr",`${e.active||e.isActive?"active":"inactive"} ${e.contentClass?e.contentClass:""}`]),style:fe(e.positionStyle),onMousedown:a[0]||(a[0]=o=>e.bodyDown(o)),onTouchstart:a[1]||(a[1]=o=>e.bodyDown(o)),onTouchend:a[2]||(a[2]=o=>e.up(o))},[b("div",{style:fe(e.sizeStyle),class:"content-container",ref:"container"},[ye(e.$slots,"default")],4),(p(!0),C(K,null,ae(e.sticks,o=>(p(),C("div",{class:we(["vdr-stick",["vdr-stick-"+o,e.isResizable?"":"not-resizable"]]),onMousedown:ce(g=>e.stickDown(o,g),["stop","prevent"]),onTouchstart:ce(g=>e.stickDown(o,g),["stop","prevent"]),style:fe(e.vdrStick(o))},null,46,tn))),256))],38)}const gt=ve(en,[["render",on]]);function qe(e){qe.installed||(qe.installed=!0,e.component("vue-drag-resize",gt))}const nn={install:qe};let Ce=null;typeof window<"u"?Ce=window.Vue:typeof global<"u"&&(Ce=global.Vue);Ce&&Ce.use(nn);const ln={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function an(e,a){return p(),C("svg",ln,a[0]||(a[0]=[b("path",{fill:"currentColor",d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1l-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4"},null,-1)]))}const _t=ie({name:"ant-design-right-outlined",render:an}),sn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function dn(e,a){return p(),C("svg",sn,a[0]||(a[0]=[b("path",{fill:"currentColor","fill-rule":"evenodd",d:"M799.855 166.312c.023.007.043.018.084.059l57.69 57.69c.041.041.052.06.059.084a.1.1 0 0 1 0 .069c-.007.023-.018.042-.059.083L569.926 512l287.703 287.703c.041.04.052.06.059.083a.12.12 0 0 1 0 .07c-.007.022-.018.042-.059.083l-57.69 57.69c-.041.041-.06.052-.084.059a.1.1 0 0 1-.069 0c-.023-.007-.042-.018-.083-.059L512 569.926L224.297 857.629c-.04.041-.06.052-.083.059a.12.12 0 0 1-.07 0c-.022-.007-.042-.018-.083-.059l-57.69-57.69c-.041-.041-.052-.06-.059-.084a.1.1 0 0 1 0-.069c.007-.023.018-.042.059-.083L454.073 512L166.371 224.297c-.041-.04-.052-.06-.059-.083a.12.12 0 0 1 0-.07c.007-.022.018-.042.059-.083l57.69-57.69c.041-.041.06-.052.084-.059a.1.1 0 0 1 .069 0c.023.007.042.018.083.059L512 454.073l287.703-287.702c.04-.041.06-.052.083-.059a.12.12 0 0 1 .07 0Z"},null,-1)]))}const Ge=ie({name:"ant-design-close-outlined",render:dn}),rn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function un(e,a){return p(),C("svg",rn,a[0]||(a[0]=[b("path",{fill:"currentColor",d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281l360-281.1c3.8-3 6.1-7.7 6.1-12.6"},null,-1)]))}const wt=ie({name:"ant-design-left-outlined",render:un}),cn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function pn(e,a){return p(),C("svg",cn,a[0]||(a[0]=[b("path",{fill:"currentColor",d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448s448-200.6 448-448S759.4 64 512 64m0 820c-205.4 0-372-166.6-372-372c0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884m288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372c0 89-31.3 170.8-83.5 234.8"},null,-1)]))}const mn=ie({name:"ant-design-stop-outlined",render:pn}),he=qt(Xt.Workflow,()=>{const e=y(),a=y(),i=y(),f=y([]);function s(u){e.value=u}function t(u){a.value=u}async function o(u){i.value=u;const{data:d,error:r}=await _o({groupName:u});r||(f.value=d)}function g(){e.value=void 0,a.value=void 0,i.value=void 0,f.value=[]}return{id:e,type:a,groupName:i,jobList:f,setJobList:o,setType:t,setId:s,clear:g}}),fn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function vn(e,a){return p(),C("svg",fn,a[0]||(a[0]=[b("path",{fill:"currentColor",d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 0 0 0-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 0 0 9.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9m67.4-174.4L687.8 215l73.3 73.3l-362.7 362.6l-88.9 15.7zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32"},null,-1)]))}const hn=ie({name:"ant-design-edit-outlined",render:vn}),bn={class:"flex items-center"},Oe=F({name:"EditableInput",__name:"editable-input",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:a}){const i=e,f=a,s=y(),t=y(),o=y(!1);W(()=>i.modelValue,d=>{t.value=d},{immediate:!0});const g=()=>{o.value=!0,pe(()=>{var d;(d=s.value)==null||d.focus()})},u=()=>{f("update:modelValue",t.value),o.value=!1};return(d,r)=>{const c=Xe,N=hn,w=re,m=De;return o.value?(p(),I(c,{key:0,ref_key:"inputRef",ref:s,value:t.value,"onUpdate:value":r[0]||(r[0]=x=>t.value=x),type:"text",onBlur:u},null,8,["value"])):(p(),I(m,{key:1},{default:l(()=>[b("span",bn,[S($(t.value)+" ",1),n(w,{text:"",type:"info",class:"m-l-6px",onClick:g},{icon:l(()=>[n(N,{class:"text-icon"})]),_:1})])]),_:1}))}}}),gn={class:"w-460px flex-center"};function _n(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ft(e)}const wn=F({name:"TaskDrawer",__name:"task-drawer",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1},len:{default:0}},emits:["update:open","save"],setup(e,{emit:a}){const i=e,f=a,s=he(),t=y(!1),o=y({}),g=y([]);W(()=>s.jobList,m=>{g.value=m},{immediate:!0}),W(()=>i.open,m=>{t.value=m},{immediate:!0}),W(()=>i.modelValue,m=>{o.value=m},{immediate:!0});const u=y(),d=()=>{f("update:open",!1),t.value=!1},r=()=>{var m;(m=u.value)==null||m.validate(x=>{x||(d(),f("save",o.value))}).catch(()=>{var x;return(x=window.$message)==null?void 0:x.warning("请检查表单信息")})},c={failStrategy:[{required:!0,message:"请选择失败策略"}],workflowNodeStatus:[{required:!0,message:"请选择工作流状态"}],jobTask:{jobId:[{required:!0,message:"请选择任务"}]}},N=(m,x)=>{o.value.jobTask.jobName=x.jobName,o.value.jobTask.labels=x.labels},w=m=>n(ke,{trigger:"hover",placement:"left"},{trigger:()=>{let x;return n("div",{class:"flex-y-center gap-6px"},[m.taskType?n(_e,{type:"info",size:"small"},_n(x=R(Pt[m.taskType]))?x:{default:()=>[x]}):null,n("span",null,[m.jobName])])},default:()=>n("div",null,[m.jobName,S(" ( "),m.executorInfo,S(" )")])});return(m,x)=>{const T=Me,_=Ie,D=Ae,M=je,L=ze,P=Re,v=re,V=Ue,A=Le;return p(),I(A,{show:t.value,"onUpdate:show":x[5]||(x[5]=z=>t.value=z),"display-directive":"if",width:500,onAfterLeave:d},{default:l(()=>[n(V,null,{header:l(()=>[b("div",gn,[n(Oe,{modelValue:o.value.nodeName,"onUpdate:modelValue":x[0]||(x[0]=z=>o.value.nodeName=z),class:"mr-16px max-w-320px min-w-320px"},null,8,["modelValue"]),n(T,{value:o.value.priorityLevel,"onUpdate:value":x[1]||(x[1]=z=>o.value.priorityLevel=z),class:"max-w-110px",options:Array(m.len).fill(0).map((z,q)=>({label:"优先级 "+(q+1),value:q+1}))},null,8,["value","options"])])]),footer:l(()=>[n(v,{type:"primary",onClick:r},{default:l(()=>x[6]||(x[6]=[S("保存")])),_:1}),n(v,{class:"ml-12px",onClick:d},{default:l(()=>x[7]||(x[7]=[S("取消")])),_:1})]),default:l(()=>[n(P,{ref_key:"formRef",ref:u,model:o.value,rules:c,"label-align":"left","label-width":"100px"},{default:l(()=>[n(_,{path:"jobTask.jobId",label:"所属任务",placeholder:"请选择任务"},{default:l(()=>[n(T,{value:o.value.jobTask.jobId,"onUpdate:value":[x[2]||(x[2]=z=>o.value.jobTask.jobId=z),N],filterable:"","render-label":w,"label-field":"jobName","value-field":"id",options:g.value},null,8,["value","options"])]),_:1}),n(_,{path:"failStrategy",label:"失败策略"},{default:l(()=>[n(L,{value:o.value.failStrategy,"onUpdate:value":x[3]||(x[3]=z=>o.value.failStrategy=z)},{default:l(()=>[n(M,null,{default:l(()=>[(p(!0),C(K,null,ae(h(Wt),(z,q)=>(p(),I(D,{key:q,label:h(R)(z.label),value:z.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1}),n(_,{path:"workflowNodeStatus",label:"任务状态"},{default:l(()=>[n(L,{value:o.value.workflowNodeStatus,"onUpdate:value":x[4]||(x[4]=z=>o.value.workflowNodeStatus=z)},{default:l(()=>[n(M,null,{default:l(()=>[(p(!0),C(K,null,ae(h(We),(z,q)=>(p(),I(D,{key:q,label:h(R)(z.label),value:z.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])}}}),yn=F({name:"TaskDetail",__name:"task-detail",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1}},emits:["update:open"],setup(e,{emit:a}){const i=e,f=a,s=he(),t=y(!1);W(()=>i.open,u=>{t.value=u},{immediate:!0});const o=()=>{f("update:open",!1)},g=u=>{var r;return(r=s.jobList.find(c=>c.id===u))==null?void 0:r.jobName};return(u,d)=>{const r=xe,c=Ne,N=Be;return p(),I(N,{modelValue:t.value,"onUpdate:modelValue":d[0]||(d[0]=w=>t.value=w),title:"任务详情",width:["500px","90%"],onAfterLeave:o},{default:l(()=>[n(c,{column:1,"label-placement":"left",bordered:"","label-style":{width:"120px"}},{default:l(()=>[n(r,{label:"节点名称"},{default:l(()=>[S($(u.modelValue.nodeName),1)]),_:1}),n(r,{label:"任务 ID"},{default:l(()=>{var w;return[S($((w=u.modelValue.jobTask)==null?void 0:w.jobId),1)]}),_:1}),n(r,{label:"任务名称"},{default:l(()=>{var w;return[S($(g((w=u.modelValue.jobTask)==null?void 0:w.jobId)),1)]}),_:1}),n(r,{label:"失败策略"},{default:l(()=>[S($(h(R)(h(rt)[u.modelValue.failStrategy])),1)]),_:1}),n(r,{label:"任务状态"},{default:l(()=>[S($(h(R)(h(Pe)[u.modelValue.workflowNodeStatus])),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),kn=F({name:"FlowLogDrawer",__name:"flow-log-drawer",props:Gt({title:{default:R("workflow.node.log.title")},taskData:{}},{show:{type:Boolean,default:!0},showModifiers:{}}),emits:["update:show"],setup(e){const a=Jt(e,"show");return(i,f)=>{const s=$o;return p(),I(s,{show:a.value,"onUpdate:show":f[0]||(f[0]=t=>a.value=t),title:i.title,"task-data":i.taskData},null,8,["show","title","task-data"])}}}),Nn=F({name:"DetailCard",__name:"detail-card",props:{id:{default:void 0},ids:{default:()=>[]},show:{type:Boolean,default:!1}},emits:["update:show"],setup(e,{emit:a}){co.registerLanguage("json",po);const i=e,f=a,s=ut(),t=he(),o=y(!1),g=y(!1),u=y(!1),d=y(1),r=y({}),c=y({page:1,pageCount:0,pageSize:10,showSizePicker:!0,pageSizes:[10,15,20,25,30],onUpdatePage:async v=>{c.value.page=v;const V=i.ids[d.value-1];m(V)},onUpdatePageSize:async v=>{c.value.pageSize=v;const V=i.ids[d.value-1];m(V)}});W(()=>i.show,v=>{o.value=v,v&&T()},{immediate:!0});const N=()=>{f("update:show",!1)};async function w(v){u.value=!0;const{data:V,error:A}=await wo(v);A||(r.value=V,u.value=!1)}async function m(v){u.value=!0;const{data:V,error:A}=await mo(v);A||(r.value=V,u.value=!1)}const x=y([]);function T(){x.value=i.ids,pe(()=>{i.ids.length>0?m(i.ids[0]):i.id&&(x.value=[r.value.taskBatchId],w(i.id))})}const _=y({}),D=v=>{_.value=v,g.value=!0},M=async()=>{var V;const{error:v}=await vo(t.id,r.value.workflowNodeId);v||(V=window.$message)==null||V.success("执行重试成功")};function L(v){return{color:`${v}18`,textColor:v,borderColor:`${v}58`}}const P=v=>{d.value=v;const V=i.ids[v-1];m(V)};return(v,V)=>{const A=xe,z=Ne,q=ct,k=Qt,j=fo,G=Kt,ee=ko,te=Be,H=kn;return p(),C(K,null,[n(te,{modelValue:o.value,"onUpdate:modelValue":V[2]||(V[2]=E=>o.value=E),title:"任务批次详情",width:["800px","90%"],"onUpdate:show":N},Zt({default:l(()=>[x.value&&x.value.length>0?(p(),I(G,{key:0,value:d.value,"onUpdate:value":V[0]||(V[0]=E=>d.value=E),type:"segment",animated:""},{default:l(()=>[(p(!0),C(K,null,ae(x.value,(E,U)=>(p(),I(k,{key:U,name:U+1,tab:E},{default:l(()=>[n(G,{class:"detail-tabs",type:"segment",animated:""},{default:l(()=>[n(k,{name:"info",tab:h(R)("page.log.info")},{default:l(()=>[n(q,{show:u.value},{default:l(()=>[n(z,{class:"pt-12px","label-placement":"left",bordered:"",column:2},{default:l(()=>[n(A,{label:h(R)("page.jobBatch.groupName")},{default:l(()=>{var X;return[S($((X=r.value)==null?void 0:X.groupName),1)]}),_:1},8,["label"]),n(A,{label:h(R)("page.jobBatch.jobName")},{default:l(()=>{var X;return[S($((X=r.value)==null?void 0:X.jobName),1)]}),_:1},8,["label"]),n(A,{label:h(R)("page.jobBatch.taskBatchStatus")},{default:l(()=>[h(Se)(r.value.taskBatchStatus)?(p(),I(h(_e),{key:0,color:L(h(J)[r.value.taskBatchStatus].color)},{default:l(()=>[S($(h(J)[r.value.taskBatchStatus].title),1)]),_:1},8,["color"])):B("",!0),h(Se)(r.value.jobStatus)?(p(),I(h(_e),{key:1,color:L(h(tt)[r.value.jobStatus].color)},{default:l(()=>[S($(h(R)(h(tt)[r.value.jobStatus].name)),1)]),_:1},8,["color"])):B("",!0)]),_:1},8,["label"]),n(A,{label:h(R)("page.jobBatch.executionAt")},{default:l(()=>{var X;return[S($((X=r.value)==null?void 0:X.executionAt),1)]}),_:1},8,["label"]),n(A,{label:h(R)("page.jobBatch.operationReason")},{default:l(()=>[h(Se)(r.value.operationReason)?(p(),I(h(_e),{key:0,color:L(h(ot)[r.value.operationReason].color)},{default:l(()=>[S($(h(R)(h(ot)[r.value.operationReason].name)),1)]),_:1},8,["color"])):B("",!0)]),_:1},8,["label"]),h(s).default?B("",!0):(p(),I(A,{key:0,label:h(R)("page.jobBatch.executorType")},{default:l(()=>[h(Se)(r.value.executorType)?(p(),I(h(_e),{key:0,color:L(h(nt)[r.value.executorType].color)},{default:l(()=>[S($(h(R)(h(nt)[r.value.executorType].name)),1)]),_:1},8,["color"])):B("",!0)]),_:1},8,["label"])),n(A,{label:h(R)("page.jobBatch.executorInfo"),span:2},{default:l(()=>{var X;return[S($((X=r.value)==null?void 0:X.executorInfo),1)]}),_:1},8,["label"]),n(A,{label:h(R)("common.createDt"),span:2},{default:l(()=>{var X;return[S($((X=r.value)==null?void 0:X.createDt),1)]}),_:1},8,["label"])]),_:1})]),_:1},8,["show"]),ye(v.$slots,"default",{},void 0,!0)]),_:3},8,["tab"]),n(k,{name:"task",tab:"任务项列表",disabled:r.value.taskBatchStatus===99},{default:l(()=>[n(j,{"row-data":r.value,onShowLog:D,onRetry:M},null,8,["row-data"])]),_:1},8,["disabled"])]),_:3})]),_:2},1032,["name","tab"]))),128))]),_:3},8,["value"])):B("",!0)]),_:2},[v.ids&&v.ids.length>1?{name:"footer",fn:l(()=>[n(ee,{page:d.value,"onUpdate:page":[V[1]||(V[1]=E=>d.value=E),P],class:"text-center","page-size":1,"page-count":v.ids.length},null,8,["page","page-count"])]),key:"0"}:void 0]),1032,["modelValue"]),n(H,{show:g.value,"onUpdate:show":V[3]||(V[3]=E=>g.value=E),title:"日志详情","task-data":_.value},null,8,["show","task-data"])],64)}}}),Je=ve(Nn,[["__scopeId","data-v-1b2fbbae"]]),xn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function $n(e,a){return p(),C("svg",xn,a[0]||(a[0]=[b("path",{fill:"currentColor",d:"M752 664c-28.5 0-54.8 10-75.4 26.7L469.4 540.8a160.7 160.7 0 0 0 0-57.6l207.2-149.9C697.2 350 723.5 360 752 360c66.2 0 120-53.8 120-120s-53.8-120-120-120s-120 53.8-120 120c0 11.6 1.6 22.7 4.7 33.3L439.9 415.8C410.7 377.1 364.3 352 312 352c-88.4 0-160 71.6-160 160s71.6 160 160 160c52.3 0 98.7-25.1 127.9-63.8l196.8 142.5c-3.1 10.6-4.7 21.8-4.7 33.3c0 66.2 53.8 120 120 120s120-53.8 120-120s-53.8-120-120-120m0-476c28.7 0 52 23.3 52 52s-23.3 52-52 52s-52-23.3-52-52s23.3-52 52-52M312 600c-48.5 0-88-39.5-88-88s39.5-88 88-88s88 39.5 88 88s-39.5 88-88 88m440 236c-28.7 0-52-23.3-52-52s23.3-52 52-52s52 23.3 52 52s-23.3 52-52 52"},null,-1)]))}const Sn=ie({name:"ant-design-share-alt-outlined",render:$n}),Vn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function Bn(e,a){return p(),C("svg",Vn,a[0]||(a[0]=[b("path",{fill:"currentColor",d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8m0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8m0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8M104 228a56 56 0 1 0 112 0a56 56 0 1 0-112 0m0 284a56 56 0 1 0 112 0a56 56 0 1 0-112 0m0 284a56 56 0 1 0 112 0a56 56 0 1 0-112 0"},null,-1)]))}const Tn=ie({name:"ant-design-unordered-list-outlined",render:Bn}),Cn={class:"add-node-btn-box"},Dn={class:"add-node-btn"},Ln={class:"add-node-popover-body"},Un={class:"icon"},Rn=F({name:"AddNode",__name:"add-node",props:{modelValue:{},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:a}){const i=e,f=a,s=t=>{let o={};t===1?o={nodeName:R("workflow.node.task.nodeName"),nodeType:1,conditionNodes:[{nodeName:R("workflow.node.task.conditionNodes.nodeName"),failStrategy:1,priorityLevel:1,workflowNodeStatus:1,jobTask:{jobId:void 0}}],childNode:i.modelValue}:t===2?o={nodeName:R("workflow.node.condition.nodeName"),nodeType:2,conditionNodes:[{nodeName:`${R("workflow.node.condition.conditionNodes.nodeName")} 1`,priorityLevel:1,decision:{expressionType:1,nodeExpression:void 0,logicalCondition:1,defaultDecision:0}},{nodeName:R("workflow.node.condition.conditionNodes.otherNodeName"),priorityLevel:2,decision:{expressionType:1,nodeExpression:"#true",logicalCondition:1,defaultDecision:1}}],childNode:i.modelValue}:t===3&&(o={nodeName:R("workflow.node.callback.nodeName"),nodeType:3,conditionNodes:[{nodeName:R("workflow.node.callback.conditionNodes.nodeName"),workflowNodeStatus:1,callback:{webhook:void 0,contentType:void 0,secret:void 0}}],childNode:i.modelValue}),f("update:modelValue",o)};return(t,o)=>{const g=bt,u=re,d=Tn,r=Sn,c=Fe;return p(),C("div",Cn,[b("div",Dn,[t.disabled?B("",!0):(p(),I(c,{key:0,placement:"right-end",trigger:"click","overlay-style":{width:"296px"}},{trigger:l(()=>[n(u,{type:"primary",circle:"",strong:""},{default:l(()=>[n(g)]),_:1})]),default:l(()=>[b("div",Ln,[b("ul",Un,[b("li",null,[n(u,{circle:"",size:"large",onClick:o[0]||(o[0]=N=>s(1))},{default:l(()=>[n(d,{class:"text-20px color-#3296fa"})]),_:1}),b("p",null,$(h(R)("workflow.node.task.nodeName")),1)]),b("li",null,[n(u,{circle:"",size:"large",onClick:o[1]||(o[1]=N=>s(2))},{default:l(()=>[n(r,{class:"text-20px color-#15bc83"})]),_:1}),b("p",null,$(h(R)("workflow.node.condition.nodeName")),1)])])])]),_:1}))])])}}}),be=ve(Rn,[["__scopeId","data-v-a08c8cf7"]]),In={class:"node-wrap"},Mn={class:"branch-box"},jn={class:"condition-node"},En={class:"condition-node-box"},zn={class:"popover"},An={class:"popover-item"},On={class:"popover-item"},Hn=["onClick"],Yn=["onClick"],qn={class:"title"},Xn={class:"text color-#3296fa"},Wn={key:0},Pn={class:"priority-title"},Fn={class:"content min-h-72px"},Gn={key:0,class:"placeholder"},Jn={class:"inline-block max-w-190px overflow-hidden whitespace-nowrap"},Zn={class:"flex-y-center gap-8px"},Kn={class:"flex-y-center gap-6px"},Qn={class:"flex-y-center gap-6px"},el=["onClick"],tl={key:1,class:"top-left-cover-line"},ol={key:2,class:"bottom-left-cover-line"},nl={key:3,class:"top-right-cover-line"},ll={key:4,class:"bottom-right-cover-line"},al=F({name:"TaskNode",__name:"task-node",props:{modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["refresh","update:modelValue"],setup(e,{emit:a}){const i=e,f=a,s=he(),t=eo(),o=y({});W(()=>i.modelValue,k=>{o.value=k},{immediate:!0});const g=()=>{var j;const k=o.value.conditionNodes.length+1;(j=o.value.conditionNodes)==null||j.push({nodeName:`${R("workflow.node.task.name")} ${k}`,priorityLevel:k,failStrategy:1,workflowNodeStatus:1,jobTask:{jobId:void 0}}),f("update:modelValue",o.value)},u=(k,j)=>{k.childNode?u(k.childNode,j):k.childNode=j},d=k=>{var j;o.value.conditionNodes.length===1?(o.value.childNode&&(o.value.conditionNodes[0].childNode?u(o.value.conditionNodes[0].childNode,o.value.childNode):o.value.conditionNodes[0].childNode=o.value.childNode),pe(()=>{f("update:modelValue",o.value.conditionNodes[0].childNode)})):(j=o.value.conditionNodes)==null||j.splice(k,1)},r=(k,j=1)=>{var G;o.value.conditionNodes[k]=o.value.conditionNodes.splice(k+j,1,o.value.conditionNodes[k])[0],(G=o.value.conditionNodes)==null||G.map((ee,te)=>ee.priorityLevel=te+1),f("update:modelValue",o.value)},c=y(0),N=y(!1),w=y({}),m=k=>{const j=o.value.conditionNodes[c.value].priorityLevel,G=k.priorityLevel;o.value.conditionNodes[c.value]=k,j!==G&&r(c.value,G-j),f("update:modelValue",o.value)},x=k=>{i.disabled||(c.value=k,w.value=JSON.parse(JSON.stringify(o.value.conditionNodes[k])),N.value=!0)},T=k=>i.disabled?s.type===2?`node-error node-error-${k.taskBatchStatus&&J[k.taskBatchStatus]?J[k.taskBatchStatus].name:"default"}`:"node-error":"auto-judge-def auto-judge-hover",_=y(),D=y(),M=y(!1),L=y([]),P=(k,j)=>{var G,ee,te,H;D.value=[],s.type===2?((G=k.jobBatchList)==null||G.sort((E,U)=>E.taskBatchStatus-U.taskBatchStatus).forEach(E=>{var U,X;E.id?(U=D.value)==null||U.push(E.id):E.jobId&&(_.value=(X=E.jobId)==null?void 0:X.toString())}),(ee=k.jobTask)!=null&&ee.jobId&&(_.value=(H=(te=k.jobTask)==null?void 0:te.jobId)==null?void 0:H.toString()),M.value=!0):s.type===1?L.value[j]=!0:x(j)},v=async k=>{const{error:j}=await ho(k.id,s.id);j||(t.success("执行重试成功"),f("refresh"))},V=async k=>{const{error:j}=await bo(k.id,s.id);j||(t.success("停止任务成功"),f("refresh"))},A=k=>k===4||k===5||k===6,z=k=>k===1||k===2,q=k=>A(k)||z(k);return(k,j)=>{const G=re,ee=vt,te=pt,H=mn,E=wt,U=Te,X=Ge,Y=_e,ue=ke,Ze=De,Nt=_t,xt=Fe,$t=Ee;return p(),C("div",In,[b("div",Mn,[k.disabled?B("",!0):(p(),I(G,{key:0,class:"add-branch",strong:"",type:"success",onClick:g},{default:l(()=>[S($(h(R)("workflow.node.task.add")),1)]),_:1})),(p(!0),C(K,null,ae(o.value.conditionNodes,(O,oe)=>(p(),C("div",{key:oe,class:"col-box"},[b("div",jn,[b("div",En,[n(xt,{disabled:h(s).type!==2||!q(O.taskBatchStatus)},{trigger:l(()=>{var me,Ke,Qe;return[b("div",{class:we(["auto-judge cursor-pointer",T(O)]),onClick:le=>P(O,oe)},[oe!=0?(p(),C("div",{key:0,class:"sort-left",onClick:ce(le=>r(oe,-1),["stop"])},[n(E)],8,Yn)):B("",!0),b("div",qn,[b("span",Xn,[n(U,{processing:"",dot:"",color:O.workflowNodeStatus===1?"#52c41a":"#ff4d4f"},null,8,["color"]),S("  "+$(O.nodeName)+" ",1),O.id?(p(),C("span",Wn," ("+$(O.id)+")",1)):B("",!0)]),b("span",Pn,$(h(R)("workflow.node.priority"))+$(O.priorityLevel),1),k.disabled?B("",!0):(p(),I(X,{key:0,class:"close",onClick:ce(le=>d(oe),["stop"])},null,8,["onClick"]))]),b("div",Fn,[(me=O.jobTask)!=null&&me.jobId?B("",!0):(p(),C("div",Gn,"请选择任务")),(Ke=O.jobTask)!=null&&Ke.jobId?(p(),C(K,{key:1},[b("div",null,[(Qe=O.jobTask)!=null&&Qe.labels?(p(),I(ue,{key:0},{trigger:l(()=>{var le;return[b("div",Jn,[b("div",Zn,[j[5]||(j[5]=b("span",{class:"content_label"},"标签:",-1)),b("div",Kn,[n(yo,{labels:(le=O.jobTask)==null?void 0:le.labels},null,8,["labels"])])])])]}),default:l(()=>{var le;return[b("div",Qn,[(p(!0),C(K,null,ae(Object.entries(JSON.parse(((le=O.jobTask)==null?void 0:le.labels)||"{}")),([$e,St])=>(p(),I(Y,{key:$e,type:"default"},{default:l(()=>[S($($e)+":"+$(St),1)]),_:2},1024))),128))])]}),_:2},1024)):B("",!0)]),b("div",null,[n(Ze,{class:"max-w-123px"},{default:l(()=>{var le,$e;return[j[6]||(j[6]=b("span",{class:"content_label"},"任务名称: ",-1)),S(" "+$(`${(le=O.jobTask)==null?void 0:le.jobName}(${($e=O.jobTask)==null?void 0:$e.jobId})`),1)]}),_:2},1024)]),b("div",null,[j[7]||(j[7]=b("span",{class:"content_label"},"失败策略: ",-1)),S(" "+$(h(R)(h(rt)[O.failStrategy])),1)]),j[8]||(j[8]=b("div",null,".........",-1))],64)):B("",!0)]),oe!=o.value.conditionNodes.length-1?(p(),C("div",{key:1,class:"sort-right",onClick:ce(le=>r(oe),["stop"])},[n(Nt)],8,el)):B("",!0)],10,Hn)]}),default:l(()=>[b("div",zn,[A(O.taskBatchStatus)?(p(),I(G,{key:0,text:"",onClick:me=>v(O)},{default:l(()=>[b("span",An,[n(ee,{class:"mb-3px text-24px font-bold"}),S(" "+$(h(R)("common.retry")),1)])]),_:2},1032,["onClick"])):B("",!0),z(O.taskBatchStatus)&&A(O.taskBatchStatus)?(p(),I(te,{key:1,vertical:""})):B("",!0),z(O.taskBatchStatus)?(p(),I(G,{key:2,text:"",onClick:me=>V(O)},{default:l(()=>[b("span",On,[n(H),S(" "+$(h(R)("common.stop")),1)])]),_:2},1032,["onClick"])):B("",!0)])]),_:2},1032,["disabled"]),h(s).type===2&&O.taskBatchStatus?(p(),I(ue,{key:0},{trigger:l(()=>[b("div",{class:"task-error-tip text-24px",style:fe({color:h(J)[O.taskBatchStatus].color})},[n($t,{icon:h(J)[O.taskBatchStatus].icon},null,8,["icon"])],4)]),default:l(()=>[S(" "+$(h(J)[O.taskBatchStatus].title),1)]),_:2},1024)):B("",!0),n(be,{modelValue:O.childNode,"onUpdate:modelValue":me=>O.childNode=me,disabled:k.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])])]),O.childNode?ye(k.$slots,"default",{key:0,node:O},void 0,!0):B("",!0),oe==0?(p(),C("div",tl)):B("",!0),oe==0?(p(),C("div",ol)):B("",!0),oe==o.value.conditionNodes.length-1?(p(),C("div",nl)):B("",!0),oe==o.value.conditionNodes.length-1?(p(),C("div",ll)):B("",!0),h(s).type!==0?(p(),I(yn,{key:5,open:L.value[oe],"onUpdate:open":me=>L.value[oe]=me,"model-value":o.value.conditionNodes[oe]},null,8,["open","onUpdate:open","model-value"])):B("",!0)]))),128))]),o.value.conditionNodes.length>1?(p(),I(be,{key:0,modelValue:o.value.childNode,"onUpdate:modelValue":j[0]||(j[0]=O=>o.value.childNode=O),disabled:k.disabled},null,8,["modelValue","disabled"])):B("",!0),h(s).type===0?(p(),I(wn,{key:1,open:N.value,"onUpdate:open":j[1]||(j[1]=O=>N.value=O),modelValue:w.value,"onUpdate:modelValue":j[2]||(j[2]=O=>w.value=O),len:o.value.conditionNodes.length,"onUpdate:len":j[3]||(j[3]=O=>o.value.conditionNodes.length=O),onSave:m},null,8,["open","modelValue","len"])):B("",!0),h(s).type!==0?(p(),I(Je,{key:2,id:_.value,show:M.value,"onUpdate:show":j[4]||(j[4]=O=>M.value=O),ids:D.value},null,8,["id","show","ids"])):B("",!0)])}}}),sl=ve(al,[["__scopeId","data-v-d07941eb"]]),il={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function dl(e,a){return p(),C("svg",il,a[0]||(a[0]=[b("path",{fill:"currentColor",d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448s448-200.6 448-448S759.4 64 512 64m0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372s372 166.6 372 372s-166.6 372-372 372"},null,-1),b("path",{fill:"currentColor",d:"M464 336a48 48 0 1 0 96 0a48 48 0 1 0-96 0m72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8"},null,-1)]))}const yt=ie({name:"ant-design-info-circle-outlined",render:dl}),rl={class:"w-460px flex-center"},ul=F({name:"BranchDrawer",__name:"branch-drawer",props:{open:{type:Boolean,default:!1},len:{default:0},modelValue:{default:()=>({})}},emits:["update:open","save"],setup(e,{emit:a}){const i=e,f=a,s=y(!1),t=y({decision:{logicalCondition:1,expressionType:1,nodeExpression:"",checkContents:[]}});W(()=>i.open,w=>{s.value=w},{immediate:!0}),W(()=>i.modelValue,w=>{t.value=w},{immediate:!0});const o=y(),g=()=>{f("update:open",!1),s.value=!1},u=()=>{var w;(w=o.value)==null||w.validate(m=>{m||(g(),f("save",t.value))}).catch(()=>{var m;return(m=window.$message)==null?void 0:m.warning("请检查表单信息")})},d=y(""),r=y("success"),c=async()=>{var x;if(r.value="error",!((x=t.value.decision)!=null&&x.nodeExpression)){d.value="请填写条件表达式";return}const{error:w,data:m}=await go(t.value.decision);if(w){d.value="接口请求失败";return}else if(m.key!==1||!m.value){d.value=m.value||"请检查条件表达式";return}r.value="success",d.value="表达式校验通过"},N={decision:{expressionType:[{required:!0,message:"请选择表达式类型",trigger:"change",type:"number"}],nodeExpression:[{required:!0,message:"请填写条件表达式",trigger:"blur"}]}};return(w,m)=>{const x=Me,T=Ae,_=je,D=ze,M=Ie,L=So,P=ht,v=re,V=Re,A=Ue,z=Le;return p(),I(z,{show:s.value,"onUpdate:show":m[5]||(m[5]=q=>s.value=q),"display-directive":"if",width:500,onAfterLeave:g},{default:l(()=>[n(A,null,{header:l(()=>[b("div",rl,[n(Oe,{modelValue:t.value.nodeName,"onUpdate:modelValue":m[0]||(m[0]=q=>t.value.nodeName=q),class:"mr-16px max-w-320px min-w-320px"},null,8,["modelValue"]),n(x,{value:t.value.priorityLevel,"onUpdate:value":m[1]||(m[1]=q=>t.value.priorityLevel=q),class:"max-w-110px",options:Array(w.len).fill(0).map((q,k)=>({label:"优先级 "+(k+1),value:k+1}))},null,8,["value","options"])])]),footer:l(()=>[n(v,{type:"primary",onClick:u},{default:l(()=>m[7]||(m[7]=[S("保存")])),_:1}),n(v,{class:"ml-12px",onClick:g},{default:l(()=>m[8]||(m[8]=[S("取消")])),_:1})]),default:l(()=>[n(V,{ref_key:"formRef",ref:o,rules:N,model:t.value,"label-align":"left","label-width":"100px"},{default:l(()=>{var q;return[n(M,{path:"decision.expressionType",label:"表达式类型"},{default:l(()=>[n(D,{value:t.value.decision.expressionType,"onUpdate:value":m[2]||(m[2]=k=>t.value.decision.expressionType=k)},{default:l(()=>[n(_,null,{default:l(()=>[(p(!0),C(K,null,ae(h(to),k=>(p(),I(T,{key:k.value,label:k.label,value:k.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1}),n(M,{path:"decision.nodeExpression",label:"条件表达式","validation-status":r.value,feedback:d.value},{default:l(()=>[n(L,{modelValue:t.value.decision.nodeExpression,"onUpdate:modelValue":m[3]||(m[3]=k=>t.value.decision.nodeExpression=k),placeholder:"请输入条件表达式"},null,8,["modelValue"])]),_:1},8,["validation-status","feedback"]),n(M,{path:"decision.checkContents",label:"模拟上下文","show-feedback":((q=t.value.decision)==null?void 0:q.checkContents)&&t.value.decision.checkContents.length===0},{default:l(()=>[n(P,{value:t.value.decision.checkContents,"onUpdate:value":m[4]||(m[4]=k=>t.value.decision.checkContents=k),path:"decision.checkContents"},null,8,["value"])]),_:1},8,["show-feedback"]),n(M,{"show-label":!1,"show-feedback":!1},{default:l(()=>[n(v,{type:"primary",ghost:"",block:"",onClick:c},{default:l(()=>m[6]||(m[6]=[S("校验条件表达式")])),_:1})]),_:1})]}),_:1},8,["model"])]),_:1})]),_:1},8,["show"])}}}),cl=ve(ul,[["__scopeId","data-v-f88d9134"]]),kt=F({name:"BranchDesc",__name:"branch-desc",props:{modelValue:{default:()=>({})}},setup(e){const a=e,i=y(""),f=y({".cm-line":{fontSize:"18px"},".cm-scroller":{minHeight:"180px",overflowY:"auto",overflowX:"hidden"}}),s=()=>{var w;const t=document.getElementById("branch-desc"),o=t==null?void 0:t.querySelector(".n-descriptions-table"),g=o==null?void 0:o.querySelector("tbody"),u=document.createElement("tr");u.className="n-descriptions-table-row";const d=document.createElement("th");d.className="n-descriptions-table-header",d.innerHTML="条件表达式",d.setAttribute("colspan","4"),u.appendChild(d),g==null||g.insertBefore(u,g==null?void 0:g.childNodes[4]);const c=g.getElementsByClassName("n-descriptions-table-row")[3];(w=c.querySelector(".n-descriptions-table-header"))==null||w.remove();const N=c.querySelector(".n-descriptions-table-content");N.setAttribute("style","padding: 0"),N==null||N.setAttribute("colspan","4")};return Ve(()=>{var t;pe(()=>{s()}),(t=a.modelValue.decision)!=null&&t.nodeExpression&&(i.value=a.modelValue.decision.nodeExpression)}),(t,o)=>{const g=xe,u=Ne;return p(),I(u,{id:"branch-desc",column:2,"label-placement":"left",bordered:"","label-style":{width:"120px"}},{default:l(()=>[n(g,{label:"节点名称",span:2},{default:l(()=>[S($(t.modelValue.nodeName),1)]),_:1}),n(g,{label:"表达式类型"},{default:l(()=>{var d;return[S($(h(mt)[(d=t.modelValue.decision)==null?void 0:d.expressionType]),1)]}),_:1}),n(g,{label:"条件表达式",span:2,"content-style":{padding:0}},{default:l(()=>[n(h(Vo),{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=d=>i.value=d),readonly:"",disabled:"",theme:f.value,basic:"",lang:h(To)(),extensions:[h(Bo)]},null,8,["modelValue","theme","lang","extensions"])]),_:1})]),_:1})}}}),pl=F({name:"BranchDetail",__name:"branch-detail",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1}},emits:["update:open"],setup(e,{emit:a}){const i=e,f=a,s=y(!1),t=()=>{f("update:open",!1)};return W(()=>i.open,o=>{s.value=o},{immediate:!0}),(o,g)=>{const u=Be;return p(),I(u,{modelValue:s.value,"onUpdate:modelValue":g[0]||(g[0]=d=>s.value=d),title:"决策详情",width:["500px","90%"],onAfterLeave:t},{default:l(()=>[s.value?(p(),I(kt,{key:0,"model-value":o.modelValue},null,8,["model-value"])):B("",!0)]),_:1},8,["modelValue"])}}}),ml={class:"branch-wrap"},fl={class:"branch-box-wrap"},vl={class:"branch-box"},hl={class:"condition-node"},bl={class:"condition-node-box"},gl=["onClick"],_l=["onClick"],wl={class:"title"},yl={class:"node-title"},kl={key:0},Nl={class:"priority-title"},xl={class:"content"},$l=["innerHTML"],Sl={key:1,class:"placeholder"},Vl=["onClick"],Bl={key:1,class:"top-left-cover-line"},Tl={key:2,class:"bottom-left-cover-line"},Cl={key:3,class:"top-right-cover-line"},Dl={key:4,class:"bottom-right-cover-line"},Ll=F({name:"BranchNode",__name:"branch-node",props:{modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:a}){const i=e,f=a,s=he(),t=y({});W(()=>i.modelValue,v=>{t.value=v},{immediate:!0});const o=()=>{const v=t.value.conditionNodes.length;t.value.conditionNodes.splice(-1,0,{nodeName:`${R("workflow.node.condition.conditionNodes.nodeName")} ${v}`,priorityLevel:v,decision:{expressionType:1,nodeExpression:void 0,logicalCondition:1,defaultDecision:0}}),t.value.conditionNodes[v].priorityLevel=v+1},g=(v,V)=>{v.childNode?g(v.childNode,V):v.childNode=V},u=v=>{var V;(V=t.value.conditionNodes)==null||V.splice(v,1),t.value.conditionNodes.length===1&&(t.value.childNode&&(t.value.conditionNodes[0].childNode?g(t.value.conditionNodes[0].childNode,t.value.childNode):t.value.conditionNodes[0].childNode=t.value.childNode),pe(()=>{f("update:modelValue",t.value.conditionNodes[0].childNode)}))},d=(v,V=1)=>{var A;t.value.conditionNodes[v]=t.value.conditionNodes.splice(v+V,1,t.value.conditionNodes[v])[0],(A=t.value.conditionNodes)==null||A.map((z,q)=>z.priorityLevel=q+1),f("update:modelValue",t.value)},r=(v,V)=>{const{nodeName:A,decision:z}=v.conditionNodes[V],{expressionType:q,nodeExpression:k}=z;return k?A!==R("workflow.node.condition.conditionNodes.otherNodeName")?`<span class="content_label">${R("workflow.node.condition.conditionNodes.expressionType")}: </span>${mt[q]}
<span class="content_label">${R("workflow.node.condition.conditionNodes.nodeExpression")}: </span><span style="display: inline-block; vertical-align: bottom; width: 120px; overflow: hidden; text-overflow: ellipsis">${k}<span/>`:R("workflow.node.condition.conditionNodes.otherNodeTip"):A===R("workflow.node.condition.conditionNodes.otherNodeName")?R("workflow.node.condition.conditionNodes.otherNodeTip"):null},c=y(0),N=y(!1),w=y([]),m=y({}),x=v=>{const V=t.value.conditionNodes[c.value].priorityLevel,A=v.priorityLevel;t.value.conditionNodes[c.value]=v,V!==A&&d(c.value,A-V),f("update:modelValue",t.value)},T=v=>{!i.disabled&&v!==t.value.conditionNodes.length-1?(c.value=v,m.value=JSON.parse(JSON.stringify(t.value.conditionNodes[v])),N.value=!0):s.type!==0&&(w.value[v]=!0)},_=y([]),D=y(""),M=y([]),L=(v,V)=>{var A;if(M.value=[],v.nodeName!==R("workflow.node.condition.conditionNodes.otherNodeName"))if(s.type===2){if((A=v.jobBatchList)==null||A.forEach(z=>{var q,k;z.id?(q=M.value)==null||q.push(z.id):z.jobId&&(D.value=(k=z.jobId)==null?void 0:k.toString())}),M.value.length===0){w.value[V]=!0;return}_.value[V]=!0}else s.type===1?w.value[V]=!0:T(V)},P=v=>i.disabled?s.type===2?v.nodeName===R("workflow.node.condition.conditionNodes.otherNodeName")?`node-disabled node-error node-error-${v.taskBatchStatus?J[v.taskBatchStatus].name:"default"}`:`node-error node-error-${v.taskBatchStatus?J[v.taskBatchStatus].name:"default"}`:v.nodeName===R("workflow.node.condition.conditionNodes.otherNodeName")?"node-disabled":"node-error":v.nodeName===R("workflow.node.condition.conditionNodes.otherNodeName")?"node-disabled":"auto-judge-def auto-judge-hover";return(v,V)=>{const A=re,z=wt,q=Te,k=yt,j=ke,G=Ge,ee=_t,te=Ee;return p(),C("div",ml,[b("div",fl,[b("div",vl,[v.disabled?B("",!0):(p(),I(A,{key:0,strong:"",type:"success",class:"add-branch",onClick:o},{default:l(()=>[S($(h(R)("workflow.node.condition.addBranch")),1)]),_:1})),(p(!0),C(K,null,ae(t.value.conditionNodes,(H,E)=>(p(),C("div",{key:E,class:"col-box"},[b("div",hl,[b("div",bl,[b("div",{class:we(["auto-judge",P(H)]),onClick:U=>L(H,E)},[E!==0?(p(),C("div",{key:0,class:"sort-left",onClick:ce(U=>d(E,-1),["stop"])},[n(z)],8,_l)):B("",!0),b("div",wl,[b("span",yl,[n(q,{dot:"",processing:"",color:"#52c41a"}),S("  "+$(H.nodeName)+" ",1),H.id&&H.nodeName!==h(R)("workflow.node.condition.conditionNodes.otherNodeName")?(p(),C("span",kl,"  ("+$(H.id)+") ",1)):B("",!0),H.nodeName===h(R)("workflow.node.condition.conditionNodes.otherNodeName")?(p(),I(j,{key:1},{trigger:l(()=>[n(k,{class:"ml-3px text-16px"})]),default:l(()=>[S(" "+$(h(R)("workflow.node.condition.conditionNodes.otherTip")),1)]),_:1})):B("",!0)]),b("span",Nl,$(h(R)("workflow.node.condition.conditionNodes.priority"))+$(H.priorityLevel),1),v.disabled?B("",!0):(p(),I(G,{key:0,class:"close",onClick:ce(U=>u(E),["stop"])},null,8,["onClick"]))]),b("div",xl,[r(t.value,E)?(p(),C("span",{key:0,innerHTML:r(t.value,E)},null,8,$l)):(p(),C("span",Sl,$(h(R)("workflow.node.condition.conditionNodes.conditionTip")),1))]),E!==t.value.conditionNodes.length-2?(p(),C("div",{key:1,class:"sort-right",onClick:ce(U=>d(E),["stop"])},[n(ee)],8,Vl)):B("",!0),h(s).type===2&&H.taskBatchStatus?(p(),I(j,{key:2},{trigger:l(()=>[b("div",{class:"error-tip text-24px",style:fe({color:h(J)[H.taskBatchStatus].color})},[n(te,{icon:h(J)[H.taskBatchStatus].icon},null,8,["icon"])],4)]),default:l(()=>[S(" "+$(h(J)[H.taskBatchStatus].title),1)]),_:2},1024)):B("",!0)],10,gl),n(be,{modelValue:H.childNode,"onUpdate:modelValue":U=>H.childNode=U,disabled:v.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])])]),H.childNode?ye(v.$slots,"default",{key:0,node:H},void 0,!0):B("",!0),E==0?(p(),C("div",Bl)):B("",!0),E==0?(p(),C("div",Tl)):B("",!0),E==t.value.conditionNodes.length-1?(p(),C("div",Cl)):B("",!0),E==t.value.conditionNodes.length-1?(p(),C("div",Dl)):B("",!0),n(pl,{open:w.value[E],"onUpdate:open":U=>w.value[E]=U,modelValue:t.value.conditionNodes[E],"onUpdate:modelValue":U=>t.value.conditionNodes[E]=U},null,8,["open","onUpdate:open","modelValue","onUpdate:modelValue"]),n(Je,{id:D.value,show:_.value[E],"onUpdate:show":U=>_.value[E]=U,ids:M.value},{default:l(()=>[V[4]||(V[4]=b("div",{class:"header-border"},[b("span",{class:"pl-12px"},"决策节点详情")],-1)),n(kt,{"model-value":t.value.conditionNodes[E]},null,8,["model-value"])]),_:2},1032,["id","show","onUpdate:show","ids"])]))),128))]),n(be,{modelValue:t.value.childNode,"onUpdate:modelValue":V[0]||(V[0]=H=>t.value.childNode=H),disabled:v.disabled},null,8,["modelValue","disabled"])]),n(cl,{open:N.value,"onUpdate:open":V[1]||(V[1]=H=>N.value=H),modelValue:m.value,"onUpdate:modelValue":V[2]||(V[2]=H=>m.value=H),len:t.value.conditionNodes.length,"onUpdate:len":V[3]||(V[3]=H=>t.value.conditionNodes.length=H),onSave:x},null,8,["open","modelValue","len"])])}}}),Ul=ve(Ll,[["__scopeId","data-v-61d296a2"]]),Rl={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function Il(e,a){return p(),C("svg",Rl,a[0]||(a[0]=[b("path",{fill:"currentColor",d:"M112 476h160v72H112zm320 0h160v72H432zm320 0h160v72H752z"},null,-1)]))}const Ml=ie({name:"ant-design-dash-outlined",render:Il}),jl={class:"w-460px flex items-center"},El=F({name:"CallbackDrawer",__name:"callback-drawer",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1}},emits:["update:open","save"],setup(e,{emit:a}){const i=e,f=a,s=y(!1),t=y({});W(()=>i.open,r=>{s.value=r},{immediate:!0}),W(()=>i.modelValue,r=>{t.value=r},{immediate:!0});const o=y(),g=()=>{f("update:open",!1),s.value=!1},u=()=>{var r;(r=o.value)==null||r.validate(c=>{c||(g(),f("save",t.value))}).catch(()=>{var c;return(c=window.$message)==null?void 0:c.warning("请检查表单信息")})},d={workflowNodeStatus:[{required:!0,message:"请选择工作流状态",trigger:"change"}],callback:{webhook:[{required:!0,message:"请输入 webhook",trigger:"change"}],contentType:[{required:!0,message:"请选择请求类型",trigger:"change",type:"number"}],secret:[{required:!0,message:"请输入秘钥",trigger:"change"}]}};return(r,c)=>{const N=Xe,w=Ie,m=Me,x=Ae,T=je,_=ze,D=Re,M=re,L=Ue,P=Le;return p(),I(P,{show:s.value,"onUpdate:show":c[5]||(c[5]=v=>s.value=v),"display-directive":"if",width:500,onAfterLeave:g},{default:l(()=>[n(L,null,{header:l(()=>[b("div",jl,[n(Oe,{modelValue:t.value.nodeName,"onUpdate:modelValue":c[0]||(c[0]=v=>t.value.nodeName=v),class:"mr-16px max-w-320px min-w-320px"},null,8,["modelValue"])])]),footer:l(()=>[n(M,{type:"primary",onClick:u},{default:l(()=>c[6]||(c[6]=[S("保存")])),_:1}),n(M,{class:"ml-12px",onClick:g},{default:l(()=>c[7]||(c[7]=[S("取消")])),_:1})]),default:l(()=>[n(D,{ref_key:"formRef",ref:o,model:t.value,rules:d,"label-align":"left","label-width":"100px"},{default:l(()=>[n(w,{path:"callback.webhook",label:"webhook"},{default:l(()=>[n(N,{value:t.value.callback.webhook,"onUpdate:value":c[1]||(c[1]=v=>t.value.callback.webhook=v),placeholder:"请输入 webhook"},null,8,["value"])]),_:1}),n(w,{path:"callback.contentType",label:"请求类型"},{default:l(()=>[n(m,{value:t.value.callback.contentType,"onUpdate:value":c[2]||(c[2]=v=>t.value.callback.contentType=v),options:h(oo),placeholder:"请选择请求类型"},null,8,["value","options"])]),_:1}),n(w,{path:"callback.secret",label:"秘钥"},{default:l(()=>[n(N,{value:t.value.callback.secret,"onUpdate:value":c[3]||(c[3]=v=>t.value.callback.secret=v),placeholder:"请输入秘钥"},null,8,["value"])]),_:1}),n(w,{name:"workflowNodeStatus",label:"回调通知状态",rules:[{required:!0,message:"请选择回调通知状态",trigger:"change"}]},{default:l(()=>[n(_,{value:t.value.workflowNodeStatus,"onUpdate:value":c[4]||(c[4]=v=>t.value.workflowNodeStatus=v)},{default:l(()=>[n(T,null,{default:l(()=>[(p(!0),C(K,null,ae(h(We),(v,V)=>(p(),I(x,{key:V,label:h(R)(v.label),value:v.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])}}}),zl=F({name:"CallbackDetail",__name:"callback-detail",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1}},emits:["update:open"],setup(e,{emit:a}){const i=e,f=a,s=y(!1);W(()=>i.open,o=>{s.value=o},{immediate:!0});const t=()=>{f("update:open",!1)};return(o,g)=>{const u=xe,d=Ne,r=Be;return p(),I(r,{modelValue:s.value,"onUpdate:modelValue":g[0]||(g[0]=c=>s.value=c),title:"回调详情",width:["500px","90%"],onAfterLeave:t},{default:l(()=>[n(d,{column:1,"label-placement":"left",bordered:"","label-style":{width:"120px"}},{default:l(()=>[n(u,{label:"节点名称"},{default:l(()=>[S($(o.modelValue.nodeName),1)]),_:1}),n(u,{label:"webhook"},{default:l(()=>{var c;return[S($((c=o.modelValue.callback)==null?void 0:c.webhook),1)]}),_:1}),n(u,{label:"请求类型"},{default:l(()=>{var c;return[S($(h(Ye)[(c=o.modelValue.callback)==null?void 0:c.contentType]),1)]}),_:1}),n(u,{label:"密钥"},{default:l(()=>{var c;return[S($((c=o.modelValue.callback)==null?void 0:c.secret),1)]}),_:1}),n(u,{label:"回调通知状态"},{default:l(()=>[S($(o.$t(h(Pe)[o.modelValue.workflowNodeStatus])),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Al={class:"node-wrap"},Ol={class:"branch-box"},Hl={class:"condition-node min-h-230px"},Yl={class:"condition-node-box pt-0px"},ql={class:"popover"},Xl={class:"popover-item"},Wl={class:"popover-item"},Pl=["onClick"],Fl={class:"title"},Gl={class:"text text-#935af6"},Jl={class:"flex items-center"},Zl={key:0},Kl={class:"content min-h-81px"},Ql={key:0,class:"placeholder"},ea={class:"flex justify-between"},ta={class:"content_label"},oa={key:1,class:"top-left-cover-line"},na={key:2,class:"bottom-left-cover-line"},la={key:3,class:"top-right-cover-line"},aa={key:4,class:"bottom-right-cover-line"},sa=F({name:"CallbackNode",__name:"callback-node",props:{modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:a}){const i=e,f=a,s=he(),t=y({});W(()=>i.modelValue,M=>{t.value=M},{immediate:!0});const o=(M,L)=>{M.childNode?o(M.childNode,L):M.childNode=L},g=()=>{t.value.childNode&&(t.value.conditionNodes[0].childNode?o(t.value.conditionNodes[0].childNode,t.value.childNode):t.value.conditionNodes[0].childNode=t.value.childNode),pe(()=>{f("update:modelValue",t.value.conditionNodes[0].childNode)})},u=y(0),d=y(!1),r=y(!1),c=y({}),N=M=>{t.value.conditionNodes[u.value]=M,f("update:modelValue",t.value)},w=M=>{s.type===0?(u.value=M,c.value=JSON.parse(JSON.stringify(t.value.conditionNodes[M])),d.value=!0):r.value=!0},m=y(!1),x=y(""),T=y([]),_=(M,L)=>{var P;if(T.value=[],s.type===2){if((P=M.jobBatchList)==null||P.forEach(v=>{var V,A;v.id?(V=T.value)==null||V.push(v.id):v.jobId&&(x.value=(A=v.jobId)==null?void 0:A.toString())}),T.value.length===0){r.value=!0;return}m.value=!0}else s.type===1?r.value=!0:w(L)},D=M=>i.disabled?s.type===2?`node-error node-error-${M.taskBatchStatus?J[M.taskBatchStatus].name:"default"}`:"node-error":"auto-judge-def auto-judge-hover";return(M,L)=>{const P=vt,v=re,V=pt,A=Ml,z=Te,q=yt,k=ke,j=Ge,G=De,ee=Ee,te=Fe,H=xe,E=Ne;return p(),C("div",Al,[b("div",Ol,[(p(!0),C(K,null,ae(t.value.conditionNodes,(U,X)=>(p(),C("div",{key:X,class:"col-box"},[b("div",Hl,[b("div",Yl,[n(te,{disabled:h(s).type!==2||!0},{trigger:l(()=>{var Y,ue;return[b("div",{class:we(["auto-judge",D(U)]),onClick:Ze=>_(U,X)},[b("div",Fl,[b("span",Gl,[b("span",Jl,[n(z,{processing:"",dot:"",color:U.workflowNodeStatus===1?"#52c41a":"#ff4d4f"},null,8,["color"]),S("  "+$(U.nodeName)+" ",1),U.id?(p(),C("span",Zl," ("+$(U.id)+")",1)):B("",!0),n(k,null,{trigger:l(()=>[n(q,{class:"ml-3px text-16px"})]),default:l(()=>[L[7]||(L[7]=S(" 此节点后续将废弃，请使用定时任务中的 HTTP 内置执行器进行替换。 "))]),_:1})])]),M.disabled?B("",!0):(p(),I(j,{key:0,class:"close",onClick:ce(g,["stop"])}))]),b("div",Kl,[(Y=U.callback)!=null&&Y.webhook?B("",!0):(p(),C("div",Ql,$(h(R)("workflow.node.callback.conditionNodes.webhookTip")),1)),(ue=U.callback)!=null&&ue.webhook?(p(),C(K,{key:1},[b("div",ea,[L[8]||(L[8]=b("span",{class:"content_label"},"Webhook:",-1)),n(G,{class:"w-116px"},{default:l(()=>[S($(U.callback.webhook),1)]),_:2},1024)]),b("div",null,[b("span",ta,$(h(R)("workflow.node.callback.conditionNodes.contentType"))+": ",1),S(" "+$(h(Ye)[U.callback.contentType]),1)]),L[9]||(L[9]=b("div",null,".........",-1))],64)):B("",!0)]),h(s).type===2&&U.taskBatchStatus?(p(),I(k,{key:0},{trigger:l(()=>[b("div",{class:"error-tip text-24px",style:fe({color:h(J)[U.taskBatchStatus].color})},[n(ee,{icon:h(J)[U.taskBatchStatus].icon},null,8,["icon"])],4)]),default:l(()=>[S(" "+$(h(J)[U.taskBatchStatus].title),1)]),_:2},1024)):B("",!0)],10,Pl)]}),default:l(()=>[b("div",ql,[n(v,{text:""},{default:l(()=>[b("span",Xl,[n(P,{class:"mb-3px text-24px font-bold"}),S(" "+$(h(R)("common.retry")),1)])]),_:1}),n(V,{vertical:""}),n(v,{text:""},{default:l(()=>[b("span",Wl,[n(A,{class:"mb-3px text-24px font-bold"}),L[6]||(L[6]=b("span",null,"忽略",-1))])]),_:1})])]),_:2},1032,["disabled"]),n(be,{modelValue:U.childNode,"onUpdate:modelValue":Y=>U.childNode=Y,disabled:M.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])])]),U.childNode?ye(M.$slots,"default",{key:0,node:U},void 0,!0):B("",!0),X==0?(p(),C("div",oa)):B("",!0),X==0?(p(),C("div",na)):B("",!0),X==t.value.conditionNodes.length-1?(p(),C("div",la)):B("",!0),X==t.value.conditionNodes.length-1?(p(),C("div",aa)):B("",!0)]))),128))]),t.value.conditionNodes.length>1?(p(),I(be,{key:0,modelValue:t.value.childNode,"onUpdate:modelValue":L[0]||(L[0]=U=>t.value.childNode=U),disabled:M.disabled},null,8,["modelValue","disabled"])):B("",!0),h(s).type!==0?(p(),I(zl,{key:1,open:r.value,"onUpdate:open":L[1]||(L[1]=U=>r.value=U),modelValue:t.value.conditionNodes[0],"onUpdate:modelValue":L[2]||(L[2]=U=>t.value.conditionNodes[0]=U)},null,8,["open","modelValue"])):B("",!0),n(El,{open:d.value,"onUpdate:open":L[3]||(L[3]=U=>d.value=U),modelValue:c.value,"onUpdate:modelValue":L[4]||(L[4]=U=>c.value=U),onSave:N},null,8,["open","modelValue"]),h(s).type!==0?(p(),I(Je,{key:2,id:x.value,show:m.value,"onUpdate:show":L[5]||(L[5]=U=>m.value=U),ids:T.value},{default:l(()=>[L[10]||(L[10]=b("div",{class:"header-border"},[b("span",{class:"pl-18px"},"回调节点详情")],-1)),n(E,{column:1,bordered:"","label-style":{width:"120px"}},{default:l(()=>[n(H,{label:"节点名称"},{default:l(()=>[S($(t.value.conditionNodes[0].nodeName),1)]),_:1}),n(H,{label:"webhook"},{default:l(()=>{var U;return[S($((U=t.value.conditionNodes[0].callback)==null?void 0:U.webhook),1)]}),_:1}),n(H,{label:"请求类型"},{default:l(()=>{var U;return[S($(h(Ye)[(U=t.value.conditionNodes[0].callback)==null?void 0:U.contentType]),1)]}),_:1}),n(H,{label:"密钥"},{default:l(()=>{var U;return[S($((U=t.value.conditionNodes[0].callback)==null?void 0:U.secret),1)]}),_:1})]),_:1})]),_:1},8,["id","show","ids"])):B("",!0)])}}}),ia=ve(sa,[["__scopeId","data-v-39010ff7"]]),da=F({name:"NodeWrap",__name:"node-wrap",props:{modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["refresh","update:modelValue"],setup(e,{emit:a}){const i=e,f=a,s=y({});return W(()=>i.modelValue,t=>{s.value=t},{immediate:!0}),W(()=>s.value,t=>{f("update:modelValue",t)}),(t,o)=>{const g=no("NodeWrap",!0);return p(),C(K,null,[s.value.nodeType==1?(p(),I(sl,{key:0,modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=u=>s.value=u),disabled:t.disabled,onRefresh:o[1]||(o[1]=()=>f("refresh"))},{default:l(({node:u})=>[u?(p(),I(g,{key:0,modelValue:u.childNode,"onUpdate:modelValue":d=>u.childNode=d,disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])):B("",!0)]),_:1},8,["modelValue","disabled"])):B("",!0),s.value.nodeType==2?(p(),I(Ul,{key:1,modelValue:s.value,"onUpdate:modelValue":o[2]||(o[2]=u=>s.value=u),disabled:t.disabled},{default:l(({node:u})=>[u?(p(),I(g,{key:0,modelValue:u.childNode,"onUpdate:modelValue":d=>u.childNode=d,disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])):B("",!0)]),_:1},8,["modelValue","disabled"])):B("",!0),s.value.nodeType==3?(p(),I(ia,{key:2,modelValue:s.value,"onUpdate:modelValue":o[3]||(o[3]=u=>s.value=u),disabled:t.disabled},{default:l(({node:u})=>[u?(p(),I(g,{key:0,modelValue:u.childNode,"onUpdate:modelValue":d=>u.childNode=d,disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])):B("",!0)]),_:1},8,["modelValue","disabled"])):B("",!0),s.value.childNode?(p(),I(g,{key:3,modelValue:s.value.childNode,"onUpdate:modelValue":o[4]||(o[4]=u=>s.value.childNode=u),disabled:t.disabled},null,8,["modelValue","disabled"])):B("",!0)],64)}}}),ra=F({name:"StartDetail",__name:"start-detail",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1}},emits:["update:open"],setup(e,{emit:a}){const i=e,f=a,s=y(!1);W(()=>i.open,o=>{s.value=o},{immediate:!0});const t=()=>{f("update:open",!1)};return(o,g)=>{const u=xe,d=Ne,r=Be;return p(),I(r,{modelValue:s.value,"onUpdate:modelValue":g[0]||(g[0]=c=>s.value=c),title:"工作流详情",width:["500px","90%"],onAfterLeave:t},{default:l(()=>[n(d,{column:1,"label-placement":"left",bordered:"","label-style":{width:"120px"}},{default:l(()=>[n(u,{label:"工作流名称"},{default:l(()=>[S($(o.modelValue.workflowName),1)]),_:1}),n(u,{label:"组名称"},{default:l(()=>[S($(o.modelValue.groupName),1)]),_:1}),n(u,{label:"触发类型"},{default:l(()=>[S($(h(R)(h(lo)[o.modelValue.triggerType])),1)]),_:1}),n(u,{label:"触发间隔"},{default:l(()=>[S($(o.modelValue.triggerInterval)+" "+$(o.modelValue.triggerType===2?"秒":null),1)]),_:1}),n(u,{label:"执行超时时间"},{default:l(()=>[S($(o.modelValue.executorTimeout)+" 秒",1)]),_:1}),n(u,{label:"阻塞策略"},{default:l(()=>[S($(h(R)(h(ft)[o.modelValue.blockStrategy])),1)]),_:1}),n(u,{label:"工作流上下文"},{default:l(()=>[S($(o.modelValue.wfContext),1)]),_:1}),n(u,{label:"工作流状态"},{default:l(()=>[S($(h(R)(h(Pe)[o.modelValue.workflowStatus])),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),ua=F({name:"StartDrawer",__name:"start-drawer",props:{modelValue:{default:()=>({wfContexts:[]})},open:{type:Boolean,default:!1}},emits:["update:open","save"],setup(e,{emit:a}){const i=y([]),f=e;Ve(()=>{pe(()=>{s()})});async function s(){const _=await Lo(4);i.value=_.data}const t=a,o=he();let g="";const u=y(!1),d=y({wfContexts:[],notifyIds:[]}),r=y([]);W(()=>f.open,_=>{u.value=_},{immediate:!0}),W(()=>f.modelValue,_=>{d.value=_,_.triggerInterval||(d.value.triggerType=2,d.value.triggerInterval="60"),_.triggerType===2&&(d.value.triggerInterval=_.triggerInterval),_.workflowName?g=_.workflowName:_.groupName?g=_.groupName:g="请选择组",_.wfContext&&(d.value.wfContext=JSON.parse(_.wfContext),d.value.wfContexts=ao(_.wfContext))},{immediate:!0});const c=y(),N=()=>{t("update:open",!1),u.value=!1},w=()=>{var _;(_=c.value)==null||_.validate(D=>{D||(d.value.wfContext=JSON.stringify(uo(d.value.wfContexts)||{}),N(),t("save",d.value))}).catch(()=>{var D;return(D=window.$message)==null?void 0:D.warning("请检查表单信息")})};(async()=>{const{data:_,error:D}=await Uo();D||(r.value=_)})();const x=_=>{_===3?d.value.triggerInterval="* * * * * ?":_===2&&(d.value.triggerInterval="60")},T={groupName:{required:!0,message:"请选择组"},triggerType:{required:!0,message:"请选择触发类型"},triggerInterval:{required:!0,message:"请输入触发间隔"},executorTimeout:{required:!0,message:"请输入执行超时时间"},blockStrategy:{required:!0,message:"请选择阻塞策略"},workflowStatus:{required:!0,message:"请选择工作流状态"}};return(_,D)=>{const M=Me,L=Ie,P=xo,v=Do,V=No,A=io,z=Ae,q=je,k=ze,j=ht,G=Co,ee=Xe,te=Re,H=re,E=Ue,U=Le;return p(),I(U,{show:u.value,"onUpdate:show":D[11]||(D[11]=X=>u.value=X),"display-directive":"if",width:610,onAfterLeave:N},{default:l(()=>[n(E,{title:h(g)},{header:l(()=>[n(Oe,{modelValue:d.value.workflowName,"onUpdate:modelValue":D[0]||(D[0]=X=>d.value.workflowName=X),class:"max-w-570px min-w-570px"},null,8,["modelValue"])]),footer:l(()=>[n(H,{type:"primary",onClick:w},{default:l(()=>D[13]||(D[13]=[S("保存")])),_:1}),n(H,{class:"ml-12px",onClick:N},{default:l(()=>D[14]||(D[14]=[S("取消")])),_:1})]),default:l(()=>[n(te,{ref_key:"formRef",ref:c,model:d.value,rules:T,"label-align":"left","label-width":"100px"},{default:l(()=>{var X;return[n(L,{path:"groupName",label:"组名称"},{default:l(()=>[n(M,{value:d.value.groupName,"onUpdate:value":D[1]||(D[1]=Y=>d.value.groupName=Y),placeholder:"请选择组",disabled:h(o).type===0&&h(Se)(h(o).id),options:r.value.map(Y=>({label:Y,value:Y}))},null,8,["value","disabled","options"])]),_:1}),n(V,{cols:d.value.triggerType===5?"1":"2 s:1 m:2",responsive:"screen","x-gap":"20"},{default:l(()=>[n(P,null,{default:l(()=>[n(L,{path:"triggerType",label:"触发类型"},{default:l(()=>[n(M,{value:d.value.triggerType,"onUpdate:value":[D[2]||(D[2]=Y=>d.value.triggerType=Y),x],placeholder:"请选择触发类型",options:h(so).map(Y=>({label:h(R)(Y.label),value:Y.value}))},null,8,["value","options"])]),_:1})]),_:1}),n(P,null,{default:l(()=>[n(L,{label:h(R)("page.jobTask.triggerInterval"),path:"triggerInterval"},{default:l(()=>[n(v,{modelValue:d.value.triggerInterval,"onUpdate:modelValue":D[3]||(D[3]=Y=>d.value.triggerInterval=Y),"trigger-type":d.value.triggerType??2},null,8,["modelValue","trigger-type"])]),_:1},8,["label"])]),_:1})]),_:1},8,["cols"]),n(V,{cols:24,"x-gap":"20"},{default:l(()=>[n(P,{span:8},{default:l(()=>[n(L,{path:"executorTimeout",label:"执行超时时间"},{default:l(()=>[n(A,{value:d.value.executorTimeout,"onUpdate:value":D[4]||(D[4]=Y=>d.value.executorTimeout=Y),placeholder:"请输入超时时间",min:1},{suffix:l(()=>D[12]||(D[12]=[S("秒")])),_:1},8,["value"])]),_:1})]),_:1}),n(P,{span:16},{default:l(()=>[n(L,{path:"blockStrategy",label:"阻塞策略"},{default:l(()=>[n(k,{value:d.value.blockStrategy,"onUpdate:value":D[5]||(D[5]=Y=>d.value.blockStrategy=Y)},{default:l(()=>[n(q,null,{default:l(()=>[(p(!0),C(K,null,ae(h(ro),(Y,ue)=>(p(),I(z,{key:ue,label:h(R)(Y.label),value:Y.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),n(L,{path:"wfContext",label:"工作流上下文","show-feedback":!((X=d.value.wfContexts)!=null&&X.length)},{default:l(()=>[n(j,{value:d.value.wfContexts,"onUpdate:value":D[6]||(D[6]=Y=>d.value.wfContexts=Y),path:"wfContexts"},null,8,["value"])]),_:1},8,["show-feedback"]),n(L,{path:"workflowStatus",label:"节点状态"},{default:l(()=>[n(k,{value:d.value.workflowStatus,"onUpdate:value":D[7]||(D[7]=Y=>d.value.workflowStatus=Y)},{default:l(()=>[n(q,null,{default:l(()=>[(p(!0),C(K,null,ae(h(We),(Y,ue)=>(p(),I(z,{key:ue,label:h(R)(Y.label),value:Y.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1}),n(L,{path:"ownerId",label:"负责人"},{default:l(()=>[n(G,{value:d.value.ownerId,"onUpdate:value":D[8]||(D[8]=Y=>d.value.ownerId=Y),clearable:!0},null,8,["value"])]),_:1}),n(L,{path:"notifyIds",label:"告警通知"},{default:l(()=>[n(M,{value:d.value.notifyIds,"onUpdate:value":D[9]||(D[9]=Y=>d.value.notifyIds=Y),"value-field":"id","label-field":"notifyName",placeholder:"请选择告警通知名称",options:i.value,clearable:"",multiple:""},null,8,["value","options"])]),_:1}),n(L,{path:"description",label:"描述"},{default:l(()=>[n(ee,{value:d.value.description,"onUpdate:value":D[10]||(D[10]=Y=>d.value.description=Y),type:"textarea",autosize:{minRows:5},placeholder:"请输入描述"},null,8,["value"])]),_:1})]}),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),ca={class:"node-wrap"},pa={class:"title"},ma={class:"text"},fa={class:"text-#ff943e"},va={key:0,class:"content"},ha={key:1,class:"content min-h-85px"},ba=F({name:"StartNode",__name:"start-node",props:{modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:a}){const i=e,f=a,s=he(),t=y({}),o=y({});W(()=>i.modelValue,c=>{o.value=c},{immediate:!0}),W(()=>o.value,c=>{f("update:modelValue",c)}),W(()=>{var c;return(c=o.value)==null?void 0:c.groupName},c=>{c&&s.setJobList(c)},{immediate:!0});const g=y(!1),u=y(!1),d=c=>{o.value=c},r=()=>{s.type===0?(t.value=JSON.parse(JSON.stringify(o.value)),g.value=!0):u.value=!0};return(c,N)=>{const w=Te,m=De,x=Ee,T=ke;return p(),C("div",ca,[b("div",{class:we([`${c.disabled?"start-node-disabled":"node-wrap-box-hover"} ${h(s).type===2?"node-error-success":""}`,"node-wrap-box start-node"]),onClick:r},[b("div",pa,[b("span",ma,[n(w,{dot:"",color:o.value.workflowStatus===1?"#52c41a":"#ff000d"},null,8,["color"]),b("span",fa,"  "+$(o.value.workflowName?`${o.value.workflowName} ${o.value.id?` (${o.value.id})`:""}`:"请选择组"),1)])]),o.value.groupName?(p(),C("div",va,[b("div",null,[n(m,{class:"max-w-132px"},{default:l(()=>[N[5]||(N[5]=b("span",{class:"content_label"},"组名称: ",-1)),S(" "+$(o.value.groupName),1)]),_:1})]),b("div",null,[N[6]||(N[6]=b("span",{class:"content_label"},"阻塞策略: ",-1)),S(" "+$(h(R)(h(ft)[o.value.blockStrategy])),1)]),N[7]||(N[7]=b("div",null,".........",-1))])):(p(),C("div",ha,N[8]||(N[8]=[b("span",{class:"placeholder"},"请配置工作流",-1)]))),h(s).type===2?(p(),I(T,{key:2},{trigger:l(()=>[b("div",{class:"error-tip text-24px",style:fe({color:h(J)[3].color})},[n(x,{icon:h(J)[3].icon},null,8,["icon"])],4)]),default:l(()=>[S(" "+$(h(J)[3].title),1)]),_:1})):B("",!0)],2),n(be,{modelValue:o.value.nodeConfig,"onUpdate:modelValue":N[0]||(N[0]=_=>o.value.nodeConfig=_),disabled:c.disabled},null,8,["modelValue","disabled"]),h(s).type!==0?(p(),I(ra,{key:0,open:u.value,"onUpdate:open":N[1]||(N[1]=_=>u.value=_),modelValue:o.value,"onUpdate:modelValue":N[2]||(N[2]=_=>o.value=_)},null,8,["open","modelValue"])):B("",!0),n(ua,{open:g.value,"onUpdate:open":N[3]||(N[3]=_=>g.value=_),modelValue:t.value,"onUpdate:modelValue":N[4]||(N[4]=_=>t.value=_),onSave:d},null,8,["open","modelValue"])])}}}),ga=ve(ba,[["__scopeId","data-v-f871de54"]]),_a={class:"workflow"},wa={class:"workflow-affix"},ya={class:"header"},ka={class:"ml-8px mr-8px text-18px text-#333639 dark:text-#d6d6d6"},Na={key:0,class:"buttons flex-y-center"},xa={key:0,class:"flex-y-center gap-6px"},$a={key:1,class:"buttons"},Sa={class:"workflow-body"},Va={class:"box-scale"},Ba={class:"end-node"},Ta={class:"end-node-text"},Xa=F({name:"SnailWorkflow",__name:"workflow",props:{modelValue:{default:()=>({})},spinning:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},updated:{type:Boolean,default:!1}},emits:["update:modelValue","save","cancel","refresh"],setup(e,{emit:a}){const i=e,f=a,s=ut(),t=y(100),o=y({}),g=async()=>{f("save")},u=()=>{f("cancel")};W(()=>i.modelValue,w=>{o.value=w},{immediate:!0}),W(()=>o.value,w=>{f("update:modelValue",w)});const d=w=>{if(t.value+=10*w,w>0){const m=document.querySelector(".workflow-body");m&&(t.value<=160&&m.scrollTo({left:280*t.value/100,behavior:"smooth"}),t.value>160&&m.scrollTo({left:420*t.value/100,behavior:"smooth"}),t.value>200&&m.scrollTo({left:520*t.value/100,behavior:"smooth"}))}t.value<=10?t.value=10:t.value>=300&&(t.value=300)},r=w=>{w.preventDefault(),w.wheelDelta<0?d(-1):d(1)};Ve(()=>{const w=document.querySelector(".workflow");w&&(w.onwheel=m=>r(m))});const c=()=>{const w=document.querySelector(".workflow-design");w&&w.setAttribute("style",`cursor: grabbing; transform: scale(${t.value/100})`)},N=()=>{const w=document.querySelector(".workflow-design");w&&w.setAttribute("style",`cursor: grab; transform: scale(${t.value/100})`)};return(w,m)=>{const x=Zo,T=re,_=ke,D=bt,M=Te,L=zo,P=ct;return p(),C("div",_a,[b("div",wa,[n(L,{"trigger-top":0,class:"position-sticky z-2"},{default:l(()=>[b("div",ya,[b("div",null,[n(_,null,{trigger:l(()=>[n(T,{size:"small",strong:"",circle:"",onClick:m[0]||(m[0]=v=>d(-1))},{default:l(()=>[n(x)]),_:1})]),default:l(()=>[m[5]||(m[5]=S(" 缩小 "))]),_:1}),b("span",ka,$(t.value)+"%",1),n(_,null,{trigger:l(()=>[n(T,{size:"small",strong:"",circle:"",onClick:m[1]||(m[1]=v=>d(1))},{default:l(()=>[n(D)]),_:1})]),default:l(()=>[m[6]||(m[6]=S(" 放大 "))]),_:1})]),w.disabled?B("",!0):(p(),C("div",Na,[w.updated?(p(),C("div",xa,[n(M,{dot:"",processing:""}),m[7]||(m[7]=b("span",{class:"mr-16px text-12px text-error"},"修改未保存",-1))])):B("",!0),n(T,{type:"info",onClick:g},{default:l(()=>m[8]||(m[8]=[S("保存")])),_:1}),n(T,{class:"ml-16px",onClick:u},{default:l(()=>m[9]||(m[9]=[S("取消")])),_:1})])),w.disabled&&h(s).buttons?(p(),C("div",$a,[ye(w.$slots,"buttons")])):B("",!0)])]),_:3}),n(P,{show:w.spinning},{default:l(()=>[b("div",Sa,[n(h(gt),{class:"vue-drag","is-draggable":!0,"is-resizable":!1,z:1,onDragging:c,onDragstop:N},{default:l(()=>[b("div",{class:"workflow-design",style:fe(`transform: scale(${t.value/100})`)},[b("div",Va,[n(ga,{modelValue:o.value,"onUpdate:modelValue":m[2]||(m[2]=v=>o.value=v),disabled:w.disabled},null,8,["modelValue","disabled"]),o.value.nodeConfig?(p(),I(da,{key:0,modelValue:o.value.nodeConfig,"onUpdate:modelValue":m[3]||(m[3]=v=>o.value.nodeConfig=v),disabled:w.disabled,onRefresh:m[4]||(m[4]=()=>f("refresh"))},null,8,["modelValue","disabled"])):B("",!0),b("div",Ba,[m[10]||(m[10]=b("div",{class:"end-node-circle"},null,-1)),b("div",Ta,$(h(R)("workflow.node.endNode")),1)])])],4)]),_:1})])]),_:1},8,["show"])])])}}});export{Xa as _,he as u};
