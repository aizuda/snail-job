import{d as k,k as _,bZ as h,r as l,i as y,q as S,ce as $,c as x,o as C,h as J,cf as O,$ as s}from"./index-C0p55rrf.js";import{u as b,_ as B}from"./workflow.vue_vue_type_style_index_0_lang-DgZmN2Yz.js";import{h as I,i as R}from"./workflow-DNUT-EGc.js";import"./job-task-list-table.vue_vue_type_script_setup_true_lang-Bbijcswj.js";import"./table-B8N7pgiA.js";import"./Grid-DvIYbIW9.js";import"./job-BTjPiUsA.js";import"./label-list-Clk3Q1a1.js";import"./dashboard-CJiJ5IBm.js";import"./DynamicTags-CJUeOSLO.js";import"./detail-drawer-DhJfUjjQ.js";import"./DescriptionsItem-DYBNfpdM.js";import"./log-drawer-T9fmWW3c.js";import"./CollapseItem-BWVJFROc.js";import"./dynamic-input.vue_vue_type_script_setup_true_lang-B2eFDYjd.js";import"./DynamicInput-IPp7NvjD.js";import"./code-mirror-D-y4YCVa.js";import"./system-user.vue_vue_type_script_setup_true_lang-Bf0IYB9E.js";import"./job-trigger-interval.vue_vue_type_script_setup_true_lang-Omhcuv5e.js";import"./cron-input.vue_vue_type_style_index_0_lang-C2pNQ4BC.js";import"./DatePicker--2_VzZ6E.js";import"./notify-BCrZajLG.js";import"./group-Bzk_FTzz.js";const to=k({name:"workflow_form_edit",__name:"index",setup(T){const i=b(),f=_(),p=h(),m=l(!1),u=String(f.query.id);let c={};const t=l({}),d=async()=>{m.value=!0;const{data:o,error:e}=await I(u);e||(t.value=o,c=O(o)),m.value=!1},a=l(!1);y(()=>{i.clear(),i.setType(0),i.setId(u),d()}),S(()=>t.value,o=>{a.value=v(o,c)},{deep:!0});const w=async()=>{var e;const{error:o}=await R(t.value);o||((e=window.$message)==null||e.info(s("common.updateSuccess")),Object.assign(c,t.value),a.value=!1,p.push({path:"/workflow/task"}))};function v(o,e){const n=JSON.stringify(o),r=JSON.stringify({...o,...e});return n!==r}const g=()=>{p.push("/workflow/task")};return $((o,e,n)=>{var r;a.value?(r=window.$dialog)==null||r.warning({title:s("common.warning"),content:"有未保存的数据，是否确认离开？",positiveText:s("common.confirm"),negativeText:s("common.cancel"),onPositiveClick:()=>{n()}}):n()}),(o,e)=>(C(),x(J(B),{modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=n=>t.value=n),spinning:m.value,updated:a.value,onSave:w,onCancel:g},null,8,["modelValue","spinning","updated"]))}});export{to as default};
