import{aR as K,b as S,o as c,e as i,d as Q,a0 as W,a1 as X,K as Z,r as g,aB as F,q as b,c as k,Q as ee,a6 as te,w as n,f as a,aH as ae,g as V,t as le,h as J,a3 as z,F as ne,ad as se,B as ue,a4 as oe,D as re,aI as x,an as ie}from"./index-C0p55rrf.js";import{b as de}from"./table-B8N7pgiA.js";import{_ as pe,a as me}from"./cron-input.vue_vue_type_style_index_0_lang-C2pNQ4BC.js";import{c as ce,d as ge}from"./Grid-DvIYbIW9.js";import{_ as ve}from"./DatePicker--2_VzZ6E.js";const fe={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function _e(Y,u){return c(),S("svg",fe,u[0]||(u[0]=[i("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"},null,-1)]))}const ye=K({name:"ep-delete",render:_e}),be={class:"flex items-center gap-6px"},De={class:"flex items-center gap-6px"},we={class:"flex items-center gap-6px"},Me={class:"flex items-center gap-6px"},Ne={class:"flex items-center gap-12px"},xe=Q({name:"JobTriggerInterval",__name:"job-trigger-interval",props:W({triggerType:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(Y){const u=X(Y,"modelValue"),p=Y,A=Z(),D=g(p.triggerType===2?Number(u.value):60),w=g(p.triggerType===3?u.value:"* * * * * ?"),$=t=>{try{const e=JSON.parse(t);return Array.isArray(e)?e:[null]}catch{return[null]}},l=g(p.triggerType===5&&u.value?$(u.value):[null]),M=g(F().add(15,"second").valueOf()),N=g("second"),H=g(10),v=g(1),L=[{label:"秒",value:"second"},{label:"分钟",value:"minute"},{label:"小时",value:"hour"},{label:"天",value:"day"},{label:"月",value:"month"},{label:"年",value:"year"}];b(D,t=>{p.triggerType===2&&(u.value=`${t}`)},{immediate:!0}),b(w,t=>{p.triggerType===3&&(u.value=t)},{immediate:!0}),b(()=>u.value,t=>{if(p.triggerType===5&&t){const e=$(t);JSON.stringify(e)!==JSON.stringify(l.value)&&(l.value=e)}}),b(()=>p.triggerType,t=>{t===2?u.value=`${D.value}`:t===3?u.value=w.value:t===5?(M.value=F().add(60,"second").valueOf(),u.value&&(l.value=$(u.value)),u.value=JSON.stringify(l.value)):u.value="*"},{immediate:!0}),b(l,t=>{p.triggerType===5&&(u.value=JSON.stringify(t))},{deep:!0});const j=()=>{if(x(N.value)&&x(H.value)&&x(v.value)&&v.value>0){l.value=l.value.filter(e=>x(e));const t=new Date(M.value);for(let e=0;e<v.value;e+=1){const s=F(t).add(e*H.value,N.value).format("YYYY-MM-DD HH:mm:ss");l.value.includes(s)||l.value.push(s)}return}l.value.push(null)},G=()=>{l.value.push(null)},R=t=>{l.value.splice(t,1),l.value.length===0&&l.value.push(null)},P=(t,e)=>{var f;return t&&l.value.findIndex((d,m)=>m!==e&&d===t)!==-1?((f=window.$message)==null||f.warning(`该时间点 ${t} 已存在，请选择其他时间`),ie(()=>{l.value[e]=null}),!1):!0},I=t=>{const e=new Date,s=new Date(t);return s.getFullYear()<e.getFullYear()||s.getFullYear()===e.getFullYear()&&s.getMonth()<e.getMonth()||s.getFullYear()===e.getFullYear()&&s.getMonth()===e.getMonth()&&s.getDate()<e.getDate()},U=t=>{const e=new Date,s=new Date(t);return s.getFullYear()===e.getFullYear()&&s.getMonth()===e.getMonth()&&s.getDate()===e.getDate()?{isHourDisabled:d=>d<e.getHours(),isMinuteDisabled:(d,m)=>{const o=m??e.getHours();return o<e.getHours()?!0:o>e.getHours()?!1:d<e.getMinutes()},isSecondDisabled:(d,m,o)=>{const T=o??e.getHours(),_=m??e.getMinutes();return T<e.getHours()?!0:T>e.getHours()?!1:_<e.getMinutes()?!0:_>e.getMinutes()?!1:d<e.getSeconds()}}:{isHourDisabled:()=>!1,isMinuteDisabled:()=>!1,isSecondDisabled:()=>!1}};return(t,e)=>{const s=ae,f=pe,d=te,m=ve,o=ge,T=se,_=de,C=ue,B=ce,O=ne,q=ye,E=re;return c(),S("div",null,[t.triggerType===2?(c(),k(d,{key:0},{default:n(()=>[a(s,{value:D.value,"onUpdate:value":e[0]||(e[0]=r=>D.value=r),placeholder:t.$t("page.jobTask.form.triggerInterval")},null,8,["value","placeholder"]),a(f,null,{default:n(()=>[V(le(t.$t("common.second")),1)]),_:1})]),_:1})):t.triggerType===3?(c(),k(J(me),{key:1,modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=r=>w.value=r),placeholder:t.$t("page.jobTask.form.triggerInterval_CRON"),lang:J(A).locale},null,8,["modelValue","placeholder","lang"])):t.triggerType===5?(c(),S(z,{key:2},[a(O,{title:"批量生成指定时间点",size:"small",class:"mb-4"},{default:n(()=>[a(B,{cols:"24","x-gap":"12","y-gap":"12"},{default:n(()=>[a(o,{span:24},{default:n(()=>[i("div",be,[e[6]||(e[6]=i("span",{class:"w-85px"},"开始时间:",-1)),a(m,{value:M.value,"onUpdate:value":e[2]||(e[2]=r=>M.value=r),class:"w-full",clearable:"",type:"datetime",format:"yyyy-MM-dd HH:mm:ss","is-date-disabled":I,"is-time-disabled":U},null,8,["value"])])]),_:1}),a(o,{span:12},{default:n(()=>[i("div",De,[e[7]||(e[7]=i("span",{class:"w-50px"},"步长:",-1)),a(s,{value:H.value,"onUpdate:value":e[3]||(e[3]=r=>H.value=r),min:10,class:"w-full",placeholder:"步长"},null,8,["value"])])]),_:1}),a(o,{span:12},{default:n(()=>[i("div",we,[e[8]||(e[8]=i("span",{class:"w-50px"},"单位:",-1)),a(T,{value:N.value,"onUpdate:value":e[4]||(e[4]=r=>N.value=r),options:L,class:"w-full"},null,8,["value"])])]),_:1}),a(o,{span:12},{default:n(()=>[i("div",Me,[e[9]||(e[9]=i("span",{class:"w-50px"},"个数:",-1)),a(s,{value:v.value,"onUpdate:value":e[5]||(e[5]=r=>v.value=r),min:1,class:"w-full",placeholder:"个数"},null,8,["value"])])]),_:1}),a(o,{span:24},{default:n(()=>[a(C,{class:"w-full",dashed:"",onClick:j},{icon:n(()=>[a(_)]),default:n(()=>[e[10]||(e[10]=V(" 批量生成 "))]),_:1})]),_:1})]),_:1})]),_:1}),a(O,{title:"指定时间点列表",size:"small"},{default:n(()=>[a(B,{cols:"24","x-gap":"6","y-gap":"6"},{default:n(()=>[(c(!0),S(z,null,oe(l.value,(r,y)=>(c(),k(o,{key:y,span:24},{default:n(()=>[i("div",Ne,[a(m,{"formatted-value":l.value[y],"onUpdate:formattedValue":[h=>l.value[y]=h,h=>P(h,y)],class:"w-full",clearable:"",type:"datetime",format:"yyyy-MM-dd HH:mm:ss","is-date-disabled":I,"is-time-disabled":U},null,8,["formatted-value","onUpdate:formattedValue"]),a(C,{type:"error",ghost:"",onClick:h=>R(y)},{icon:n(()=>[a(q)]),default:n(()=>[e[11]||(e[11]=V(" 删除 "))]),_:2},1032,["onClick"])])]),_:2},1024))),128)),a(o,{span:24},{default:n(()=>[a(C,{class:"mt-6px w-full",dashed:"",onClick:G},{icon:n(()=>[a(_)]),default:n(()=>[e[12]||(e[12]=V(" 新增空白选择器 "))]),_:1})]),_:1})]),_:1})]),_:1})],64)):t.triggerType===99?(c(),k(E,{key:3,disabled:""})):ee("",!0)])}}});export{xe as _};
