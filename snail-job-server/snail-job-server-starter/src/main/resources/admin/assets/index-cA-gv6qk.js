import{_ as oe}from"./table-header-operation.vue_vue_type_script_setup_true_lang-ntuddL0e.js";import{d as j,U as z,V as K,a as L,$ as l,r as re,p as ue,W as ie,o as x,c as O,w as t,f as a,g as T,t as $,h as e,b as V,Q as I,cf as Q,R as A,bQ as H,n as Y,a3 as J,B,cd as pe,ce as me,Y as W,I as X,s as de,a9 as E,cg as ce,N as q,bU as _e,aa as ge}from"./index-DQvTTbM-.js";import{f as fe,e as ve}from"./system-manage-BPhCfOzv.js";import{_ as he,u as be,a as Ne,N as ye}from"./table-BY-eM7wn.js";import{u as Z,a as ee,_ as ke,b as ae}from"./form-Bu4MD_Ly.js";import{_ as we,a as Re,e as xe,b as Ue}from"./Grid-CSTnYjse.js";import{_ as le}from"./Space-B5Upi9VN.js";import{_ as Se,a as Ge}from"./round-search-DSNvd4Y0.js";const Pe=j({name:"UserOperateDrawer",__name:"user-operate-drawer",props:z({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:z(["submitted"],["update:visible"]),setup(v,{emit:S}){const h=v,w=S,_=K(v,"visible"),{formRef:N,validate:i,restoreValidation:G}=Z(),{defaultRequiredRule:y}=ee(),P=L(()=>({add:l("page.manage.user.addUser"),edit:l("page.manage.user.editUser")})[h.operateType]),o=re(p());function p(){return{userName:"",userGender:null,nickName:"",userPhone:"",userEmail:"",userRoles:[],status:null}}const k={userName:y,status:y},d=ue([]);async function U(){const{error:g,data:u}=await fe();if(!g){const f=u.map(n=>({label:n.roleName,value:n.roleCode})),s=o.userRoles.map(n=>({label:n,value:n}));d.value=[...s,...f]}}function b(){Object.assign(o,p()),h.operateType==="edit"&&h.rowData&&Object.assign(o,h.rowData)}function R(){_.value=!1}async function D(){var g;await i(),(g=window.$message)==null||g.success(l("common.updateSuccess")),R(),w("submitted")}return ie(_,()=>{_.value&&(b(),G(),U())}),(g,u)=>{const f=Y,s=ke,n=Re,m=we,M=J,F=ae,c=B,ne=le,te=pe,se=me;return x(),O(se,{show:_.value,"onUpdate:show":u[7]||(u[7]=r=>_.value=r),"display-directive":"show",width:360},{default:t(()=>[a(te,{title:P.value,"native-scrollbar":!1,closable:""},{footer:t(()=>[a(ne,{size:16},{default:t(()=>[a(c,{onClick:R},{default:t(()=>[T($(e(l)("common.cancel")),1)]),_:1}),a(c,{type:"primary",onClick:D},{default:t(()=>[T($(e(l)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[a(F,{ref_key:"formRef",ref:N,model:o,rules:k},{default:t(()=>[a(s,{label:e(l)("page.manage.user.userName"),path:"userName"},{default:t(()=>[a(f,{value:o.userName,"onUpdate:value":u[0]||(u[0]=r=>o.userName=r),placeholder:e(l)("page.manage.user.form.userName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(s,{label:e(l)("page.manage.user.userGender"),path:"userGender"},{default:t(()=>[a(m,{value:o.userGender,"onUpdate:value":u[1]||(u[1]=r=>o.userGender=r)},{default:t(()=>[(x(!0),V(A,null,I(e(Q),r=>(x(),O(n,{key:r.value,value:r.value,label:e(l)(r.label)},null,8,["value","label"]))),128))]),_:1},8,["value"])]),_:1},8,["label"]),a(s,{label:e(l)("page.manage.user.nickName"),path:"nickName"},{default:t(()=>[a(f,{value:o.nickName,"onUpdate:value":u[2]||(u[2]=r=>o.nickName=r),placeholder:e(l)("page.manage.user.form.nickName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(s,{label:e(l)("page.manage.user.userPhone"),path:"userPhone"},{default:t(()=>[a(f,{value:o.userPhone,"onUpdate:value":u[3]||(u[3]=r=>o.userPhone=r),placeholder:e(l)("page.manage.user.form.userPhone")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(s,{label:e(l)("page.manage.user.userEmail"),path:"email"},{default:t(()=>[a(f,{value:o.userEmail,"onUpdate:value":u[4]||(u[4]=r=>o.userEmail=r),placeholder:e(l)("page.manage.user.form.userEmail")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(s,{label:e(l)("page.manage.user.userStatus"),path:"status"},{default:t(()=>[a(m,{value:o.status,"onUpdate:value":u[5]||(u[5]=r=>o.status=r)},{default:t(()=>[(x(!0),V(A,null,I(e(H),r=>(x(),O(n,{key:r.value,value:r.value,label:e(l)(r.label)},null,8,["value","label"]))),128))]),_:1},8,["value"])]),_:1},8,["label"]),a(s,{label:e(l)("page.manage.user.userRole"),path:"roles"},{default:t(()=>[a(M,{value:o.userRoles,"onUpdate:value":u[6]||(u[6]=r=>o.userRoles=r),multiple:"",options:d.value,placeholder:e(l)("page.manage.user.form.userRole")},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),De=j({name:"UserSearch",__name:"user-search",props:{model:{required:!0},modelModifiers:{}},emits:z(["reset","search"],["update:model"]),setup(v,{emit:S}){const h=S,{formRef:w,validate:_,restoreValidation:N}=Z(),i=K(v,"model"),G=L(()=>{const{patternRules:o}=ee();return{userEmail:o.email,userPhone:o.phone}});async function y(){await N(),h("reset")}async function P(){await _(),h("search")}return(o,p)=>{const k=Y,d=he,U=J,b=Se,R=B,D=Ge,g=le,u=xe,f=ae,s=X;return x(),O(s,{title:e(l)("common.search"),bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[a(f,{ref_key:"formRef",ref:w,model:i.value,rules:G.value,"label-placement":"left","label-width":80},{default:t(()=>[a(u,{responsive:"screen","item-responsive":""},{default:t(()=>[a(d,{span:"24 s:12 m:6",label:e(l)("page.manage.user.userName"),path:"userName",class:"pr-24px"},{default:t(()=>[a(k,{value:i.value.userName,"onUpdate:value":p[0]||(p[0]=n=>i.value.userName=n),placeholder:e(l)("page.manage.user.form.userName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(d,{span:"24 s:12 m:6",label:e(l)("page.manage.user.userGender"),path:"userGender",class:"pr-24px"},{default:t(()=>[a(U,{value:i.value.userGender,"onUpdate:value":p[1]||(p[1]=n=>i.value.userGender=n),placeholder:e(l)("page.manage.user.form.userGender"),options:e(W)(e(Q)),clearable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"]),a(d,{span:"24 s:12 m:6",label:e(l)("page.manage.user.nickName"),path:"nickName",class:"pr-24px"},{default:t(()=>[a(k,{value:i.value.nickName,"onUpdate:value":p[2]||(p[2]=n=>i.value.nickName=n),placeholder:e(l)("page.manage.user.form.nickName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(d,{span:"24 s:12 m:6",label:e(l)("page.manage.user.userPhone"),path:"userPhone",class:"pr-24px"},{default:t(()=>[a(k,{value:i.value.userPhone,"onUpdate:value":p[3]||(p[3]=n=>i.value.userPhone=n),placeholder:e(l)("page.manage.user.form.userPhone")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(d,{span:"24 s:12 m:6",label:e(l)("page.manage.user.userEmail"),path:"userEmail",class:"pr-24px"},{default:t(()=>[a(k,{value:i.value.userEmail,"onUpdate:value":p[4]||(p[4]=n=>i.value.userEmail=n),placeholder:e(l)("page.manage.user.form.userEmail")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(d,{span:"24 s:12 m:6",label:e(l)("page.manage.user.userStatus"),path:"userStatus",class:"pr-24px"},{default:t(()=>[a(U,{value:i.value.status,"onUpdate:value":p[5]||(p[5]=n=>i.value.status=n),placeholder:e(l)("page.manage.user.form.userStatus"),options:e(W)(e(H)),clearable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"]),a(d,{span:"24 m:12",class:"pr-24px"},{default:t(()=>[a(g,{class:"w-full",justify:"end"},{default:t(()=>[a(R,{onClick:y},{icon:t(()=>[a(b,{class:"text-icon"})]),default:t(()=>[T(" "+$(e(l)("common.reset")),1)]),_:1}),a(R,{type:"primary",ghost:"",onClick:P},{icon:t(()=>[a(D,{class:"text-icon"})]),default:t(()=>[T(" "+$(e(l)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])}}}),Ee={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function C(v){return typeof v=="function"||Object.prototype.toString.call(v)==="[object Object]"&&!ge(v)}const Ve=j({name:"manage_user",__name:"index",setup(v){const S=de(),{columns:h,columnChecks:w,data:_,getData:N,loading:i,mobilePagination:G,searchParams:y,resetSearchParams:P}=be({apiFn:ve,showTotal:!0,apiParams:{page:1,size:10,status:null,userName:null,userGender:null,nickName:null,userPhone:null,userEmail:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:l("common.index"),align:"center",width:64},{key:"userName",title:l("page.manage.user.userName"),align:"center",minWidth:100},{key:"userGender",title:l("page.manage.user.userGender"),align:"center",width:100,render:s=>{if(s.userGender===null)return null;const n={1:"primary",2:"error"},m=l(ce[s.userGender]);return a(q,{type:n[s.userGender]},C(m)?m:{default:()=>[m]})}},{key:"nickName",title:l("page.manage.user.nickName"),align:"center",minWidth:100},{key:"userPhone",title:l("page.manage.user.userPhone"),align:"center",width:120},{key:"userEmail",title:l("page.manage.user.userEmail"),align:"center",minWidth:200},{key:"status",title:l("page.manage.user.userStatus"),align:"center",width:100,render:s=>{if(s.status===null)return null;const n={1:"success",2:"warning"},m=l(_e[s.status]);return a(q,{type:n[s.status]},C(m)?m:{default:()=>[m]})}},{key:"operate",title:l("common.operate"),align:"center",width:130,render:s=>{let n;return a("div",{class:"flex-center gap-8px"},[a(B,{type:"primary",ghost:!0,size:"small",onClick:()=>f(s.id)},C(n=l("common.edit"))?n:{default:()=>[n]}),a(ye,{onPositiveClick:()=>u(s.id)},{default:()=>l("common.confirmDelete"),trigger:()=>{let m;return a(B,{type:"error",ghost:!0,size:"small"},C(m=l("common.delete"))?m:{default:()=>[m]})}})])}}]}),{drawerVisible:o,operateType:p,editingData:k,handleAdd:d,handleEdit:U,checkedRowKeys:b,onBatchDeleted:R,onDeleted:D}=Ne(_,N);async function g(){console.log(b.value),R()}function u(s){console.log(s),D()}function f(s){U(s)}return(s,n)=>{const m=oe,M=Ue,F=X;return x(),V("div",Ee,[a(De,{model:e(y),"onUpdate:model":n[0]||(n[0]=c=>E(y)?y.value=c:null),onReset:e(P),onSearch:e(N)},null,8,["model","onReset","onSearch"]),a(F,{title:e(l)("page.manage.user.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":t(()=>[a(m,{columns:e(w),"onUpdate:columns":n[1]||(n[1]=c=>E(w)?w.value=c:null),"disabled-delete":e(b).length===0,loading:e(i),onAdd:e(d),onDelete:g,onRefresh:e(N)},null,8,["columns","disabled-delete","loading","onAdd","onRefresh"])]),default:t(()=>[a(M,{"checked-row-keys":e(b),"onUpdate:checkedRowKeys":n[2]||(n[2]=c=>E(b)?b.value=c:null),columns:e(h),data:e(_),size:"small","flex-height":!e(S).isMobile,"scroll-x":962,loading:e(i),remote:"","row-key":c=>c.id,pagination:e(G),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),a(Pe,{visible:e(o),"onUpdate:visible":n[3]||(n[3]=c=>E(o)?o.value=c:null),"operate-type":e(p),"row-data":e(k),onSubmitted:e(N)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1},8,["title"])])}}});export{Ve as default};
