import{_ as L,a as Q,b as W,u as Z,c as J,d as X}from"./search-form.vue_vue_type_script_setup_true_lang-xYfW9G7N.js";import{aA as O,d as V,Q as A,l as j,R as E,m as Y,n as ee,a as ae,$ as t,r as te,S as ne,o as z,c as P,w as l,f as a,g as U,t as C,h as e,a8 as oe,aT as se,s as G,B as F,a3 as le,a4 as ie,v as re,y as ce,x as ue,C as de,z as me,A as pe,b as _e,ae as T,_ as B,U as fe,av as ge,O as he,ag as ve}from"./index-D3rICic-.js";import{_ as ye}from"./Grid-CRDcRyPk.js";function be(i){return O({url:"/namespace/list",method:"get",params:i})}function we(i){return O({url:"/namespace",method:"post",data:i})}function ke(i){return O({url:"/namespace",method:"put",data:i})}const xe=V({name:"NamespaceOperateDrawer",__name:"namespace-operate-drawer",props:A({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:A(["submitted"],["update:visible"]),setup(i,{emit:y}){const r=i,m=y,b=j(),p=E(i,"visible"),{formRef:h,validate:g,restoreValidation:f}=Y(),{defaultRequiredRule:v}=ee(),w=ae(()=>({add:t("page.namespace.addNamespace"),edit:t("page.namespace.editNamespace")})[r.operateType]),s=te(N());function N(){return{name:"",uniqueId:""}}const k={name:v,uniqueId:{required:!1,pattern:/^[A-Za-z0-9_-]{1,64}$/,trigger:"change",message:t("page.namespace.form.uniqueIdRule")}};function R(){s.uniqueId=se(32)}function $(){if(r.operateType==="add"){Object.assign(s,N());return}r.operateType==="edit"&&r.rowData&&Object.assign(s,r.rowData)}function S(){p.value=!1}async function q(){var _,d;if(await g(),r.operateType==="add"){const{name:n,uniqueId:o}=s,{error:c}=await we({name:n,uniqueId:o});if(c)return;(_=window.$message)==null||_.success(t("common.addSuccess"))}if(r.operateType==="edit"){const{id:n,name:o,uniqueId:c}=s,{error:x}=await ke({id:n,name:o,uniqueId:c});if(x)return;(d=window.$message)==null||d.success(t("common.updateSuccess"))}await b.getUserInfo(),S(),m("submitted")}return ne(p,()=>{p.value&&($(),f())}),(_,d)=>{const n=G,o=L,c=F,x=le,D=ie,u=re,K=ce,H=ue;return z(),P(oe,{modelValue:p.value,"onUpdate:modelValue":d[2]||(d[2]=I=>p.value=I),title:w.value,onSubmitted:q},{footer:l(()=>[a(H,{size:16},{default:l(()=>[a(c,{onClick:S},{default:l(()=>[U(C(e(t)("common.cancel")),1)]),_:1}),a(c,{type:"primary",onClick:q},{default:l(()=>[U(C(e(t)("common.save")),1)]),_:1})]),_:1})]),default:l(()=>[a(K,{ref_key:"formRef",ref:h,model:s,rules:k},{default:l(()=>[a(u,{label:e(t)("page.namespace.uniqueId"),path:"uniqueId"},{default:l(()=>[a(D,null,{default:l(()=>[a(n,{value:s.uniqueId,"onUpdate:value":d[0]||(d[0]=I=>s.uniqueId=I),disabled:r.operateType==="edit",placeholder:e(t)("page.namespace.form.uniqueId")},null,8,["value","disabled","placeholder"]),a(x,{trigger:"hover"},{trigger:l(()=>[a(c,{type:"default",ghost:"",disabled:r.operateType==="edit",onClick:R},{default:l(()=>[a(o,{class:"text-icon"})]),_:1},8,["disabled"])]),default:l(()=>[U(" "+C(e(t)("common.generateRandomly")),1)]),_:1})]),_:1})]),_:1},8,["label"]),a(u,{label:e(t)("page.namespace.name"),path:"name"},{default:l(()=>[a(n,{value:s.name,"onUpdate:value":d[1]||(d[1]=I=>s.name=I),placeholder:e(t)("page.namespace.form.name")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Ie=V({name:"NamespaceSearch",__name:"namespace-search",props:{model:{required:!0},modelModifiers:{}},emits:A(["reset","search"],["update:model"]),setup(i,{emit:y}){const r=y,m=E(i,"model");function b(){r("reset")}function p(){r("search")}return(h,g)=>{const f=G,v=Q,w=W;return z(),P(w,{model:m.value,onSearch:p,onReset:b},{default:l(()=>[a(v,{span:"24 s:12 m:6",label:e(t)("page.namespace.keyword"),path:"keyword",class:"pr-24px"},{default:l(()=>[a(f,{value:m.value.keyword,"onUpdate:value":g[0]||(g[0]=s=>m.value.keyword=s),placeholder:e(t)("page.namespace.form.keyword"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])}}}),Ne={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function M(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Object]"&&!ve(i)}const Re=V({name:"namespace",__name:"index",setup(i){const y=de(),r=j(),m=me(pe.get("namespaceId")),b=n=>{m.value=n,r.setNamespaceId(n)},{columns:p,columnChecks:h,data:g,getData:f,loading:v,mobilePagination:w,searchParams:s,resetSearchParams:N}=Z({apiFn:be,apiParams:{page:1,size:10,keyword:null},columns:()=>[{key:"name",title:t("page.namespace.name"),align:"left",width:120},{key:"status",title:t("common.active"),align:"center",width:40,render:n=>a("div",{class:"flex justify-center"},[m.value===n.uniqueId?a(B,{icon:"material-symbols:check-circle",class:"text-20px color-success"},null):a(B,{icon:"material-symbols:cancel",class:"text-20px color-gray400"},null)])},{key:"uniqueId",title:t("page.namespace.uniqueId"),align:"left",width:180},{key:"createDt",title:t("page.common.createTime"),align:"left",width:130},{key:"updateDt",title:t("page.common.upadteTime"),align:"left",width:130},{key:"operate",title:t("common.operate"),align:"center",width:64,render:n=>{let o,c;return a("div",{class:"flex-center gap-8px"},[a(F,{type:"primary",text:!0,ghost:!0,size:"small",onClick:()=>d(n.id)},M(o=t("common.edit"))?o:{default:()=>[o]}),m.value!==n.uniqueId?a(fe,null,[a(ge,{vertical:!0},null),a(F,{type:"warning",text:!0,ghost:!0,size:"small",onClick:()=>b(n.uniqueId)},M(c=t("common.switch"))?c:{default:()=>[c]})]):""])}}]}),{drawerVisible:k,operateType:R,editingData:$,handleAdd:S,handleEdit:q,checkedRowKeys:_}=J(g,f);function d(n){q(n)}return(n,o)=>{const c=X,x=ye,D=he;return z(),_e("div",Ne,[a(Ie,{model:e(s),"onUpdate:model":o[0]||(o[0]=u=>T(s)?s.value=u:null),onReset:e(N),onSearch:e(f)},null,8,["model","onReset","onSearch"]),a(D,{title:e(t)("page.namespace.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper","header-class":"view-card-header"},{"header-extra":l(()=>[a(c,{columns:e(h),"onUpdate:columns":o[1]||(o[1]=u=>T(h)?h.value=u:null),"disabled-delete":e(_).length===0,loading:e(v),"show-delete":!1,onAdd:e(S),onRefresh:e(f)},null,8,["columns","disabled-delete","loading","onAdd","onRefresh"])]),default:l(()=>[a(x,{"checked-row-keys":e(_),"onUpdate:checkedRowKeys":o[2]||(o[2]=u=>T(_)?_.value=u:null),columns:e(p),data:e(g),"flex-height":!e(y).isMobile,"scroll-x":962,loading:e(v),remote:"","row-key":u=>u.id,pagination:e(w),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),a(xe,{visible:e(k),"onUpdate:visible":o[3]||(o[3]=u=>T(k)?k.value=u:null),"operate-type":e(R),"row-data":e($),onSubmitted:e(f)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1},8,["title"])])}}});export{Re as default};
