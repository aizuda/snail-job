import{b5 as ie,bq as ae,d as F,b6 as st,cz as it,r as k,a as ne,i as Te,by as Ct,am as K,cA as Tt,q as X,aq as ce,ba as Ye,bp as Z,cB as Dt,cC as Ut,bv as Lt,cD as Rt,cE as Mt,b0 as It,b_ as et,b9 as dt,cF as jt,cG as Et,bw as zt,bc as At,cH as Ht,O as Ot,bI as Yt,cr as qt,cI as Xt,aS as le,o as m,b as T,e as _,cs as _e,v as ue,a4 as Q,a2 as se,x as ge,s as oe,l as pe,cJ as Wt,cK as Pt,c as L,w as a,g as B,t as V,f as l,D as De,B as de,cL as Ue,h,cM as Ft,cN as Pe,ab as xe,E as Le,H as Re,I as Me,cO as Ie,cP as je,$ as U,cQ as rt,cR as ut,Z as Gt,a0 as qe,cS as ct,cT as Jt,aj as C,aw as Kt,aL as Ne,Y as Be,cU as J,cV as tt,cW as ot,cX as nt,av as pt,ax as Zt,G as Fe,cY as Qt,ak as mt,_ as Ee,a9 as $e,C as ke,aJ as ft,cZ as eo,c_ as vt,c$ as to,d0 as Xe,d1 as oo,aO as no,aP as ht,d2 as lo,d3 as ao,aG as so,d4 as io}from"./index-Cxl_PNjp.js";import{H as ro,j as uo,e as co,_ as po,g as bt}from"./job-task-list-table.vue_vue_type_script_setup_true_lang-C2vGcHQM.js";import{j as mo,k as fo,l as vo,m as ho}from"./workflow-NxUovv59.js";import{h as bo,i as go}from"./job-DWJ--MEY.js";import{_ as ze,a as Ae,h as _o,d as gt,c as _t}from"./Grid-BLjrxj5f.js";import{_ as Se}from"./detail-drawer-Bugcn6xC.js";import{_ as we,a as ye}from"./DescriptionsItem-rrUPAzSY.js";import{_ as wo}from"./log-drawer-DDgcrX8a.js";import{_ as yo}from"./table-BRmcb0CX.js";import{a as ko,_ as No,s as xo,j as $o,o as So}from"./code-mirror.vue_vue_type_script_setup_true_lang-Bjh4pRfc.js";import{_ as Vo}from"./cron-input.vue_vue_type_style_index_0_lang-Dd2OzQjD.js";import{g as Bo}from"./group-CNWTYoXm.js";function Co(e){return typeof e=="string"?document.querySelector(e):typeof e=="function"?e():e}function To(e){return e instanceof HTMLElement?e.scrollTop:window.scrollY}function Do(e){return e instanceof HTMLElement?e.getBoundingClientRect():{top:0,bottom:window.innerHeight}}const Uo=ie("affix",[ae("affixed",{position:"fixed"},[ae("absolute-positioned",{position:"absolute"})])]),Lo={listenTo:[String,Object,Function],top:Number,bottom:Number,triggerTop:Number,triggerBottom:Number,position:{type:String,default:"fixed"},offsetTop:{type:Number,validator:()=>!0,default:void 0},offsetBottom:{type:Number,validator:()=>!0,default:void 0},target:{type:Function,validator:()=>!0,default:void 0}},Ro=F({name:"Affix",props:Lo,setup(e){const{mergedClsPrefixRef:n}=st(e);it("-affix",Uo,n);let i=null;const v=k(!1),s=k(!1),t=k(null),o=k(null),p=ne(()=>s.value||v.value),r=ne(()=>{var g,y;return(y=(g=e.triggerTop)!==null&&g!==void 0?g:e.offsetTop)!==null&&y!==void 0?y:e.top}),c=ne(()=>{var g,y;return(y=(g=e.top)!==null&&g!==void 0?g:e.triggerTop)!==null&&y!==void 0?y:e.offsetTop}),d=ne(()=>{var g,y;return(y=(g=e.bottom)!==null&&g!==void 0?g:e.triggerBottom)!==null&&y!==void 0?y:e.offsetBottom}),u=ne(()=>{var g,y;return(y=(g=e.triggerBottom)!==null&&g!==void 0?g:e.offsetBottom)!==null&&y!==void 0?y:e.bottom}),x=k(null),w=()=>{const{target:g,listenTo:y}=e;g?i=g():y?i=Co(y):i=document,i&&(i.addEventListener("scroll",f),f())};function f(){Tt(S)}function S(){const{value:g}=x;if(!i||!g)return;const y=To(i);if(p.value){o.value!==null&&y<o.value&&(v.value=!1,o.value=null),t.value!==null&&y>t.value&&(s.value=!1,t.value=null);return}const E=Do(i),M=g.getBoundingClientRect(),I=M.top-E.top,Y=E.bottom-M.bottom,b=r.value,$=u.value;b!==void 0&&I<=b?(v.value=!0,o.value=y-(b-I)):(v.value=!1,o.value=null),$!==void 0&&Y<=$?(s.value=!0,t.value=y+$-Y):(s.value=!1,t.value=null)}return Te(()=>{w()}),Ct(()=>{i&&i.removeEventListener("scroll",f)}),{selfRef:x,affixed:p,mergedClsPrefix:n,mergedstyle:ne(()=>{const g={};return v.value&&r.value!==void 0&&c.value!==void 0&&(g.top=`${c.value}px`),s.value&&u.value!==void 0&&d.value!==void 0&&(g.bottom=`${d.value}px`),g})}},render(){const{mergedClsPrefix:e}=this;return K("div",{ref:"selfRef",class:[`${e}-affix`,{[`${e}-affix--affixed`]:this.affixed,[`${e}-affix--absolute-positioned`]:this.position==="absolute"}],style:this.mergedstyle},this.$slots)}}),lt=F({name:"SlotMachineNumber",props:{clsPrefix:{type:String,required:!0},value:{type:[Number,String],required:!0},oldOriginalNumber:{type:Number,default:void 0},newOriginalNumber:{type:Number,default:void 0}},setup(e){const n=k(null),i=k(e.value),v=k(e.value),s=k("up"),t=k(!1),o=ne(()=>t.value?`${e.clsPrefix}-base-slot-machine-current-number--${s.value}-scroll`:null),p=ne(()=>t.value?`${e.clsPrefix}-base-slot-machine-old-number--${s.value}-scroll`:null);X(Ye(e,"value"),(d,u)=>{i.value=u,v.value=d,ce(r)});function r(){const d=e.newOriginalNumber,u=e.oldOriginalNumber;u===void 0||d===void 0||(d>u?c("up"):u>d&&c("down"))}function c(d){s.value=d,t.value=!1,ce(()=>{var u;(u=n.value)===null||u===void 0||u.offsetWidth,t.value=!0})}return()=>{const{clsPrefix:d}=e;return K("span",{ref:n,class:`${d}-base-slot-machine-number`},i.value!==null?K("span",{class:[`${d}-base-slot-machine-old-number ${d}-base-slot-machine-old-number--top`,p.value]},i.value):null,K("span",{class:[`${d}-base-slot-machine-current-number`,o.value]},K("span",{ref:"numberWrapper",class:[`${d}-base-slot-machine-current-number__inner`,typeof e.value!="number"&&`${d}-base-slot-machine-current-number__inner--not-number`]},v.value)),i.value!==null?K("span",{class:[`${d}-base-slot-machine-old-number ${d}-base-slot-machine-old-number--bottom`,p.value]},i.value):null)}}}),{cubicBezierEaseOut:be}=Dt;function Mo({duration:e=".2s"}={}){return[Z("&.fade-up-width-expand-transition-leave-active",{transition:`
 opacity ${e} ${be},
 max-width ${e} ${be},
 transform ${e} ${be}
 `}),Z("&.fade-up-width-expand-transition-enter-active",{transition:`
 opacity ${e} ${be},
 max-width ${e} ${be},
 transform ${e} ${be}
 `}),Z("&.fade-up-width-expand-transition-enter-to",{opacity:1,transform:"translateX(0) translateY(0)"}),Z("&.fade-up-width-expand-transition-enter-from",{maxWidth:"0 !important",opacity:0,transform:"translateY(60%)"}),Z("&.fade-up-width-expand-transition-leave-from",{opacity:1,transform:"translateY(0)"}),Z("&.fade-up-width-expand-transition-leave-to",{maxWidth:"0 !important",opacity:0,transform:"translateY(60%)"})]}const Io=Z([Z("@keyframes n-base-slot-machine-fade-up-in",`
 from {
 transform: translateY(60%);
 opacity: 0;
 }
 to {
 transform: translateY(0);
 opacity: 1;
 }
 `),Z("@keyframes n-base-slot-machine-fade-down-in",`
 from {
 transform: translateY(-60%);
 opacity: 0;
 }
 to {
 transform: translateY(0);
 opacity: 1;
 }
 `),Z("@keyframes n-base-slot-machine-fade-up-out",`
 from {
 transform: translateY(0%);
 opacity: 1;
 }
 to {
 transform: translateY(-60%);
 opacity: 0;
 }
 `),Z("@keyframes n-base-slot-machine-fade-down-out",`
 from {
 transform: translateY(0%);
 opacity: 1;
 }
 to {
 transform: translateY(60%);
 opacity: 0;
 }
 `),ie("base-slot-machine",`
 overflow: hidden;
 white-space: nowrap;
 display: inline-block;
 height: 18px;
 line-height: 18px;
 `,[ie("base-slot-machine-number",`
 display: inline-block;
 position: relative;
 height: 18px;
 width: .6em;
 max-width: .6em;
 `,[Mo({duration:".2s"}),Ut({duration:".2s",delay:"0s"}),ie("base-slot-machine-old-number",`
 display: inline-block;
 opacity: 0;
 position: absolute;
 left: 0;
 right: 0;
 `,[ae("top",{transform:"translateY(-100%)"}),ae("bottom",{transform:"translateY(100%)"}),ae("down-scroll",{animation:"n-base-slot-machine-fade-down-out .2s cubic-bezier(0, 0, .2, 1)",animationIterationCount:1}),ae("up-scroll",{animation:"n-base-slot-machine-fade-up-out .2s cubic-bezier(0, 0, .2, 1)",animationIterationCount:1})]),ie("base-slot-machine-current-number",`
 display: inline-block;
 position: absolute;
 left: 0;
 top: 0;
 bottom: 0;
 right: 0;
 opacity: 1;
 transform: translateY(0);
 width: .6em;
 `,[ae("down-scroll",{animation:"n-base-slot-machine-fade-down-in .2s cubic-bezier(0, 0, .2, 1)",animationIterationCount:1}),ae("up-scroll",{animation:"n-base-slot-machine-fade-up-in .2s cubic-bezier(0, 0, .2, 1)",animationIterationCount:1}),Lt("inner",`
 display: inline-block;
 position: absolute;
 right: 0;
 top: 0;
 width: .6em;
 `,[ae("not-number",`
 right: unset;
 left: 0;
 `)])])])])]),jo=F({name:"BaseSlotMachine",props:{clsPrefix:{type:String,required:!0},value:{type:[Number,String],default:0},max:{type:Number,default:void 0},appeared:{type:Boolean,required:!0}},setup(e){it("-base-slot-machine",Io,Ye(e,"clsPrefix"));const n=k(),i=k(),v=ne(()=>{if(typeof e.value=="string")return[];if(e.value<1)return[0];const s=[];let t=e.value;for(e.max!==void 0&&(t=Math.min(e.max,t));t>=1;)s.push(t%10),t/=10,t=Math.floor(t);return s.reverse(),s});return X(Ye(e,"value"),(s,t)=>{typeof s=="string"?(i.value=void 0,n.value=void 0):typeof t=="string"?(i.value=s,n.value=void 0):(i.value=s,n.value=t)}),()=>{const{value:s,clsPrefix:t}=e;return typeof s=="number"?K("span",{class:`${t}-base-slot-machine`},K(Mt,{name:"fade-up-width-expand-transition",tag:"span"},{default:()=>v.value.map((o,p)=>K(lt,{clsPrefix:t,key:v.value.length-p-1,oldOriginalNumber:n.value,newOriginalNumber:i.value,value:o}))}),K(Rt,{key:"+",width:!0},{default:()=>e.max!==void 0&&e.max<s?K(lt,{clsPrefix:t,value:"+"}):null})):K("span",{class:`${t}-base-slot-machine`},s)}}});function Eo(e){const{errorColor:n,infoColor:i,successColor:v,warningColor:s,fontFamily:t}=e;return{color:n,colorInfo:i,colorSuccess:v,colorError:n,colorWarning:s,fontSize:"12px",fontFamily:t}}const zo={name:"Badge",common:It,self:Eo},Ao=Z([Z("@keyframes badge-wave-spread",{from:{boxShadow:"0 0 0.5px 0px var(--n-ripple-color)",opacity:.6},to:{boxShadow:"0 0 0.5px 4.5px var(--n-ripple-color)",opacity:0}}),ie("badge",`
 display: inline-flex;
 position: relative;
 vertical-align: middle;
 font-family: var(--n-font-family);
 `,[ae("as-is",[ie("badge-sup",{position:"static",transform:"translateX(0)"},[et({transformOrigin:"left bottom",originalTransform:"translateX(0)"})])]),ae("dot",[ie("badge-sup",`
 height: 8px;
 width: 8px;
 padding: 0;
 min-width: 8px;
 left: 100%;
 bottom: calc(100% - 4px);
 `,[Z("::before","border-radius: 4px;")])]),ie("badge-sup",`
 background: var(--n-color);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 color: #FFF;
 position: absolute;
 height: 18px;
 line-height: 18px;
 border-radius: 9px;
 padding: 0 6px;
 text-align: center;
 font-size: var(--n-font-size);
 transform: translateX(-50%);
 left: 100%;
 bottom: calc(100% - 9px);
 font-variant-numeric: tabular-nums;
 z-index: 1;
 display: flex;
 align-items: center;
 `,[et({transformOrigin:"left bottom",originalTransform:"translateX(-50%)"}),ie("base-wave",{zIndex:1,animationDuration:"2s",animationIterationCount:"infinite",animationDelay:"1s",animationTimingFunction:"var(--n-ripple-bezier)",animationName:"badge-wave-spread"}),Z("&::before",`
 opacity: 0;
 transform: scale(1);
 border-radius: 9px;
 content: "";
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `)])])]),Ho=Object.assign(Object.assign({},dt.props),{value:[String,Number],max:Number,dot:Boolean,type:{type:String,default:"default"},show:{type:Boolean,default:!0},showZero:Boolean,processing:Boolean,color:String,offset:Array}),He=F({name:"Badge",props:Ho,setup(e,{slots:n}){const{mergedClsPrefixRef:i,inlineThemeDisabled:v,mergedRtlRef:s}=st(e),t=dt("Badge","-badge",Ao,zo,e,i),o=k(!1),p=()=>{o.value=!0},r=()=>{o.value=!1},c=ne(()=>e.show&&(e.dot||e.value!==void 0&&!(!e.showZero&&Number(e.value)<=0)||!jt(n.value)));Te(()=>{c.value&&(o.value=!0)});const d=Et("Badge",s,i),u=ne(()=>{const{type:f,color:S}=e,{common:{cubicBezierEaseInOut:g,cubicBezierEaseOut:y},self:{[zt("color",f)]:E,fontFamily:M,fontSize:I}}=t.value;return{"--n-font-size":I,"--n-font-family":M,"--n-color":S||E,"--n-ripple-color":S||E,"--n-bezier":g,"--n-ripple-bezier":y}}),x=v?At("badge",ne(()=>{let f="";const{type:S,color:g}=e;return S&&(f+=S[0]),g&&(f+=Ht(g)),f}),u,e):void 0,w=ne(()=>{const{offset:f}=e;if(!f)return;const[S,g]=f,y=typeof S=="number"?`${S}px`:S,E=typeof g=="number"?`${g}px`:g;return{transform:`translate(calc(${d!=null&&d.value?"50%":"-50%"} + ${y}), ${E})`}});return{rtlEnabled:d,mergedClsPrefix:i,appeared:o,showBadge:c,handleAfterEnter:p,handleAfterLeave:r,cssVars:v?void 0:u,themeClass:x==null?void 0:x.themeClass,onRender:x==null?void 0:x.onRender,offsetStyle:w}},render(){var e;const{mergedClsPrefix:n,onRender:i,themeClass:v,$slots:s}=this;i==null||i();const t=(e=s.default)===null||e===void 0?void 0:e.call(s);return K("div",{class:[`${n}-badge`,this.rtlEnabled&&`${n}-badge--rtl`,v,{[`${n}-badge--dot`]:this.dot,[`${n}-badge--as-is`]:!t}],style:this.cssVars},t,K(Ot,{name:"fade-in-scale-up-transition",onAfterEnter:this.handleAfterEnter,onAfterLeave:this.handleAfterLeave},{default:()=>this.showBadge?K("sup",{class:`${n}-badge-sup`,title:Yt(this.value),style:this.offsetStyle},qt(s.value,()=>[this.dot?null:K(jo,{clsPrefix:n,appeared:this.appeared,max:this.max,value:this.value})]),this.processing?K(Xt,{clsPrefix:n}):null):null}))}}),Oo={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function Yo(e,n){return m(),T("svg",Oo,n[0]||(n[0]=[_("path",{fill:"currentColor",d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8"},null,-1),_("path",{fill:"currentColor",d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8Z"},null,-1)]))}const wt=le({name:"ant-design-plus-outlined",render:Yo}),qo={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function Xo(e,n){return m(),T("svg",qo,n[0]||(n[0]=[_("path",{fill:"currentColor",d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8"},null,-1)]))}const Wo=le({name:"ant-design-minus-outlined",render:Xo}),at={y:{t:"top",m:"marginTop",b:"bottom"},x:{l:"left",m:"marginLeft",r:"right"}};function Po(e){e.forEach((n,i)=>{document.documentElement.addEventListener(i,n)})}function Fo(e){e.forEach((n,i)=>{document.documentElement.removeEventListener(i,n)})}const Go={name:"vue-drag-resize",emits:["clicked","dragging","dragstop","resizing","resizestop","activated","deactivated"],props:{stickSize:{type:Number,default:8},parentScaleX:{type:Number,default:1},parentScaleY:{type:Number,default:1},isActive:{type:Boolean,default:!1},preventActiveBehavior:{type:Boolean,default:!1},isDraggable:{type:Boolean,default:!0},isResizable:{type:Boolean,default:!0},aspectRatio:{type:Boolean,default:!1},parentLimitation:{type:Boolean,default:!1},snapToGrid:{type:Boolean,default:!1},gridX:{type:Number,default:50,validator(e){return e>=0}},gridY:{type:Number,default:50,validator(e){return e>=0}},parentW:{type:Number,default:0,validator(e){return e>=0}},parentH:{type:Number,default:0,validator(e){return e>=0}},w:{type:[String,Number],default:200,validator(e){return typeof e=="string"?e==="auto":e>=0}},h:{type:[String,Number],default:200,validator(e){return typeof e=="string"?e==="auto":e>=0}},minw:{type:Number,default:50,validator(e){return e>=0}},minh:{type:Number,default:50,validator(e){return e>=0}},x:{type:Number,default:0,validator(e){return typeof e=="number"}},y:{type:Number,default:0,validator(e){return typeof e=="number"}},z:{type:[String,Number],default:"auto",validator(e){return typeof e=="string"?e==="auto":e>=0}},dragHandle:{type:String,default:null},dragCancel:{type:String,default:null},sticks:{type:Array,default(){return["tl","tm","tr","mr","br","bm","bl","ml"]}},axis:{type:String,default:"both",validator(e){return["x","y","both","none"].indexOf(e)!==-1}},contentClass:{type:String,required:!1,default:""}},data(){return{fixAspectRatio:null,active:null,zIndex:null,parentWidth:null,parentHeight:null,left:null,top:null,right:null,bottom:null,minHeight:null}},beforeCreate(){this.stickDrag=!1,this.bodyDrag=!1,this.dimensionsBeforeMove={pointerX:0,pointerY:0,x:0,y:0,w:0,h:0},this.limits={left:{min:null,max:null},right:{min:null,max:null},top:{min:null,max:null},bottom:{min:null,max:null}},this.currentStick=null},mounted(){this.parentElement=this.$el.parentNode,this.parentWidth=this.parentW?this.parentW:this.parentElement.clientWidth,this.parentHeight=this.parentH?this.parentH:this.parentElement.clientHeight,this.left=this.x,this.top=this.y,this.right=this.parentWidth-(this.w==="auto"?this.$refs.container.scrollWidth:this.w)-this.left,this.bottom=this.parentHeight-(this.h==="auto"?this.$refs.container.scrollHeight:this.h)-this.top,this.domEvents=new Map([["mousemove",this.move],["mouseup",this.up],["mouseleave",this.up],["mousedown",this.deselect],["touchmove",this.move],["touchend",this.up],["touchcancel",this.up],["touchstart",this.up]]),Po(this.domEvents),this.dragHandle&&[...this.$el.querySelectorAll(this.dragHandle)].forEach(e=>{e.setAttribute("data-drag-handle",this._uid)}),this.dragCancel&&[...this.$el.querySelectorAll(this.dragCancel)].forEach(e=>{e.setAttribute("data-drag-cancel",this._uid)})},beforeDestroy(){Fo(this.domEvents)},methods:{deselect(){this.preventActiveBehavior||(this.active=!1)},move(e){if(!this.stickDrag&&!this.bodyDrag)return;e.stopPropagation();const n=typeof e.pageX<"u"?e.pageX:e.touches[0].pageX,i=typeof e.pageY<"u"?e.pageY:e.touches[0].pageY,{dimensionsBeforeMove:v}=this,s={x:(v.pointerX-n)/this.parentScaleX,y:(v.pointerY-i)/this.parentScaleY};if(this.stickDrag&&this.stickMove(s),this.bodyDrag){if(this.axis==="x")s.y=0;else if(this.axis==="y")s.x=0;else if(this.axis==="none")return;this.bodyMove(s)}},up(e){this.stickDrag?this.stickUp(e):this.bodyDrag&&this.bodyUp(e)},bodyDown(e){const{target:n,button:i}=e;if(this.preventActiveBehavior||(this.active=!0),i&&i!==0||(this.$emit("clicked",e),!this.active)||this.dragHandle&&n.getAttribute("data-drag-handle")!==this._uid.toString()||this.dragCancel&&n.getAttribute("data-drag-cancel")===this._uid.toString())return;typeof e.stopPropagation<"u"&&e.stopPropagation(),typeof e.preventDefault<"u"&&e.preventDefault(),this.isDraggable&&(this.bodyDrag=!0);const v=typeof e.pageX<"u"?e.pageX:e.touches[0].pageX,s=typeof e.pageY<"u"?e.pageY:e.touches[0].pageY;this.saveDimensionsBeforeMove({pointerX:v,pointerY:s}),this.parentLimitation&&(this.limits=this.calcDragLimitation())},bodyMove(e){const{dimensionsBeforeMove:n,parentWidth:i,parentHeight:v,gridX:s,gridY:t,width:o,height:p}=this;let r=n.top-e.y,c=n.bottom+e.y,d=n.left-e.x,u=n.right+e.x;if(this.snapToGrid){let x=!0,w=!0,f=r-Math.floor(r/t)*t,S=v-c-Math.floor((v-c)/t)*t,g=d-Math.floor(d/s)*s,y=i-u-Math.floor((i-u)/s)*s;f>t/2&&(f-=t),S>t/2&&(S-=t),g>s/2&&(g-=s),y>s/2&&(y-=s),Math.abs(S)<Math.abs(f)&&(x=!1),Math.abs(y)<Math.abs(g)&&(w=!1),r-=x?f:S,c=v-p-r,d-=w?g:y,u=i-o-d}({newLeft:this.left,newRight:this.right,newTop:this.top,newBottom:this.bottom}=this.rectCorrectionByLimit({newLeft:d,newRight:u,newTop:r,newBottom:c})),this.$emit("dragging",this.rect)},bodyUp(){this.bodyDrag=!1,this.$emit("dragging",this.rect),this.$emit("dragstop",this.rect),this.dimensionsBeforeMove={pointerX:0,pointerY:0,x:0,y:0,w:0,h:0},this.limits={left:{min:null,max:null},right:{min:null,max:null},top:{min:null,max:null},bottom:{min:null,max:null}}},stickDown(e,n,i=!1){if((!this.isResizable||!this.active)&&!i)return;this.stickDrag=!0;const v=typeof n.pageX<"u"?n.pageX:n.touches[0].pageX,s=typeof n.pageY<"u"?n.pageY:n.touches[0].pageY;this.saveDimensionsBeforeMove({pointerX:v,pointerY:s}),this.currentStick=e,this.limits=this.calcResizeLimits()},saveDimensionsBeforeMove({pointerX:e,pointerY:n}){this.dimensionsBeforeMove.pointerX=e,this.dimensionsBeforeMove.pointerY=n,this.dimensionsBeforeMove.left=this.left,this.dimensionsBeforeMove.right=this.right,this.dimensionsBeforeMove.top=this.top,this.dimensionsBeforeMove.bottom=this.bottom,this.dimensionsBeforeMove.width=this.width,this.dimensionsBeforeMove.height=this.height,this.aspectFactor=this.width/this.height},stickMove(e){const{currentStick:n,dimensionsBeforeMove:i,gridY:v,gridX:s,snapToGrid:t,parentHeight:o,parentWidth:p}=this;let r=i.top,c=i.bottom,d=i.left,u=i.right;switch(n[0]){case"b":c=i.bottom+e.y,t&&(c=o-Math.round((o-c)/v)*v);break;case"t":r=i.top-e.y,t&&(r=Math.round(r/v)*v);break}switch(n[1]){case"r":u=i.right+e.x,t&&(u=p-Math.round((p-u)/s)*s);break;case"l":d=i.left-e.x,t&&(d=Math.round(d/s)*s);break}({newLeft:d,newRight:u,newTop:r,newBottom:c}=this.rectCorrectionByLimit({newLeft:d,newRight:u,newTop:r,newBottom:c})),this.aspectRatio&&({newLeft:d,newRight:u,newTop:r,newBottom:c}=this.rectCorrectionByAspectRatio({newLeft:d,newRight:u,newTop:r,newBottom:c})),this.left=d,this.right=u,this.top=r,this.bottom=c,this.$emit("resizing",this.rect)},stickUp(){this.stickDrag=!1,this.dimensionsBeforeMove={pointerX:0,pointerY:0,x:0,y:0,w:0,h:0},this.limits={left:{min:null,max:null},right:{min:null,max:null},top:{min:null,max:null},bottom:{min:null,max:null}},this.$emit("resizing",this.rect),this.$emit("resizestop",this.rect)},calcDragLimitation(){const{parentWidth:e,parentHeight:n}=this;return{left:{min:0,max:e-this.width},right:{min:0,max:e-this.width},top:{min:0,max:n-this.height},bottom:{min:0,max:n-this.height}}},calcResizeLimits(){const{aspectFactor:e,width:n,height:i,bottom:v,top:s,left:t,right:o}=this;let{minh:p,minw:r}=this;const c=this.parentLimitation?0:null;this.aspectRatio&&(r/p>e?p=r/e:r=e*p);const d={left:{min:c,max:t+(n-r)},right:{min:c,max:o+(n-r)},top:{min:c,max:s+(i-p)},bottom:{min:c,max:v+(i-p)}};if(this.aspectRatio){const u={left:{min:t-Math.min(s,v)*e*2,max:t+(i-p)/2*e*2},right:{min:o-Math.min(s,v)*e*2,max:o+(i-p)/2*e*2},top:{min:s-Math.min(t,o)/e*2,max:s+(n-r)/2/e*2},bottom:{min:v-Math.min(t,o)/e*2,max:v+(n-r)/2/e*2}};this.currentStick[0]==="m"?(d.left={min:Math.max(d.left.min,u.left.min),max:Math.min(d.left.max,u.left.max)},d.right={min:Math.max(d.right.min,u.right.min),max:Math.min(d.right.max,u.right.max)}):this.currentStick[1]==="m"&&(d.top={min:Math.max(d.top.min,u.top.min),max:Math.min(d.top.max,u.top.max)},d.bottom={min:Math.max(d.bottom.min,u.bottom.min),max:Math.min(d.bottom.max,u.bottom.max)})}return d},sideCorrectionByLimit(e,n){let i=n;return e.min!==null&&n<e.min?i=e.min:e.max!==null&&e.max<n&&(i=e.max),i},rectCorrectionByLimit(e){const{limits:n}=this;let{newRight:i,newLeft:v,newBottom:s,newTop:t}=e;return v=this.sideCorrectionByLimit(n.left,v),i=this.sideCorrectionByLimit(n.right,i),t=this.sideCorrectionByLimit(n.top,t),s=this.sideCorrectionByLimit(n.bottom,s),{newLeft:v,newRight:i,newTop:t,newBottom:s}},rectCorrectionByAspectRatio(e){let{newLeft:n,newRight:i,newTop:v,newBottom:s}=e;const{parentWidth:t,parentHeight:o,currentStick:p,aspectFactor:r,dimensionsBeforeMove:c}=this;let d=t-n-i,u=o-v-s;if(p[1]==="m"){const x=u-c.height;n-=x*r/2,i-=x*r/2}else if(p[0]==="m"){const x=d-c.width;v-=x/r/2,s-=x/r/2}else d/u>r?(d=r*u,p[1]==="l"?n=t-i-d:i=t-n-d):(u=d/r,p[0]==="t"?v=o-s-u:s=o-v-u);return{newLeft:n,newRight:i,newTop:v,newBottom:s}}},computed:{positionStyle(){return{top:this.top+"px",left:this.left+"px",zIndex:this.zIndex}},sizeStyle(){return{width:this.w=="auto"?"auto":this.width+"px",height:this.h=="auto"?"auto":this.height+"px"}},vdrStick(){return e=>{const n={width:`${this.stickSize/this.parentScaleX}px`,height:`${this.stickSize/this.parentScaleY}px`};return n[at.y[e[0]]]=`${this.stickSize/this.parentScaleX/-2}px`,n[at.x[e[1]]]=`${this.stickSize/this.parentScaleX/-2}px`,n}},width(){return this.parentWidth-this.left-this.right},height(){return this.parentHeight-this.top-this.bottom},rect(){return{left:Math.round(this.left),top:Math.round(this.top),width:Math.round(this.width),height:Math.round(this.height)}}},watch:{active(e){e?this.$emit("activated"):this.$emit("deactivated")},isActive:{immediate:!0,handler(e){this.active=e}},z:{immediate:!0,handler(e){(e>=0||e==="auto")&&(this.zIndex=e)}},x:{handler(e,n){if(this.stickDrag||this.bodyDrag||e===this.left)return;const i=n-e;this.bodyDown({pageX:this.left,pageY:this.top}),this.bodyMove({x:i,y:0}),this.$nextTick(()=>{this.bodyUp()})}},y:{handler(e,n){if(this.stickDrag||this.bodyDrag||e===this.top)return;const i=n-e;this.bodyDown({pageX:this.left,pageY:this.top}),this.bodyMove({x:0,y:i}),this.$nextTick(()=>{this.bodyUp()})}},w:{handler(e,n){if(this.stickDrag||this.bodyDrag||e===this.width)return;const i="mr",v=n-e;this.stickDown(i,{pageX:this.right,pageY:this.top+this.height/2},!0),this.stickMove({x:v,y:0}),this.$nextTick(()=>{this.stickUp()})}},h:{handler(e,n){if(this.stickDrag||this.bodyDrag||e===this.height)return;const i="bm",v=n-e;this.stickDown(i,{pageX:this.left+this.width/2,pageY:this.bottom},!0),this.stickMove({x:0,y:v}),this.$nextTick(()=>{this.stickUp()})}},parentW(e){this.right=e-this.width-this.left,this.parentWidth=e},parentH(e){this.bottom=e-this.height-this.top,this.parentHeight=e}}},Jo=["onMousedown","onTouchstart"];function Ko(e,n,i,v,s,t){return m(),T("div",{class:ge(["vdr",`${e.active||e.isActive?"active":"inactive"} ${e.contentClass?e.contentClass:""}`]),style:ue(e.positionStyle),onMousedown:n[0]||(n[0]=o=>e.bodyDown(o)),onTouchstart:n[1]||(n[1]=o=>e.bodyDown(o)),onTouchend:n[2]||(n[2]=o=>e.up(o))},[_("div",{style:ue(e.sizeStyle),class:"content-container",ref:"container"},[_e(e.$slots,"default")],4),(m(!0),T(Q,null,se(e.sticks,o=>(m(),T("div",{class:ge(["vdr-stick",["vdr-stick-"+o,e.isResizable?"":"not-resizable"]]),onMousedown:oe(p=>e.stickDown(o,p),["stop","prevent"]),onTouchstart:oe(p=>e.stickDown(o,p),["stop","prevent"]),style:ue(e.vdrStick(o))},null,46,Jo))),256))],38)}const yt=pe(Go,[["render",Ko]]);function We(e){We.installed||(We.installed=!0,e.component("vue-drag-resize",yt))}const Zo={install:We};let Ce=null;typeof window<"u"?Ce=window.Vue:typeof global<"u"&&(Ce=global.Vue);Ce&&Ce.use(Zo);const Qo={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function en(e,n){return m(),T("svg",Qo,n[0]||(n[0]=[_("path",{fill:"currentColor",d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1l-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4"},null,-1)]))}const kt=le({name:"ant-design-right-outlined",render:en}),tn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function on(e,n){return m(),T("svg",tn,n[0]||(n[0]=[_("path",{fill:"currentColor","fill-rule":"evenodd",d:"M799.855 166.312c.023.007.043.018.084.059l57.69 57.69c.041.041.052.06.059.084a.1.1 0 0 1 0 .069c-.007.023-.018.042-.059.083L569.926 512l287.703 287.703c.041.04.052.06.059.083a.12.12 0 0 1 0 .07c-.007.022-.018.042-.059.083l-57.69 57.69c-.041.041-.06.052-.084.059a.1.1 0 0 1-.069 0c-.023-.007-.042-.018-.083-.059L512 569.926L224.297 857.629c-.04.041-.06.052-.083.059a.12.12 0 0 1-.07 0c-.022-.007-.042-.018-.083-.059l-57.69-57.69c-.041-.041-.052-.06-.059-.084a.1.1 0 0 1 0-.069c.007-.023.018-.042.059-.083L454.073 512L166.371 224.297c-.041-.04-.052-.06-.059-.083a.12.12 0 0 1 0-.07c.007-.022.018-.042.059-.083l57.69-57.69c.041-.041.06-.052.084-.059a.1.1 0 0 1 .069 0c.023.007.042.018.083.059L512 454.073l287.703-287.702c.04-.041.06-.052.083-.059a.12.12 0 0 1 .07 0Z"},null,-1)]))}const Ge=le({name:"ant-design-close-outlined",render:on}),nn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function ln(e,n){return m(),T("svg",nn,n[0]||(n[0]=[_("path",{fill:"currentColor",d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281l360-281.1c3.8-3 6.1-7.7 6.1-12.6"},null,-1)]))}const Nt=le({name:"ant-design-left-outlined",render:ln}),an={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function sn(e,n){return m(),T("svg",an,n[0]||(n[0]=[_("path",{fill:"currentColor",d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448s448-200.6 448-448S759.4 64 512 64m0 820c-205.4 0-372-166.6-372-372c0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884m288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372c0 89-31.3 170.8-83.5 234.8"},null,-1)]))}const dn=le({name:"ant-design-stop-outlined",render:sn}),me=Wt(Pt.Workflow,()=>{const e=k(),n=k(),i=k(),v=k([]);function s(r){e.value=r}function t(r){n.value=r}async function o(r){i.value=r;const{data:c,error:d}=await bo({groupName:r});d||(v.value=c.map(u=>({id:u.id,jobName:u.jobName})))}function p(){e.value=void 0,n.value=void 0,i.value=void 0,v.value=[]}return{id:e,type:n,groupName:i,jobList:v,setJobList:o,setType:t,setId:s,clear:p}}),rn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function un(e,n){return m(),T("svg",rn,n[0]||(n[0]=[_("path",{fill:"currentColor",d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 0 0 0-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 0 0 9.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9m67.4-174.4L687.8 215l73.3 73.3l-362.7 362.6l-88.9 15.7zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32"},null,-1)]))}const cn=le({name:"ant-design-edit-outlined",render:un}),pn={class:"flex items-center"},Oe=F({name:"EditableInput",__name:"editable-input",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:n}){const i=e,v=n,s=k(),t=k(),o=k(!1);X(()=>i.modelValue,c=>{t.value=c},{immediate:!0});const p=()=>{o.value=!0,ce(()=>{var c;(c=s.value)==null||c.focus()})},r=()=>{v("update:modelValue",t.value),o.value=!1};return(c,d)=>{const u=De,x=cn,w=de,f=Ue;return o.value?(m(),L(u,{key:0,ref_key:"inputRef",ref:s,value:t.value,"onUpdate:value":d[0]||(d[0]=S=>t.value=S),type:"text",onBlur:r},null,8,["value"])):(m(),L(f,{key:1},{default:a(()=>[_("span",pn,[B(V(t.value)+" ",1),l(w,{text:"",type:"info",class:"m-l-6px",onClick:p},{icon:a(()=>[l(x,{class:"text-icon"})]),_:1})])]),_:1}))}}}),mn={class:"w-460px flex-center"},fn=F({name:"TaskDrawer",__name:"task-drawer",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1},len:{default:0}},emits:["update:open","save"],setup(e,{emit:n}){const i=e,v=n,s=me(),t=k(!1),o=k({}),p=k([]);X(()=>s.jobList,w=>{p.value=w},{immediate:!0}),X(()=>i.open,w=>{t.value=w},{immediate:!0}),X(()=>i.modelValue,w=>{o.value=w},{immediate:!0});const r=k(),c=()=>{v("update:open",!1),t.value=!1},d=()=>{var w;(w=r.value)==null||w.validate(f=>{f||(c(),v("save",o.value))}).catch(()=>{var f;return(f=window.$message)==null?void 0:f.warning("请检查表单信息")})},u={failStrategy:[{required:!0,message:"请选择失败策略"}],workflowNodeStatus:[{required:!0,message:"请选择工作流状态"}],jobTask:{jobId:[{required:!0,message:"请选择任务"}]}},x=(w,f)=>{o.value.jobTask.jobName=f.label};return(w,f)=>{const S=xe,g=Le,y=Ae,E=Re,M=ze,I=Me,Y=de,b=Ie,$=je;return m(),L($,{show:t.value,"onUpdate:show":f[5]||(f[5]=D=>t.value=D),"display-directive":"if",width:500,onAfterLeave:c},{default:a(()=>[l(b,null,{header:a(()=>[_("div",mn,[l(Oe,{modelValue:o.value.nodeName,"onUpdate:modelValue":f[0]||(f[0]=D=>o.value.nodeName=D),class:"mr-16px max-w-320px min-w-320px"},null,8,["modelValue"]),l(S,{value:o.value.priorityLevel,"onUpdate:value":f[1]||(f[1]=D=>o.value.priorityLevel=D),class:"max-w-110px",options:Array(w.len).fill(0).map((D,q)=>({label:"优先级 "+(q+1),value:q+1}))},null,8,["value","options"])])]),footer:a(()=>[l(Y,{type:"primary",onClick:d},{default:a(()=>f[6]||(f[6]=[B("保存")])),_:1}),l(Y,{class:"ml-12px",onClick:c},{default:a(()=>f[7]||(f[7]=[B("取消")])),_:1})]),default:a(()=>[l(I,{ref_key:"formRef",ref:r,model:o.value,rules:u,"label-align":"left","label-width":"100px"},{default:a(()=>[l(g,{path:"jobTask.jobId",label:"所属任务",placeholder:"请选择任务"},{default:a(()=>[l(S,{value:o.value.jobTask.jobId,"onUpdate:value":[f[2]||(f[2]=D=>o.value.jobTask.jobId=D),x],filterable:"",options:p.value.map(D=>({label:D.jobName,value:D.id}))},null,8,["value","options"])]),_:1}),l(g,{path:"failStrategy",label:"失败策略"},{default:a(()=>[l(M,{value:o.value.failStrategy,"onUpdate:value":f[3]||(f[3]=D=>o.value.failStrategy=D)},{default:a(()=>[l(E,null,{default:a(()=>[(m(!0),T(Q,null,se(h(Ft),(D,q)=>(m(),L(y,{key:q,label:h(U)(D.label),value:D.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1}),l(g,{path:"workflowNodeStatus",label:"节点状态"},{default:a(()=>[l(M,{value:o.value.workflowNodeStatus,"onUpdate:value":f[4]||(f[4]=D=>o.value.workflowNodeStatus=D)},{default:a(()=>[l(E,null,{default:a(()=>[(m(!0),T(Q,null,se(h(Pe),(D,q)=>(m(),L(y,{key:q,label:h(U)(D.label),value:D.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])}}}),vn=F({name:"TaskDetail",__name:"task-detail",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1}},emits:["update:open"],setup(e,{emit:n}){const i=e,v=n,s=me(),t=k(!1);X(()=>i.open,r=>{t.value=r},{immediate:!0});const o=()=>{v("update:open",!1)},p=r=>{var d;return(d=s.jobList.find(u=>u.id===r))==null?void 0:d.jobName};return(r,c)=>{const d=we,u=ye,x=Se;return m(),L(x,{modelValue:t.value,"onUpdate:modelValue":c[0]||(c[0]=w=>t.value=w),title:"任务详情",width:["500px","90%"],onAfterLeave:o},{default:a(()=>[l(u,{column:1,"label-placement":"left",bordered:"","label-style":{width:"120px"}},{default:a(()=>[l(d,{label:"节点名称"},{default:a(()=>[B(V(r.modelValue.nodeName),1)]),_:1}),l(d,{label:"任务 ID"},{default:a(()=>{var w;return[B(V((w=r.modelValue.jobTask)==null?void 0:w.jobId),1)]}),_:1}),l(d,{label:"任务名称"},{default:a(()=>{var w;return[B(V(p((w=r.modelValue.jobTask)==null?void 0:w.jobId)),1)]}),_:1}),l(d,{label:"失败策略"},{default:a(()=>[B(V(h(U)(h(rt)[r.modelValue.failStrategy])),1)]),_:1}),l(d,{label:"工作流状态"},{default:a(()=>[B(V(h(U)(h(ut)[r.modelValue.workflowNodeStatus])),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),hn=F({name:"FlowLogDrawer",__name:"flow-log-drawer",props:Gt({title:{default:U("workflow.node.log.title")},taskData:{}},{show:{type:Boolean,default:!0},showModifiers:{}}),emits:["update:show"],setup(e){const n=qe(e,"show");return(i,v)=>{const s=wo;return m(),L(s,{show:n.value,"onUpdate:show":v[0]||(v[0]=t=>n.value=t),title:i.title,"task-data":i.taskData},null,8,["show","title","task-data"])}}}),bn=F({name:"DetailCard",__name:"detail-card",props:{id:{default:void 0},ids:{default:()=>[]},show:{type:Boolean,default:!1}},emits:["update:show"],setup(e,{emit:n}){ro.registerLanguage("json",uo);const i=e,v=n,s=ct(),t=me(),o=k(!1),p=k(!1),r=k(!1),c=k(1),d=k({}),u=k({page:1,pageCount:0,pageSize:10,showSizePicker:!0,pageSizes:[10,15,20,25,30],onUpdatePage:async b=>{u.value.page=b;const $=i.ids[c.value-1];f($)},onUpdatePageSize:async b=>{u.value.pageSize=b;const $=i.ids[c.value-1];f($)}});X(()=>i.show,b=>{o.value=b,b&&g()},{immediate:!0});const x=()=>{v("update:show",!1)};async function w(b){r.value=!0;const{data:$,error:D}=await go(b);D||(d.value=$,r.value=!1)}async function f(b){r.value=!0;const{data:$,error:D}=await co(b);D||(d.value=$,r.value=!1)}const S=k([]);function g(){S.value=i.ids,ce(()=>{i.ids.length>0?f(i.ids[0]):i.id&&(S.value=[d.value.taskBatchId],w(i.id))})}const y=k({}),E=b=>{y.value=b,p.value=!0},M=async()=>{var $;const{error:b}=await mo(t.id,d.value.workflowNodeId);b||($=window.$message)==null||$.success("执行重试成功")};function I(b){return{color:`${b}18`,textColor:b,borderColor:`${b}58`}}const Y=b=>{c.value=b;const $=i.ids[b-1];f($)};return(b,$)=>{const D=we,q=ye,W=pt,N=Zt,j=po,G=Kt,ee=_o,z=Se,H=hn;return m(),T(Q,null,[l(z,{modelValue:o.value,"onUpdate:modelValue":$[2]||($[2]=A=>o.value=A),title:"任务批次详情",width:["800px","90%"],"onUpdate:show":x},Jt({default:a(()=>[S.value&&S.value.length>0?(m(),L(G,{key:0,value:c.value,"onUpdate:value":$[0]||($[0]=A=>c.value=A),type:"segment",animated:""},{default:a(()=>[(m(!0),T(Q,null,se(S.value,(A,R)=>(m(),L(N,{key:R,name:R+1,tab:A},{default:a(()=>[l(G,{class:"detail-tabs",type:"segment",animated:""},{default:a(()=>[l(N,{name:"info",tab:h(U)("page.log.info")},{default:a(()=>[l(W,{show:r.value},{default:a(()=>[l(q,{class:"pt-12px","label-placement":"left",bordered:"",column:2},{default:a(()=>[l(D,{label:h(U)("page.jobBatch.groupName")},{default:a(()=>{var P;return[B(V((P=d.value)==null?void 0:P.groupName),1)]}),_:1},8,["label"]),l(D,{label:h(U)("page.jobBatch.jobName")},{default:a(()=>{var P;return[B(V((P=d.value)==null?void 0:P.jobName),1)]}),_:1},8,["label"]),l(D,{label:h(U)("page.jobBatch.taskBatchStatus")},{default:a(()=>[h(Ne)(d.value.taskBatchStatus)?(m(),L(h(Be),{key:0,color:I(h(J)[d.value.taskBatchStatus].color)},{default:a(()=>[B(V(h(J)[d.value.taskBatchStatus].title),1)]),_:1},8,["color"])):C("",!0),h(Ne)(d.value.jobStatus)?(m(),L(h(Be),{key:1,color:I(h(tt)[d.value.jobStatus].color)},{default:a(()=>[B(V(h(U)(h(tt)[d.value.jobStatus].name)),1)]),_:1},8,["color"])):C("",!0)]),_:1},8,["label"]),l(D,{label:h(U)("page.jobBatch.executionAt")},{default:a(()=>{var P;return[B(V((P=d.value)==null?void 0:P.executionAt),1)]}),_:1},8,["label"]),l(D,{label:h(U)("page.jobBatch.operationReason")},{default:a(()=>[h(Ne)(d.value.operationReason)?(m(),L(h(Be),{key:0,color:I(h(ot)[d.value.operationReason].color)},{default:a(()=>[B(V(h(U)(h(ot)[d.value.operationReason].name)),1)]),_:1},8,["color"])):C("",!0)]),_:1},8,["label"]),h(s).default?C("",!0):(m(),L(D,{key:0,label:h(U)("page.jobBatch.executorType")},{default:a(()=>[h(Ne)(d.value.executorType)?(m(),L(h(Be),{key:0,color:I(h(nt)[d.value.executorType].color)},{default:a(()=>[B(V(h(U)(h(nt)[d.value.executorType].name)),1)]),_:1},8,["color"])):C("",!0)]),_:1},8,["label"])),l(D,{label:h(U)("page.jobBatch.executorInfo"),span:2},{default:a(()=>{var P;return[B(V((P=d.value)==null?void 0:P.executorInfo),1)]}),_:1},8,["label"]),l(D,{label:h(U)("common.createDt"),span:2},{default:a(()=>{var P;return[B(V((P=d.value)==null?void 0:P.createDt),1)]}),_:1},8,["label"])]),_:1})]),_:1},8,["show"]),_e(b.$slots,"default",{},void 0,!0)]),_:3},8,["tab"]),l(N,{name:"task",disabled:d.value.taskBatchStatus===99},{tab:a(()=>$[4]||($[4]=[_("span",null,"任务项列表",-1)])),default:a(()=>[l(j,{"row-data":d.value,onShowLog:E,onRetry:M},null,8,["row-data"])]),_:1},8,["disabled"])]),_:3})]),_:2},1032,["name","tab"]))),128))]),_:3},8,["value"])):C("",!0)]),_:2},[b.ids&&b.ids.length>1?{name:"footer",fn:a(()=>[l(ee,{page:c.value,"onUpdate:page":[$[1]||($[1]=A=>c.value=A),Y],class:"text-center","page-size":1,"page-count":b.ids.length},null,8,["page","page-count"])]),key:"0"}:void 0]),1032,["modelValue"]),l(H,{show:p.value,"onUpdate:show":$[3]||($[3]=A=>p.value=A),title:"日志详情","task-data":y.value},null,8,["show","task-data"])],64)}}}),Je=pe(bn,[["__scopeId","data-v-e19caaf2"]]),gn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function _n(e,n){return m(),T("svg",gn,n[0]||(n[0]=[_("path",{fill:"currentColor",d:"M847.9 592H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h605.2L612.9 851c-4.1 5.2-.4 13 6.3 13h72.5c4.9 0 9.5-2.2 12.6-6.1l168.8-214.1c16.5-21 1.6-51.8-25.2-51.8M872 356H266.8l144.3-183c4.1-5.2.4-13-6.3-13h-72.5c-4.9 0-9.5 2.2-12.6 6.1L150.9 380.2c-16.5 21-1.6 51.8 25.1 51.8h696c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8"},null,-1)]))}const wn=le({name:"ant-design-swap-outlined",render:_n}),yn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function kn(e,n){return m(),T("svg",yn,n[0]||(n[0]=[_("path",{fill:"currentColor",d:"M752 664c-28.5 0-54.8 10-75.4 26.7L469.4 540.8a160.7 160.7 0 0 0 0-57.6l207.2-149.9C697.2 350 723.5 360 752 360c66.2 0 120-53.8 120-120s-53.8-120-120-120s-120 53.8-120 120c0 11.6 1.6 22.7 4.7 33.3L439.9 415.8C410.7 377.1 364.3 352 312 352c-88.4 0-160 71.6-160 160s71.6 160 160 160c52.3 0 98.7-25.1 127.9-63.8l196.8 142.5c-3.1 10.6-4.7 21.8-4.7 33.3c0 66.2 53.8 120 120 120s120-53.8 120-120s-53.8-120-120-120m0-476c28.7 0 52 23.3 52 52s-23.3 52-52 52s-52-23.3-52-52s23.3-52 52-52M312 600c-48.5 0-88-39.5-88-88s39.5-88 88-88s88 39.5 88 88s-39.5 88-88 88m440 236c-28.7 0-52-23.3-52-52s23.3-52 52-52s52 23.3 52 52s-23.3 52-52 52"},null,-1)]))}const Nn=le({name:"ant-design-share-alt-outlined",render:kn}),xn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function $n(e,n){return m(),T("svg",xn,n[0]||(n[0]=[_("path",{fill:"currentColor",d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8m0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8m0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8M104 228a56 56 0 1 0 112 0a56 56 0 1 0-112 0m0 284a56 56 0 1 0 112 0a56 56 0 1 0-112 0m0 284a56 56 0 1 0 112 0a56 56 0 1 0-112 0"},null,-1)]))}const Sn=le({name:"ant-design-unordered-list-outlined",render:$n}),Vn={class:"add-node-btn-box"},Bn={class:"add-node-btn"},Cn={class:"add-node-popover-body"},Tn={class:"icon"},Dn=F({name:"AddNode",__name:"add-node",props:{modelValue:{},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:n}){const i=e,v=n,s=t=>{let o={};t===1?o={nodeName:U("workflow.node.task.nodeName"),nodeType:1,conditionNodes:[{nodeName:U("workflow.node.task.conditionNodes.nodeName"),failStrategy:1,priorityLevel:1,workflowNodeStatus:1,jobTask:{jobId:void 0}}],childNode:i.modelValue}:t===2?o={nodeName:U("workflow.node.condition.nodeName"),nodeType:2,conditionNodes:[{nodeName:`${U("workflow.node.condition.conditionNodes.nodeName")} 1`,priorityLevel:1,decision:{expressionType:1,nodeExpression:void 0,logicalCondition:1,defaultDecision:0}},{nodeName:U("workflow.node.condition.conditionNodes.otherNodeName"),priorityLevel:2,decision:{expressionType:1,nodeExpression:"#true",logicalCondition:1,defaultDecision:1}}],childNode:i.modelValue}:t===3&&(o={nodeName:U("workflow.node.callback.nodeName"),nodeType:3,conditionNodes:[{nodeName:U("workflow.node.callback.conditionNodes.nodeName"),workflowNodeStatus:1,callback:{webhook:void 0,contentType:void 0,secret:void 0}}],childNode:i.modelValue}),v("update:modelValue",o)};return(t,o)=>{const p=wt,r=de,c=Sn,d=Nn,u=wn,x=Fe;return m(),T("div",Vn,[_("div",Bn,[t.disabled?C("",!0):(m(),L(x,{key:0,placement:"right-end",trigger:"click","overlay-style":{width:"296px"}},{trigger:a(()=>[l(r,{type:"primary",circle:"",strong:""},{default:a(()=>[l(p)]),_:1})]),default:a(()=>[_("div",Cn,[_("ul",Tn,[_("li",null,[l(r,{circle:"",size:"large",onClick:o[0]||(o[0]=w=>s(1))},{default:a(()=>[l(c,{class:"text-20px color-#3296fa"})]),_:1}),_("p",null,V(h(U)("workflow.node.task.nodeName")),1)]),_("li",null,[l(r,{circle:"",size:"large",onClick:o[1]||(o[1]=w=>s(2))},{default:a(()=>[l(d,{class:"text-20px color-#15bc83"})]),_:1}),_("p",null,V(h(U)("workflow.node.condition.nodeName")),1)]),_("li",null,[l(r,{circle:"",size:"large",onClick:o[2]||(o[2]=w=>s(3))},{default:a(()=>[l(u,{class:"text-20px color-#935af6"})]),_:1}),_("p",null,V(h(U)("workflow.node.callback.nodeName")),1)])])])]),_:1}))])])}}}),fe=pe(Dn,[["__scopeId","data-v-f9b0541f"]]),Un={class:"node-wrap"},Ln={class:"branch-box"},Rn={class:"condition-node"},Mn={class:"condition-node-box"},In={class:"popover"},jn={class:"popover-item"},En={class:"popover-item"},zn=["onClick"],An=["onClick"],Hn={class:"title"},On={class:"text color-#3296fa"},Yn={key:0},qn={class:"priority-title"},Xn={class:"content min-h-72px"},Wn={key:0,class:"placeholder"},Pn=["onClick"],Fn={key:1,class:"top-left-cover-line"},Gn={key:2,class:"bottom-left-cover-line"},Jn={key:3,class:"top-right-cover-line"},Kn={key:4,class:"bottom-right-cover-line"},Zn=F({name:"TaskNode",__name:"task-node",props:{modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["refresh","update:modelValue"],setup(e,{emit:n}){const i=e,v=n,s=me(),t=Qt(),o=k({});X(()=>i.modelValue,N=>{o.value=N},{immediate:!0});const p=()=>{var j;const N=o.value.conditionNodes.length+1;(j=o.value.conditionNodes)==null||j.push({nodeName:`${U("workflow.node.task.name")} ${N}`,priorityLevel:N,failStrategy:1,workflowNodeStatus:1,jobTask:{jobId:void 0}}),v("update:modelValue",o.value)},r=(N,j)=>{N.childNode?r(N.childNode,j):N.childNode=j},c=N=>{var j;o.value.conditionNodes.length===1?(o.value.childNode&&(o.value.conditionNodes[0].childNode?r(o.value.conditionNodes[0].childNode,o.value.childNode):o.value.conditionNodes[0].childNode=o.value.childNode),ce(()=>{v("update:modelValue",o.value.conditionNodes[0].childNode)})):(j=o.value.conditionNodes)==null||j.splice(N,1)},d=(N,j=1)=>{var G;o.value.conditionNodes[N]=o.value.conditionNodes.splice(N+j,1,o.value.conditionNodes[N])[0],(G=o.value.conditionNodes)==null||G.map((ee,z)=>ee.priorityLevel=z+1),v("update:modelValue",o.value)},u=k(0),x=k(!1),w=k({}),f=N=>{const j=o.value.conditionNodes[u.value].priorityLevel,G=N.priorityLevel;o.value.conditionNodes[u.value]=N,j!==G&&d(u.value,G-j),v("update:modelValue",o.value)},S=N=>{i.disabled||(u.value=N,w.value=JSON.parse(JSON.stringify(o.value.conditionNodes[N])),x.value=!0)},g=N=>i.disabled?s.type===2?`node-error node-error-${N.taskBatchStatus&&J[N.taskBatchStatus]?J[N.taskBatchStatus].name:"default"}`:"node-error":"auto-judge-def auto-judge-hover",y=k(),E=k(),M=k(!1),I=k([]),Y=(N,j)=>{var G,ee,z,H;E.value=[],s.type===2?((G=N.jobBatchList)==null||G.sort((A,R)=>A.taskBatchStatus-R.taskBatchStatus).forEach(A=>{var R,P;A.id?(R=E.value)==null||R.push(A.id):A.jobId&&(y.value=(P=A.jobId)==null?void 0:P.toString())}),(ee=N.jobTask)!=null&&ee.jobId&&(y.value=(H=(z=N.jobTask)==null?void 0:z.jobId)==null?void 0:H.toString()),M.value=!0):s.type===1?I.value[j]=!0:S(j)},b=async N=>{const{error:j}=await fo(N.id,s.id);j||(t.success("执行重试成功"),v("refresh"))},$=async N=>{const{error:j}=await vo(N.id,s.id);j||(t.success("停止任务成功"),v("refresh"))},D=N=>N===4||N===5||N===6,q=N=>N===1||N===2,W=N=>D(N)||q(N);return(N,j)=>{const G=de,ee=bt,z=mt,H=dn,A=Nt,R=He,P=Ge,ve=Ue,Ve=kt,Ke=Fe,Vt=Ee,Bt=$e;return m(),T("div",Un,[_("div",Ln,[N.disabled?C("",!0):(m(),L(G,{key:0,class:"add-branch",strong:"",type:"success",onClick:p},{default:a(()=>[B(V(h(U)("workflow.node.task.add")),1)]),_:1})),(m(!0),T(Q,null,se(o.value.conditionNodes,(O,te)=>(m(),T("div",{key:te,class:"col-box"},[_("div",Rn,[_("div",Mn,[l(Ke,{disabled:h(s).type!==2||!W(O.taskBatchStatus)},{trigger:a(()=>{var re,Ze;return[_("div",{class:ge(["auto-judge cursor-pointer",g(O)]),onClick:he=>Y(O,te)},[te!=0?(m(),T("div",{key:0,class:"sort-left",onClick:oe(he=>d(te,-1),["stop"])},[l(A)],8,An)):C("",!0),_("div",Hn,[_("span",On,[l(R,{processing:"",dot:"",color:O.workflowNodeStatus===1?"#52c41a":"#ff4d4f"},null,8,["color"]),B("  "+V(O.nodeName)+" ",1),O.id?(m(),T("span",Yn," ("+V(O.id)+")",1)):C("",!0)]),_("span",qn,V(h(U)("workflow.node.priority"))+V(O.priorityLevel),1),N.disabled?C("",!0):(m(),L(P,{key:0,class:"close",onClick:oe(he=>c(te),["stop"])},null,8,["onClick"]))]),_("div",Xn,[(re=O.jobTask)!=null&&re.jobId?C("",!0):(m(),T("div",Wn,"请选择任务")),(Ze=O.jobTask)!=null&&Ze.jobId?(m(),T(Q,{key:1},[_("div",null,[j[5]||(j[5]=_("span",{class:"content_label"},"任务名称: ",-1)),l(ve,{class:"max-w-123px"},{default:a(()=>{var he,Qe;return[B(V(`${(he=O.jobTask)==null?void 0:he.jobName}(${(Qe=O.jobTask)==null?void 0:Qe.jobId})`),1)]}),_:2},1024)]),_("div",null,[j[6]||(j[6]=_("span",{class:"content_label"},"失败策略: ",-1)),B(" "+V(h(U)(h(rt)[O.failStrategy])),1)]),j[7]||(j[7]=_("div",null,".........",-1))],64)):C("",!0)]),te!=o.value.conditionNodes.length-1?(m(),T("div",{key:1,class:"sort-right",onClick:oe(he=>d(te),["stop"])},[l(Ve)],8,Pn)):C("",!0)],10,zn)]}),default:a(()=>[_("div",In,[D(O.taskBatchStatus)?(m(),L(G,{key:0,text:"",onClick:re=>b(O)},{default:a(()=>[_("span",jn,[l(ee,{class:"mb-3px text-24px font-bold"}),B(" "+V(h(U)("common.retry")),1)])]),_:2},1032,["onClick"])):C("",!0),q(O.taskBatchStatus)&&D(O.taskBatchStatus)?(m(),L(z,{key:1,vertical:""})):C("",!0),q(O.taskBatchStatus)?(m(),L(G,{key:2,text:"",onClick:re=>$(O)},{default:a(()=>[_("span",En,[l(H),B(" "+V(h(U)("common.stop")),1)])]),_:2},1032,["onClick"])):C("",!0)])]),_:2},1032,["disabled"]),h(s).type===2&&O.taskBatchStatus?(m(),L(Bt,{key:0},{trigger:a(()=>[_("div",{class:"task-error-tip text-24px",style:ue({color:h(J)[O.taskBatchStatus].color})},[l(Vt,{icon:h(J)[O.taskBatchStatus].icon},null,8,["icon"])],4)]),default:a(()=>[B(" "+V(h(J)[O.taskBatchStatus].title),1)]),_:2},1024)):C("",!0),l(fe,{modelValue:O.childNode,"onUpdate:modelValue":re=>O.childNode=re,disabled:N.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])])]),O.childNode?_e(N.$slots,"default",{key:0,node:O},void 0,!0):C("",!0),te==0?(m(),T("div",Fn)):C("",!0),te==0?(m(),T("div",Gn)):C("",!0),te==o.value.conditionNodes.length-1?(m(),T("div",Jn)):C("",!0),te==o.value.conditionNodes.length-1?(m(),T("div",Kn)):C("",!0),h(s).type!==0?(m(),L(vn,{key:5,open:I.value[te],"onUpdate:open":re=>I.value[te]=re,"model-value":o.value.conditionNodes[te]},null,8,["open","onUpdate:open","model-value"])):C("",!0)]))),128))]),o.value.conditionNodes.length>1?(m(),L(fe,{key:0,modelValue:o.value.childNode,"onUpdate:modelValue":j[0]||(j[0]=O=>o.value.childNode=O),disabled:N.disabled},null,8,["modelValue","disabled"])):C("",!0),h(s).type===0?(m(),L(fn,{key:1,open:x.value,"onUpdate:open":j[1]||(j[1]=O=>x.value=O),modelValue:w.value,"onUpdate:modelValue":j[2]||(j[2]=O=>w.value=O),len:o.value.conditionNodes.length,"onUpdate:len":j[3]||(j[3]=O=>o.value.conditionNodes.length=O),onSave:f},null,8,["open","modelValue","len"])):C("",!0),h(s).type!==0?(m(),L(Je,{key:2,id:y.value,show:M.value,"onUpdate:show":j[4]||(j[4]=O=>M.value=O),ids:E.value},null,8,["id","show","ids"])):C("",!0)])}}}),Qn=pe(Zn,[["__scopeId","data-v-7f63c83a"]]),el={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function tl(e,n){return m(),T("svg",el,n[0]||(n[0]=[_("path",{fill:"currentColor",d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448s448-200.6 448-448S759.4 64 512 64m0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372s372 166.6 372 372s-166.6 372-372 372"},null,-1),_("path",{fill:"currentColor",d:"M464 336a48 48 0 1 0 96 0a48 48 0 1 0-96 0m72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8"},null,-1)]))}const xt=le({name:"ant-design-info-circle-outlined",render:tl}),$t=F({__name:"dynamic-input",props:{value:{required:!0,default:()=>[]},valueModifiers:{},path:{required:!0},pathModifiers:{}},emits:["update:value","update:path"],setup(e){const n=qe(e,"value"),i=qe(e,"path"),v=()=>({key:"",value:"",type:"string"}),s=[{trigger:["input","blur"],validator(r,c){return!c&&c!==0?new Error("不能为空"):!0}}],t=[{label:"string",value:"string"},{label:"number",value:"number"},{label:"boolean",value:"boolean"}],o=[{label:"true",value:1},{label:"false",value:0}],p=r=>{n.value[r].type==="string"&&(n.value[r].value=""),n.value[r].type==="boolean"&&(n.value[r].value=0),n.value[r].type==="number"&&(n.value[r].value=0)};return(r,c)=>{const d=De,u=yo,x=gt,w=ft,f=xe,S=_t,g=ko;return m(),L(g,{value:n.value,"onUpdate:value":c[5]||(c[5]=y=>n.value=y),"item-style":"margin-bottom: 0;","on-create":v},{default:a(({index:y})=>[l(S,null,{default:a(()=>[l(u,{span:7,"ignore-path-change":"","show-label":!1,rule:s,path:`${i.value}[${y}].key`},{default:a(()=>[l(d,{value:n.value[y].key,"onUpdate:value":E=>n.value[y].key=E,placeholder:"key",onKeydown:c[0]||(c[0]=ke(oe(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"])]),_:2},1032,["path"]),l(x,{span:2,class:"h-34px text-center lh-34px"},{default:a(()=>c[6]||(c[6]=[B("=")])),_:1}),l(u,{span:7,"ignore-path-change":"","show-label":!1,rule:s,path:`${i.value}[${y}].value`},{default:a(()=>[n.value[y].type==="string"?(m(),L(d,{key:0,value:n.value[y].value,"onUpdate:value":E=>n.value[y].value=E,placeholder:"value",onKeydown:c[1]||(c[1]=ke(oe(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"])):C("",!0),n.value[y].type==="number"?(m(),L(w,{key:1,value:n.value[y].value,"onUpdate:value":E=>n.value[y].value=E,class:"w-full",placeholder:"value",onKeydown:c[2]||(c[2]=ke(oe(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"])):C("",!0),n.value[y].type==="boolean"?(m(),L(f,{key:2,value:n.value[y].value,"onUpdate:value":E=>n.value[y].value=E,class:"w-full",options:o,placeholder:"value",onKeydown:c[3]||(c[3]=ke(oe(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"])):C("",!0)]),_:2},1032,["path"]),l(u,{span:3,class:"ml-12px w-115px","ignore-path-change":"","show-label":!1,path:`${i.value}[${y}].type`},{default:a(()=>[c[7]||(c[7]=_("div",{class:"h-34px lh-34px"},"(",-1)),l(f,{value:n.value[y].type,"onUpdate:value":[E=>n.value[y].type=E,E=>p(y)],class:"mx-3px",options:t,placeholder:"字段类型",onKeydown:c[4]||(c[4]=ke(oe(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"]),c[8]||(c[8]=_("div",{class:"h-34px lh-34px"},")",-1))]),_:2},1032,["path"])]),_:2},1024)]),_:1},8,["value"])}}}),ol={class:"w-460px flex-center"},nl=F({name:"BranchDrawer",__name:"branch-drawer",props:{open:{type:Boolean,default:!1},len:{default:0},modelValue:{default:()=>({})}},emits:["update:open","save"],setup(e,{emit:n}){const i=e,v=n,s=k(!1),t=k({decision:{logicalCondition:1,expressionType:1,nodeExpression:"",checkContents:[]}});X(()=>i.open,w=>{s.value=w},{immediate:!0}),X(()=>i.modelValue,w=>{t.value=w},{immediate:!0});const o=k(),p=()=>{v("update:open",!1),s.value=!1},r=()=>{var w;(w=o.value)==null||w.validate(f=>{f||(p(),v("save",t.value))}).catch(()=>{var f;return(f=window.$message)==null?void 0:f.warning("请检查表单信息")})},c=k(""),d=k("success"),u=async()=>{var S;if(d.value="error",!((S=t.value.decision)!=null&&S.nodeExpression)){c.value="请填写条件表达式";return}const{error:w,data:f}=await ho(t.value.decision);if(w){c.value="接口请求失败";return}else if(f.key!==1||!f.value){c.value=f.value||"请检查条件表达式";return}d.value="success",c.value="表达式校验通过"},x={decision:{expressionType:[{required:!0,message:"请选择表达式类型",trigger:"change",type:"number"}],nodeExpression:[{required:!0,message:"请填写条件表达式",trigger:"blur"}]}};return(w,f)=>{const S=xe,g=Ae,y=Re,E=ze,M=Le,I=No,Y=$t,b=de,$=Me,D=Ie,q=je;return m(),L(q,{show:s.value,"onUpdate:show":f[5]||(f[5]=W=>s.value=W),"display-directive":"if",width:500,onAfterLeave:p},{default:a(()=>[l(D,null,{header:a(()=>[_("div",ol,[l(Oe,{modelValue:t.value.nodeName,"onUpdate:modelValue":f[0]||(f[0]=W=>t.value.nodeName=W),class:"mr-16px max-w-320px min-w-320px"},null,8,["modelValue"]),l(S,{value:t.value.priorityLevel,"onUpdate:value":f[1]||(f[1]=W=>t.value.priorityLevel=W),class:"max-w-110px",options:Array(w.len).fill(0).map((W,N)=>({label:"优先级 "+(N+1),value:N+1}))},null,8,["value","options"])])]),footer:a(()=>[l(b,{type:"primary",onClick:r},{default:a(()=>f[7]||(f[7]=[B("保存")])),_:1}),l(b,{class:"ml-12px",onClick:p},{default:a(()=>f[8]||(f[8]=[B("取消")])),_:1})]),default:a(()=>[l($,{ref_key:"formRef",ref:o,rules:x,model:t.value,"label-align":"left","label-width":"100px"},{default:a(()=>{var W;return[l(M,{path:"decision.expressionType",label:"表达式类型"},{default:a(()=>[l(E,{value:t.value.decision.expressionType,"onUpdate:value":f[2]||(f[2]=N=>t.value.decision.expressionType=N)},{default:a(()=>[l(y,null,{default:a(()=>[(m(!0),T(Q,null,se(h(eo),N=>(m(),L(g,{key:N.value,label:N.label,value:N.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1}),l(M,{path:"decision.nodeExpression",label:"条件表达式","validation-status":d.value,feedback:c.value},{default:a(()=>[l(I,{modelValue:t.value.decision.nodeExpression,"onUpdate:modelValue":f[3]||(f[3]=N=>t.value.decision.nodeExpression=N),placeholder:"请输入条件表达式"},null,8,["modelValue"])]),_:1},8,["validation-status","feedback"]),l(M,{path:"decision.checkContents",label:"模拟上下文","show-feedback":((W=t.value.decision)==null?void 0:W.checkContents)&&t.value.decision.checkContents.length===0},{default:a(()=>[l(Y,{value:t.value.decision.checkContents,"onUpdate:value":f[4]||(f[4]=N=>t.value.decision.checkContents=N),path:"decision.checkContents"},null,8,["value"])]),_:1},8,["show-feedback"]),l(M,{"show-label":!1,"show-feedback":!1},{default:a(()=>[l(b,{type:"primary",ghost:"",block:"",onClick:u},{default:a(()=>f[6]||(f[6]=[B("校验条件表达式")])),_:1})]),_:1})]}),_:1},8,["model"])]),_:1})]),_:1},8,["show"])}}}),ll=pe(nl,[["__scopeId","data-v-f88d9134"]]),St=F({name:"BranchDesc",__name:"branch-desc",props:{modelValue:{default:()=>({})}},setup(e){const n=e,i=k(""),v=k({".cm-line":{fontSize:"18px"},".cm-scroller":{minHeight:"180px",overflowY:"auto",overflowX:"hidden"}}),s=()=>{var w;const t=document.getElementById("branch-desc"),o=t==null?void 0:t.querySelector(".n-descriptions-table"),p=o==null?void 0:o.querySelector("tbody"),r=document.createElement("tr");r.className="n-descriptions-table-row";const c=document.createElement("th");c.className="n-descriptions-table-header",c.innerHTML="条件表达式",c.setAttribute("colspan","4"),r.appendChild(c),p==null||p.insertBefore(r,p==null?void 0:p.childNodes[4]);const u=p.getElementsByClassName("n-descriptions-table-row")[3];(w=u.querySelector(".n-descriptions-table-header"))==null||w.remove();const x=u.querySelector(".n-descriptions-table-content");x.setAttribute("style","padding: 0"),x==null||x.setAttribute("colspan","4")};return Te(()=>{var t;ce(()=>{s()}),(t=n.modelValue.decision)!=null&&t.nodeExpression&&(i.value=n.modelValue.decision.nodeExpression)}),(t,o)=>{const p=we,r=ye;return m(),L(r,{id:"branch-desc",column:2,"label-placement":"left",bordered:"","label-style":{width:"120px"}},{default:a(()=>[l(p,{label:"节点名称",span:2},{default:a(()=>[B(V(t.modelValue.nodeName),1)]),_:1}),l(p,{label:"表达式类型"},{default:a(()=>{var c;return[B(V(h(vt)[(c=t.modelValue.decision)==null?void 0:c.expressionType]),1)]}),_:1}),l(p,{label:"条件表达式",span:2,"content-style":{padding:0}},{default:a(()=>[l(h(xo),{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=c=>i.value=c),readonly:"",disabled:"",theme:v.value,basic:"",lang:h($o)(),extensions:[h(So)]},null,8,["modelValue","theme","lang","extensions"])]),_:1})]),_:1})}}}),al=F({name:"BranchDetail",__name:"branch-detail",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1}},emits:["update:open"],setup(e,{emit:n}){const i=e,v=n,s=k(!1),t=()=>{v("update:open",!1)};return X(()=>i.open,o=>{s.value=o},{immediate:!0}),(o,p)=>{const r=Se;return m(),L(r,{modelValue:s.value,"onUpdate:modelValue":p[0]||(p[0]=c=>s.value=c),title:"决策详情",width:["500px","90%"],onAfterLeave:t},{default:a(()=>[s.value?(m(),L(St,{key:0,"model-value":o.modelValue},null,8,["model-value"])):C("",!0)]),_:1},8,["modelValue"])}}}),sl={class:"branch-wrap"},il={class:"branch-box-wrap"},dl={class:"branch-box"},rl={class:"condition-node"},ul={class:"condition-node-box"},cl=["onClick"],pl=["onClick"],ml={class:"title"},fl={class:"node-title"},vl={key:0},hl={class:"priority-title"},bl={class:"content"},gl=["innerHTML"],_l={key:1,class:"placeholder"},wl=["onClick"],yl={key:1,class:"top-left-cover-line"},kl={key:2,class:"bottom-left-cover-line"},Nl={key:3,class:"top-right-cover-line"},xl={key:4,class:"bottom-right-cover-line"},$l=F({name:"BranchNode",__name:"branch-node",props:{modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:n}){const i=e,v=n,s=me(),t=k({});X(()=>i.modelValue,b=>{t.value=b},{immediate:!0});const o=()=>{const b=t.value.conditionNodes.length;t.value.conditionNodes.splice(-1,0,{nodeName:`${U("workflow.node.condition.conditionNodes.nodeName")} ${b}`,priorityLevel:b,decision:{expressionType:1,nodeExpression:void 0,logicalCondition:1,defaultDecision:0}}),t.value.conditionNodes[b].priorityLevel=b+1},p=(b,$)=>{b.childNode?p(b.childNode,$):b.childNode=$},r=b=>{var $;($=t.value.conditionNodes)==null||$.splice(b,1),t.value.conditionNodes.length===1&&(t.value.childNode&&(t.value.conditionNodes[0].childNode?p(t.value.conditionNodes[0].childNode,t.value.childNode):t.value.conditionNodes[0].childNode=t.value.childNode),ce(()=>{v("update:modelValue",t.value.conditionNodes[0].childNode)}))},c=(b,$=1)=>{var D;t.value.conditionNodes[b]=t.value.conditionNodes.splice(b+$,1,t.value.conditionNodes[b])[0],(D=t.value.conditionNodes)==null||D.map((q,W)=>q.priorityLevel=W+1),v("update:modelValue",t.value)},d=(b,$)=>{const{nodeName:D,decision:q}=b.conditionNodes[$],{expressionType:W,nodeExpression:N}=q;return N?D!==U("workflow.node.condition.conditionNodes.otherNodeName")?`<span class="content_label">${U("workflow.node.condition.conditionNodes.expressionType")}: </span>${vt[W]}
<span class="content_label">${U("workflow.node.condition.conditionNodes.nodeExpression")}: </span><span style="display: inline-block; vertical-align: bottom; width: 120px; overflow: hidden; text-overflow: ellipsis">${N}<span/>`:U("workflow.node.condition.conditionNodes.otherNodeTip"):D===U("workflow.node.condition.conditionNodes.otherNodeName")?U("workflow.node.condition.conditionNodes.otherNodeTip"):null},u=k(0),x=k(!1),w=k([]),f=k({}),S=b=>{const $=t.value.conditionNodes[u.value].priorityLevel,D=b.priorityLevel;t.value.conditionNodes[u.value]=b,$!==D&&c(u.value,D-$),v("update:modelValue",t.value)},g=b=>{!i.disabled&&b!==t.value.conditionNodes.length-1?(u.value=b,f.value=JSON.parse(JSON.stringify(t.value.conditionNodes[b])),x.value=!0):s.type!==0&&(w.value[b]=!0)},y=k([]),E=k(""),M=k([]),I=(b,$)=>{var D;if(M.value=[],b.nodeName!==U("workflow.node.condition.conditionNodes.otherNodeName"))if(s.type===2){if((D=b.jobBatchList)==null||D.forEach(q=>{var W,N;q.id?(W=M.value)==null||W.push(q.id):q.jobId&&(E.value=(N=q.jobId)==null?void 0:N.toString())}),M.value.length===0){w.value[$]=!0;return}y.value[$]=!0}else s.type===1?w.value[$]=!0:g($)},Y=b=>i.disabled?s.type===2?b.nodeName===U("workflow.node.condition.conditionNodes.otherNodeName")?`node-disabled node-error node-error-${b.taskBatchStatus?J[b.taskBatchStatus].name:"default"}`:`node-error node-error-${b.taskBatchStatus?J[b.taskBatchStatus].name:"default"}`:b.nodeName===U("workflow.node.condition.conditionNodes.otherNodeName")?"node-disabled":"node-error":b.nodeName===U("workflow.node.condition.conditionNodes.otherNodeName")?"node-disabled":"auto-judge-def auto-judge-hover";return(b,$)=>{const D=de,q=Nt,W=He,N=xt,j=$e,G=Ge,ee=kt,z=Ee;return m(),T("div",sl,[_("div",il,[_("div",dl,[b.disabled?C("",!0):(m(),L(D,{key:0,strong:"",type:"success",class:"add-branch",onClick:o},{default:a(()=>[B(V(h(U)("workflow.node.condition.addBranch")),1)]),_:1})),(m(!0),T(Q,null,se(t.value.conditionNodes,(H,A)=>(m(),T("div",{key:A,class:"col-box"},[_("div",rl,[_("div",ul,[_("div",{class:ge(["auto-judge",Y(H)]),onClick:R=>I(H,A)},[A!==0?(m(),T("div",{key:0,class:"sort-left",onClick:oe(R=>c(A,-1),["stop"])},[l(q)],8,pl)):C("",!0),_("div",ml,[_("span",fl,[l(W,{dot:"",processing:"",color:"#52c41a"}),B("  "+V(H.nodeName)+" ",1),H.id&&H.nodeName!==h(U)("workflow.node.condition.conditionNodes.otherNodeName")?(m(),T("span",vl,"  ("+V(H.id)+") ",1)):C("",!0),H.nodeName===h(U)("workflow.node.condition.conditionNodes.otherNodeName")?(m(),L(j,{key:1},{trigger:a(()=>[l(N,{class:"ml-3px text-16px"})]),default:a(()=>[B(" "+V(h(U)("workflow.node.condition.conditionNodes.otherTip")),1)]),_:1})):C("",!0)]),_("span",hl,V(h(U)("workflow.node.condition.conditionNodes.priority"))+V(H.priorityLevel),1),b.disabled?C("",!0):(m(),L(G,{key:0,class:"close",onClick:oe(R=>r(A),["stop"])},null,8,["onClick"]))]),_("div",bl,[d(t.value,A)?(m(),T("span",{key:0,innerHTML:d(t.value,A)},null,8,gl)):(m(),T("span",_l,V(h(U)("workflow.node.condition.conditionNodes.conditionTip")),1))]),A!==t.value.conditionNodes.length-2?(m(),T("div",{key:1,class:"sort-right",onClick:oe(R=>c(A),["stop"])},[l(ee)],8,wl)):C("",!0),h(s).type===2&&H.taskBatchStatus?(m(),L(j,{key:2},{trigger:a(()=>[_("div",{class:"error-tip text-24px",style:ue({color:h(J)[H.taskBatchStatus].color})},[l(z,{icon:h(J)[H.taskBatchStatus].icon},null,8,["icon"])],4)]),default:a(()=>[B(" "+V(h(J)[H.taskBatchStatus].title),1)]),_:2},1024)):C("",!0)],10,cl),l(fe,{modelValue:H.childNode,"onUpdate:modelValue":R=>H.childNode=R,disabled:b.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])])]),H.childNode?_e(b.$slots,"default",{key:0,node:H},void 0,!0):C("",!0),A==0?(m(),T("div",yl)):C("",!0),A==0?(m(),T("div",kl)):C("",!0),A==t.value.conditionNodes.length-1?(m(),T("div",Nl)):C("",!0),A==t.value.conditionNodes.length-1?(m(),T("div",xl)):C("",!0),l(al,{open:w.value[A],"onUpdate:open":R=>w.value[A]=R,modelValue:t.value.conditionNodes[A],"onUpdate:modelValue":R=>t.value.conditionNodes[A]=R},null,8,["open","onUpdate:open","modelValue","onUpdate:modelValue"]),l(Je,{id:E.value,show:y.value[A],"onUpdate:show":R=>y.value[A]=R,ids:M.value},{default:a(()=>[$[4]||($[4]=_("div",{class:"header-border"},[_("span",{class:"pl-12px"},"决策节点详情")],-1)),l(St,{"model-value":t.value.conditionNodes[A]},null,8,["model-value"])]),_:2},1032,["id","show","onUpdate:show","ids"])]))),128))]),l(fe,{modelValue:t.value.childNode,"onUpdate:modelValue":$[0]||($[0]=H=>t.value.childNode=H),disabled:b.disabled},null,8,["modelValue","disabled"])]),l(ll,{open:x.value,"onUpdate:open":$[1]||($[1]=H=>x.value=H),modelValue:f.value,"onUpdate:modelValue":$[2]||($[2]=H=>f.value=H),len:t.value.conditionNodes.length,"onUpdate:len":$[3]||($[3]=H=>t.value.conditionNodes.length=H),onSave:S},null,8,["open","modelValue","len"])])}}}),Sl=pe($l,[["__scopeId","data-v-61d296a2"]]),Vl={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function Bl(e,n){return m(),T("svg",Vl,n[0]||(n[0]=[_("path",{fill:"currentColor",d:"M112 476h160v72H112zm320 0h160v72H432zm320 0h160v72H752z"},null,-1)]))}const Cl=le({name:"ant-design-dash-outlined",render:Bl}),Tl={class:"w-460px flex items-center"},Dl=F({name:"CallbackDrawer",__name:"callback-drawer",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1}},emits:["update:open","save"],setup(e,{emit:n}){const i=e,v=n,s=k(!1),t=k({});X(()=>i.open,d=>{s.value=d},{immediate:!0}),X(()=>i.modelValue,d=>{t.value=d},{immediate:!0});const o=k(),p=()=>{v("update:open",!1),s.value=!1},r=()=>{var d;(d=o.value)==null||d.validate(u=>{u||(p(),v("save",t.value))}).catch(()=>{var u;return(u=window.$message)==null?void 0:u.warning("请检查表单信息")})},c={workflowNodeStatus:[{required:!0,message:"请选择工作流状态",trigger:"change"}],callback:{webhook:[{required:!0,message:"请输入 webhook",trigger:"change"}],contentType:[{required:!0,message:"请选择请求类型",trigger:"change",type:"number"}],secret:[{required:!0,message:"请输入秘钥",trigger:"change"}]}};return(d,u)=>{const x=De,w=Le,f=xe,S=Ae,g=Re,y=ze,E=Me,M=de,I=Ie,Y=je;return m(),L(Y,{show:s.value,"onUpdate:show":u[5]||(u[5]=b=>s.value=b),"display-directive":"if",width:500,onAfterLeave:p},{default:a(()=>[l(I,null,{header:a(()=>[_("div",Tl,[l(Oe,{modelValue:t.value.nodeName,"onUpdate:modelValue":u[0]||(u[0]=b=>t.value.nodeName=b),class:"mr-16px max-w-320px min-w-320px"},null,8,["modelValue"])])]),footer:a(()=>[l(M,{type:"primary",onClick:r},{default:a(()=>u[6]||(u[6]=[B("保存")])),_:1}),l(M,{class:"ml-12px",onClick:p},{default:a(()=>u[7]||(u[7]=[B("取消")])),_:1})]),default:a(()=>[l(E,{ref_key:"formRef",ref:o,model:t.value,rules:c,"label-align":"left","label-width":"100px"},{default:a(()=>[l(w,{path:"callback.webhook",label:"webhook"},{default:a(()=>[l(x,{value:t.value.callback.webhook,"onUpdate:value":u[1]||(u[1]=b=>t.value.callback.webhook=b),placeholder:"请输入 webhook"},null,8,["value"])]),_:1}),l(w,{path:"callback.contentType",label:"请求类型"},{default:a(()=>[l(f,{value:t.value.callback.contentType,"onUpdate:value":u[2]||(u[2]=b=>t.value.callback.contentType=b),options:h(to),placeholder:"请选择请求类型"},null,8,["value","options"])]),_:1}),l(w,{path:"callback.secret",label:"秘钥"},{default:a(()=>[l(x,{value:t.value.callback.secret,"onUpdate:value":u[3]||(u[3]=b=>t.value.callback.secret=b),placeholder:"请输入秘钥"},null,8,["value"])]),_:1}),l(w,{name:"workflowNodeStatus",label:"工作流状态",rules:[{required:!0,message:"请选择工作流状态",trigger:"change"}]},{default:a(()=>[l(y,{value:t.value.workflowNodeStatus,"onUpdate:value":u[4]||(u[4]=b=>t.value.workflowNodeStatus=b)},{default:a(()=>[l(g,null,{default:a(()=>[(m(!0),T(Q,null,se(h(Pe),(b,$)=>(m(),L(S,{key:$,label:h(U)(b.label),value:b.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])}}}),Ul=F({name:"CallbackDetail",__name:"callback-detail",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1}},emits:["update:open"],setup(e,{emit:n}){const i=e,v=n,s=k(!1);X(()=>i.open,o=>{s.value=o},{immediate:!0});const t=()=>{v("update:open",!1)};return(o,p)=>{const r=we,c=ye,d=Se;return m(),L(d,{modelValue:s.value,"onUpdate:modelValue":p[0]||(p[0]=u=>s.value=u),title:"回调详情",width:["500px","90%"],onAfterLeave:t},{default:a(()=>[l(c,{column:1,"label-placement":"left",bordered:"","label-style":{width:"120px"}},{default:a(()=>[l(r,{label:"节点名称"},{default:a(()=>[B(V(o.modelValue.nodeName),1)]),_:1}),l(r,{label:"webhook"},{default:a(()=>{var u;return[B(V((u=o.modelValue.callback)==null?void 0:u.webhook),1)]}),_:1}),l(r,{label:"请求类型"},{default:a(()=>{var u;return[B(V(h(Xe)[(u=o.modelValue.callback)==null?void 0:u.contentType]),1)]}),_:1}),l(r,{label:"密钥"},{default:a(()=>{var u;return[B(V((u=o.modelValue.callback)==null?void 0:u.secret),1)]}),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Ll={class:"node-wrap"},Rl={class:"branch-box"},Ml={class:"condition-node min-h-230px"},Il={class:"condition-node-box pt-0px"},jl={class:"popover"},El={class:"popover-item"},zl={class:"popover-item"},Al=["onClick"],Hl={class:"title"},Ol={class:"text text-#935af6"},Yl={class:"flex items-center"},ql={key:0},Xl={class:"content min-h-81px"},Wl={key:0,class:"placeholder"},Pl={class:"flex justify-between"},Fl={class:"content_label"},Gl={key:1,class:"top-left-cover-line"},Jl={key:2,class:"bottom-left-cover-line"},Kl={key:3,class:"top-right-cover-line"},Zl={key:4,class:"bottom-right-cover-line"},Ql=F({name:"CallbackNode",__name:"callback-node",props:{modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:n}){const i=e,v=n,s=me(),t=k({});X(()=>i.modelValue,M=>{t.value=M},{immediate:!0});const o=(M,I)=>{M.childNode?o(M.childNode,I):M.childNode=I},p=()=>{t.value.childNode&&(t.value.conditionNodes[0].childNode?o(t.value.conditionNodes[0].childNode,t.value.childNode):t.value.conditionNodes[0].childNode=t.value.childNode),ce(()=>{v("update:modelValue",t.value.conditionNodes[0].childNode)})},r=k(0),c=k(!1),d=k(!1),u=k({}),x=M=>{t.value.conditionNodes[r.value]=M,v("update:modelValue",t.value)},w=M=>{s.type===0?(r.value=M,u.value=JSON.parse(JSON.stringify(t.value.conditionNodes[M])),c.value=!0):d.value=!0},f=k(!1),S=k(""),g=k([]),y=(M,I)=>{var Y;if(g.value=[],s.type===2){if((Y=M.jobBatchList)==null||Y.forEach(b=>{var $,D;b.id?($=g.value)==null||$.push(b.id):b.jobId&&(S.value=(D=b.jobId)==null?void 0:D.toString())}),g.value.length===0){d.value=!0;return}f.value=!0}else s.type===1?d.value=!0:w(I)},E=M=>i.disabled?s.type===2?`node-error node-error-${M.taskBatchStatus?J[M.taskBatchStatus].name:"default"}`:"node-error":"auto-judge-def auto-judge-hover";return(M,I)=>{const Y=bt,b=de,$=mt,D=Cl,q=He,W=xt,N=$e,j=Ge,G=Ue,ee=Ee,z=Fe,H=we,A=ye;return m(),T("div",Ll,[_("div",Rl,[(m(!0),T(Q,null,se(t.value.conditionNodes,(R,P)=>(m(),T("div",{key:P,class:"col-box"},[_("div",Ml,[_("div",Il,[l(z,{disabled:h(s).type!==2||!0},{trigger:a(()=>{var ve,Ve;return[_("div",{class:ge(["auto-judge",E(R)]),onClick:Ke=>y(R,P)},[_("div",Hl,[_("span",Ol,[_("span",Yl,[l(q,{processing:"",dot:"",color:R.workflowNodeStatus===1?"#52c41a":"#ff4d4f"},null,8,["color"]),B("  "+V(R.nodeName)+" ",1),R.id?(m(),T("span",ql," ("+V(R.id)+")",1)):C("",!0),l(N,null,{trigger:a(()=>[l(W,{class:"ml-3px text-16px"})]),default:a(()=>[I[7]||(I[7]=B(" 此节点后续将废弃，请使用定时任务中的 HTTP 内置执行器进行替换。 "))]),_:1})])]),M.disabled?C("",!0):(m(),L(j,{key:0,class:"close",onClick:oe(p,["stop"])}))]),_("div",Xl,[(ve=R.callback)!=null&&ve.webhook?C("",!0):(m(),T("div",Wl,V(h(U)("workflow.node.callback.conditionNodes.webhookTip")),1)),(Ve=R.callback)!=null&&Ve.webhook?(m(),T(Q,{key:1},[_("div",Pl,[I[8]||(I[8]=_("span",{class:"content_label"},"Webhook:",-1)),l(G,{class:"w-116px"},{default:a(()=>[B(V(R.callback.webhook),1)]),_:2},1024)]),_("div",null,[_("span",Fl,V(h(U)("workflow.node.callback.conditionNodes.contentType"))+": ",1),B(" "+V(h(Xe)[R.callback.contentType]),1)]),I[9]||(I[9]=_("div",null,".........",-1))],64)):C("",!0)]),h(s).type===2&&R.taskBatchStatus?(m(),L(N,{key:0},{trigger:a(()=>[_("div",{class:"error-tip text-24px",style:ue({color:h(J)[R.taskBatchStatus].color})},[l(ee,{icon:h(J)[R.taskBatchStatus].icon},null,8,["icon"])],4)]),default:a(()=>[B(" "+V(h(J)[R.taskBatchStatus].title),1)]),_:2},1024)):C("",!0)],10,Al)]}),default:a(()=>[_("div",jl,[l(b,{text:""},{default:a(()=>[_("span",El,[l(Y,{class:"mb-3px text-24px font-bold"}),B(" "+V(h(U)("common.retry")),1)])]),_:1}),l($,{vertical:""}),l(b,{text:""},{default:a(()=>[_("span",zl,[l(D,{class:"mb-3px text-24px font-bold"}),I[6]||(I[6]=_("span",null,"忽略",-1))])]),_:1})])]),_:2},1032,["disabled"]),l(fe,{modelValue:R.childNode,"onUpdate:modelValue":ve=>R.childNode=ve,disabled:M.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])])]),R.childNode?_e(M.$slots,"default",{key:0,node:R},void 0,!0):C("",!0),P==0?(m(),T("div",Gl)):C("",!0),P==0?(m(),T("div",Jl)):C("",!0),P==t.value.conditionNodes.length-1?(m(),T("div",Kl)):C("",!0),P==t.value.conditionNodes.length-1?(m(),T("div",Zl)):C("",!0)]))),128))]),t.value.conditionNodes.length>1?(m(),L(fe,{key:0,modelValue:t.value.childNode,"onUpdate:modelValue":I[0]||(I[0]=R=>t.value.childNode=R),disabled:M.disabled},null,8,["modelValue","disabled"])):C("",!0),h(s).type!==0?(m(),L(Ul,{key:1,open:d.value,"onUpdate:open":I[1]||(I[1]=R=>d.value=R),modelValue:t.value.conditionNodes[0],"onUpdate:modelValue":I[2]||(I[2]=R=>t.value.conditionNodes[0]=R)},null,8,["open","modelValue"])):C("",!0),l(Dl,{open:c.value,"onUpdate:open":I[3]||(I[3]=R=>c.value=R),modelValue:u.value,"onUpdate:modelValue":I[4]||(I[4]=R=>u.value=R),onSave:x},null,8,["open","modelValue"]),h(s).type!==0?(m(),L(Je,{key:2,id:S.value,show:f.value,"onUpdate:show":I[5]||(I[5]=R=>f.value=R),ids:g.value},{default:a(()=>[I[10]||(I[10]=_("div",{class:"header-border"},[_("span",{class:"pl-18px"},"回调节点详情")],-1)),l(A,{column:1,bordered:"","label-style":{width:"120px"}},{default:a(()=>[l(H,{label:"节点名称"},{default:a(()=>[B(V(t.value.conditionNodes[0].nodeName),1)]),_:1}),l(H,{label:"webhook"},{default:a(()=>{var R;return[B(V((R=t.value.conditionNodes[0].callback)==null?void 0:R.webhook),1)]}),_:1}),l(H,{label:"请求类型"},{default:a(()=>{var R;return[B(V(h(Xe)[(R=t.value.conditionNodes[0].callback)==null?void 0:R.contentType]),1)]}),_:1}),l(H,{label:"密钥"},{default:a(()=>{var R;return[B(V((R=t.value.conditionNodes[0].callback)==null?void 0:R.secret),1)]}),_:1})]),_:1})]),_:1},8,["id","show","ids"])):C("",!0)])}}}),ea=pe(Ql,[["__scopeId","data-v-39010ff7"]]),ta=F({name:"NodeWrap",__name:"node-wrap",props:{modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["refresh","update:modelValue"],setup(e,{emit:n}){const i=e,v=n,s=k({});return X(()=>i.modelValue,t=>{s.value=t},{immediate:!0}),X(()=>s.value,t=>{v("update:modelValue",t)}),(t,o)=>{const p=oo("NodeWrap",!0);return m(),T(Q,null,[s.value.nodeType==1?(m(),L(Qn,{key:0,modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=r=>s.value=r),disabled:t.disabled,onRefresh:o[1]||(o[1]=()=>v("refresh"))},{default:a(r=>[r.node?(m(),L(p,{key:0,modelValue:r.node.childNode,"onUpdate:modelValue":c=>r.node.childNode=c,disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])):C("",!0)]),_:1},8,["modelValue","disabled"])):C("",!0),s.value.nodeType==2?(m(),L(Sl,{key:1,modelValue:s.value,"onUpdate:modelValue":o[2]||(o[2]=r=>s.value=r),disabled:t.disabled},{default:a(r=>[r.node?(m(),L(p,{key:0,modelValue:r.node.childNode,"onUpdate:modelValue":c=>r.node.childNode=c,disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])):C("",!0)]),_:1},8,["modelValue","disabled"])):C("",!0),s.value.nodeType==3?(m(),L(ea,{key:2,modelValue:s.value,"onUpdate:modelValue":o[3]||(o[3]=r=>s.value=r),disabled:t.disabled},{default:a(r=>[r.node?(m(),L(p,{key:0,modelValue:r.node.childNode,"onUpdate:modelValue":c=>r.node.childNode=c,disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])):C("",!0)]),_:1},8,["modelValue","disabled"])):C("",!0),s.value.childNode?(m(),L(p,{key:3,modelValue:s.value.childNode,"onUpdate:modelValue":o[4]||(o[4]=r=>s.value.childNode=r),disabled:t.disabled},null,8,["modelValue","disabled"])):C("",!0)],64)}}}),oa=F({name:"StartDetail",__name:"start-detail",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1}},emits:["update:open"],setup(e,{emit:n}){const i=e,v=n,s=k(!1);X(()=>i.open,o=>{s.value=o},{immediate:!0});const t=()=>{v("update:open",!1)};return(o,p)=>{const r=we,c=ye,d=Se;return m(),L(d,{modelValue:s.value,"onUpdate:modelValue":p[0]||(p[0]=u=>s.value=u),title:"工作流详情",width:["500px","90%"],onAfterLeave:t},{default:a(()=>[l(c,{column:1,"label-placement":"left",bordered:"","label-style":{width:"120px"}},{default:a(()=>[l(r,{label:"工作流名称"},{default:a(()=>[B(V(o.modelValue.workflowName),1)]),_:1}),l(r,{label:"组名称"},{default:a(()=>[B(V(o.modelValue.groupName),1)]),_:1}),l(r,{label:"触发类型"},{default:a(()=>[B(V(h(U)(h(no)[o.modelValue.triggerType])),1)]),_:1}),l(r,{label:"触发间隔"},{default:a(()=>[B(V(o.modelValue.triggerInterval)+" "+V(o.modelValue.triggerType===2?"秒":null),1)]),_:1}),l(r,{label:"执行超时时间"},{default:a(()=>[B(V(o.modelValue.executorTimeout)+" 秒",1)]),_:1}),l(r,{label:"阻塞策略"},{default:a(()=>[B(V(h(U)(h(ht)[o.modelValue.blockStrategy])),1)]),_:1}),l(r,{label:"工作流上下文"},{default:a(()=>[B(V(o.modelValue.wfContext),1)]),_:1}),l(r,{label:"工作流状态"},{default:a(()=>[B(V(h(U)(h(ut)[o.modelValue.workflowStatus])),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),na=F({name:"StartDrawer",__name:"start-drawer",props:{modelValue:{default:()=>({wfContexts:[]})},open:{type:Boolean,default:!1}},emits:["update:open","save"],setup(e,{emit:n}){const i=e,v=n,s=me();let t="";const o=k(!1),p=k({wfContexts:[]}),r=k([]);X(()=>i.open,S=>{o.value=S},{immediate:!0}),X(()=>i.modelValue,S=>{p.value=S,S.triggerType===2&&(p.value.triggerInterval=Number(S.triggerInterval)),S.workflowName?t=S.workflowName:S.groupName?t=S.groupName:t="请选择组",S.wfContext&&(p.value.wfContext=JSON.parse(S.wfContext),p.value.wfContexts=lo(S.wfContext))},{immediate:!0});const c=k(),d=()=>{v("update:open",!1),o.value=!1},u=()=>{var S;(S=c.value)==null||S.validate(g=>{g||(p.value.wfContext=JSON.stringify(io(p.value.wfContexts)||{}),d(),v("save",p.value))}).catch(()=>{var g;return(g=window.$message)==null?void 0:g.warning("请检查表单信息")})};(async()=>{const{data:S,error:g}=await Bo();g||(r.value=S)})();const w=S=>{S===3?p.value.triggerInterval="* * * * * ?":S===2&&(p.value.triggerInterval=60)},f={groupName:{required:!0,message:"请选择组"},triggerType:{required:!0,message:"请选择触发类型"},triggerInterval:{required:!0,message:"请输入触发间隔"},executorTimeout:{required:!0,message:"请输入执行超时时间"},blockStrategy:{required:!0,message:"请选择阻塞策略"},workflowStatus:{required:!0,message:"请选择工作流状态"}};return(S,g)=>{const y=xe,E=Le,M=gt,I=ft,Y=_t,b=Ae,$=Re,D=ze,q=$t,W=De,N=Me,j=de,G=Ie,ee=je;return m(),L(ee,{show:o.value,"onUpdate:show":g[10]||(g[10]=z=>o.value=z),"display-directive":"if",width:610,onAfterLeave:d},{default:a(()=>[l(G,{title:h(t)},{header:a(()=>[l(Oe,{modelValue:p.value.workflowName,"onUpdate:modelValue":g[0]||(g[0]=z=>p.value.workflowName=z),class:"max-w-570px min-w-570px"},null,8,["modelValue"])]),footer:a(()=>[l(j,{type:"primary",onClick:u},{default:a(()=>g[13]||(g[13]=[B("保存")])),_:1}),l(j,{class:"ml-12px",onClick:d},{default:a(()=>g[14]||(g[14]=[B("取消")])),_:1})]),default:a(()=>[l(N,{ref_key:"formRef",ref:c,model:p.value,rules:f,"label-align":"left","label-width":"100px"},{default:a(()=>[l(E,{path:"groupName",label:"组名称"},{default:a(()=>[l(y,{value:p.value.groupName,"onUpdate:value":g[1]||(g[1]=z=>p.value.groupName=z),placeholder:"请选择组",disabled:h(s).type===0&&h(Ne)(h(s).id),options:r.value.map(z=>({label:z,value:z}))},null,8,["value","disabled","options"])]),_:1}),l(Y,{cols:24,"x-gap":"20"},{default:a(()=>[l(M,{span:8},{default:a(()=>[l(E,{path:"triggerType",label:"触发类型"},{default:a(()=>[l(y,{value:p.value.triggerType,"onUpdate:value":[g[2]||(g[2]=z=>p.value.triggerType=z),w],placeholder:"请选择触发类型",options:h(ao).map(z=>({label:h(U)(z.label),value:z.value}))},null,8,["value","options"])]),_:1})]),_:1}),l(M,{span:16},{default:a(()=>[l(E,{path:"triggerInterval",label:"触发间隔"},{default:a(()=>[p.value.triggerType===3?(m(),L(h(Vo),{key:0,modelValue:p.value.triggerInterval,"onUpdate:modelValue":g[3]||(g[3]=z=>p.value.triggerInterval=z),placeholder:"请输入Cron表达式"},null,8,["modelValue"])):(m(),L(I,{key:1,value:p.value.triggerInterval,"onUpdate:value":g[4]||(g[4]=z=>p.value.triggerInterval=z),min:1,class:"w-full",placeholder:"请输入触发间隔"},{suffix:a(()=>g[11]||(g[11]=[B("秒")])),_:1},8,["value"]))]),_:1})]),_:1})]),_:1}),l(Y,{cols:24,"x-gap":"20"},{default:a(()=>[l(M,{span:8},{default:a(()=>[l(E,{path:"executorTimeout",label:"执行超时时间"},{default:a(()=>[l(I,{value:p.value.executorTimeout,"onUpdate:value":g[5]||(g[5]=z=>p.value.executorTimeout=z),placeholder:"请输入超时时间",min:1},{suffix:a(()=>g[12]||(g[12]=[B("秒")])),_:1},8,["value"])]),_:1})]),_:1}),l(M,{span:16},{default:a(()=>[l(E,{path:"blockStrategy",label:"阻塞策略"},{default:a(()=>[l(D,{value:p.value.blockStrategy,"onUpdate:value":g[6]||(g[6]=z=>p.value.blockStrategy=z)},{default:a(()=>[l($,null,{default:a(()=>[(m(!0),T(Q,null,se(h(so),(z,H)=>(m(),L(b,{key:H,label:h(U)(z.label),value:z.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),l(E,{path:"wfContext",label:"工作流上下文","show-feedback":!1},{default:a(()=>[l(q,{value:p.value.wfContexts,"onUpdate:value":g[7]||(g[7]=z=>p.value.wfContexts=z),path:"wfContexts"},null,8,["value"])]),_:1}),l(E,{path:"workflowStatus",label:"节点状态"},{default:a(()=>[l(D,{value:p.value.workflowStatus,"onUpdate:value":g[8]||(g[8]=z=>p.value.workflowStatus=z)},{default:a(()=>[l($,null,{default:a(()=>[(m(!0),T(Q,null,se(h(Pe),(z,H)=>(m(),L(b,{key:H,label:h(U)(z.label),value:z.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1}),l(E,{path:"description",label:"描述"},{default:a(()=>[l(W,{value:p.value.description,"onUpdate:value":g[9]||(g[9]=z=>p.value.description=z),type:"textarea",autosize:{minRows:5},placeholder:"请输入描述"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),la={class:"node-wrap"},aa={class:"title"},sa={class:"text"},ia={class:"text-#ff943e"},da={key:0,class:"content"},ra={key:1,class:"content min-h-85px"},ua=F({name:"StartNode",__name:"start-node",props:{modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:n}){const i=e,v=n,s=me(),t=k({}),o=k({});X(()=>i.modelValue,u=>{o.value=u},{immediate:!0}),X(()=>o.value,u=>{v("update:modelValue",u)}),X(()=>{var u;return(u=o.value)==null?void 0:u.groupName},u=>{u&&s.setJobList(u)},{immediate:!0});const p=k(!1),r=k(!1),c=u=>{o.value=u},d=()=>{s.type===0?(t.value=JSON.parse(JSON.stringify(o.value)),p.value=!0):r.value=!0};return(u,x)=>{const w=He,f=Ue,S=Ee,g=$e;return m(),T("div",la,[_("div",{class:ge([`${u.disabled?"start-node-disabled":"node-wrap-box-hover"} ${h(s).type===2?"node-error-success":""}`,"node-wrap-box start-node"]),onClick:d},[_("div",aa,[_("span",sa,[l(w,{dot:"",color:o.value.workflowStatus===1?"#52c41a":"#ff000d"},null,8,["color"]),_("span",ia,"  "+V(o.value.workflowName?`${o.value.workflowName} ${o.value.id?` (${o.value.id})`:""}`:"请选择组"),1)])]),o.value.groupName?(m(),T("div",da,[_("div",null,[x[5]||(x[5]=_("span",{class:"content_label"},"组名称: ",-1)),l(f,{class:"max-w-132px"},{default:a(()=>[B(V(o.value.groupName),1)]),_:1})]),_("div",null,[x[6]||(x[6]=_("span",{class:"content_label"},"阻塞策略: ",-1)),B(" "+V(h(U)(h(ht)[o.value.blockStrategy])),1)]),x[7]||(x[7]=_("div",null,".........",-1))])):(m(),T("div",ra,x[8]||(x[8]=[_("span",{class:"placeholder"},"请配置工作流",-1)]))),h(s).type===2?(m(),L(g,{key:2},{trigger:a(()=>[_("div",{class:"error-tip text-24px",style:ue({color:h(J)[3].color})},[l(S,{icon:h(J)[3].icon},null,8,["icon"])],4)]),default:a(()=>[B(" "+V(h(J)[3].title),1)]),_:1})):C("",!0)],2),l(fe,{modelValue:o.value.nodeConfig,"onUpdate:modelValue":x[0]||(x[0]=y=>o.value.nodeConfig=y),disabled:u.disabled},null,8,["modelValue","disabled"]),h(s).type!==0?(m(),L(oa,{key:0,open:r.value,"onUpdate:open":x[1]||(x[1]=y=>r.value=y),modelValue:o.value,"onUpdate:modelValue":x[2]||(x[2]=y=>o.value=y)},null,8,["open","modelValue"])):C("",!0),l(na,{open:p.value,"onUpdate:open":x[3]||(x[3]=y=>p.value=y),modelValue:t.value,"onUpdate:modelValue":x[4]||(x[4]=y=>t.value=y),onSave:c},null,8,["open","modelValue"])])}}}),ca=pe(ua,[["__scopeId","data-v-e0e4d99d"]]),pa={class:"workflow"},ma={class:"workflow-affix"},fa={class:"header"},va={class:"ml-8px mr-8px text-18px text-#333639 dark:text-#d6d6d6"},ha={key:0,class:"buttons"},ba={key:1,class:"buttons"},ga={class:"workflow-body"},_a={class:"box-scale"},wa={class:"end-node"},ya={class:"end-node-text"},Ra=F({name:"SnailWorkflow",__name:"workflow",props:{modelValue:{default:()=>({})},spinning:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","save","cancel","refresh"],setup(e,{emit:n}){const i=e,v=n,s=ct(),t=k(100),o=k({}),p=async()=>{v("save")},r=()=>{v("cancel")};X(()=>i.modelValue,w=>{o.value=w},{immediate:!0}),X(()=>o.value,w=>{v("update:modelValue",w)});const c=w=>{if(t.value+=10*w,w>0){const f=document.querySelector(".workflow-body");f&&(t.value<=160&&f.scrollTo({left:280*t.value/100,behavior:"smooth"}),t.value>160&&f.scrollTo({left:420*t.value/100,behavior:"smooth"}),t.value>200&&f.scrollTo({left:520*t.value/100,behavior:"smooth"}))}t.value<=10?t.value=10:t.value>=300&&(t.value=300)},d=w=>{w.preventDefault(),w.wheelDelta<0?c(-1):c(1)};Te(()=>{const w=document.querySelector(".workflow");w&&(w.onwheel=f=>d(f))});const u=()=>{const w=document.querySelector(".workflow-design");w&&w.setAttribute("style",`cursor: grabbing; transform: scale(${t.value/100})`)},x=()=>{const w=document.querySelector(".workflow-design");w&&w.setAttribute("style",`cursor: grab; transform: scale(${t.value/100})`)};return(w,f)=>{const S=Wo,g=de,y=$e,E=wt,M=Ro,I=pt;return m(),T("div",pa,[_("div",ma,[l(M,{"trigger-top":0,class:"position-sticky z-2"},{default:a(()=>[_("div",fa,[_("div",null,[l(y,null,{trigger:a(()=>[l(g,{size:"small",strong:"",circle:"",onClick:f[0]||(f[0]=Y=>c(-1))},{default:a(()=>[l(S)]),_:1})]),default:a(()=>[f[5]||(f[5]=B(" 缩小 "))]),_:1}),_("span",va,V(t.value)+"%",1),l(y,null,{trigger:a(()=>[l(g,{size:"small",strong:"",circle:"",onClick:f[1]||(f[1]=Y=>c(1))},{default:a(()=>[l(E)]),_:1})]),default:a(()=>[f[6]||(f[6]=B(" 放大 "))]),_:1})]),w.disabled?C("",!0):(m(),T("div",ha,[l(g,{type:"info",onClick:p},{default:a(()=>f[7]||(f[7]=[B("保存")])),_:1}),l(g,{class:"ml-16px",onClick:r},{default:a(()=>f[8]||(f[8]=[B("取消")])),_:1})])),w.disabled&&h(s).buttons?(m(),T("div",ba,[_e(w.$slots,"buttons")])):C("",!0)])]),_:3}),l(I,{show:w.spinning},{default:a(()=>[_("div",ga,[l(h(yt),{class:"vue-drag","is-draggable":!0,"is-resizable":!1,z:1,onDragging:u,onDragstop:x},{default:a(()=>[_("div",{class:"workflow-design",style:ue(`transform: scale(${t.value/100})`)},[_("div",_a,[l(ca,{modelValue:o.value,"onUpdate:modelValue":f[2]||(f[2]=Y=>o.value=Y),disabled:w.disabled},null,8,["modelValue","disabled"]),o.value.nodeConfig?(m(),L(ta,{key:0,modelValue:o.value.nodeConfig,"onUpdate:modelValue":f[3]||(f[3]=Y=>o.value.nodeConfig=Y),disabled:w.disabled,onRefresh:f[4]||(f[4]=()=>v("refresh"))},null,8,["modelValue","disabled"])):C("",!0),_("div",wa,[f[9]||(f[9]=_("div",{class:"end-node-circle"},null,-1)),_("div",ya,V(h(U)("workflow.node.endNode")),1)])])],4)]),_:1})])]),_:1},8,["show"])])])}}});export{Ra as _,me as u};
