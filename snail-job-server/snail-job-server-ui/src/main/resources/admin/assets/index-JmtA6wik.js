import{d as k,k as _,c1 as h,r as u,i as y,q as S,cA as $,c as x,o as B,h as C,cB as J,$ as r}from"./index-DszOiTqy.js";import{u as O,_ as I}from"./workflow.vue_vue_type_style_index_0_lang-C4ENNJsT.js";import{h as R,i as T}from"./workflow-Cv1bSPMZ.js";import"./job-task-list-table.vue_vue_type_script_setup_true_lang-CXQFTYju.js";import"./table-CFZNYiHm.js";import"./Grid-DRtX9b3J.js";import"./job-C7tym23E.js";import"./detail-drawer-C9rZTAe5.js";import"./DescriptionsItem-CAGm-guL.js";import"./log-drawer-8m3MM8ed.js";import"./CollapseItem-Bt1g2lFv.js";import"./dynamic-input.vue_vue_type_script_setup_true_lang-DblGJAZk.js";import"./DynamicInput-BpjQPmr6.js";import"./code-mirror-D67swqKe.js";import"./cron-input.vue_vue_type_style_index_0_lang-Bk__aEhb.js";import"./notify-2iuonMav.js";import"./group-BF221ykj.js";const Q=k({name:"workflow_form_edit",__name:"index",setup(V){const i=O(),f=_(),m=h(),c=u(!1),p=String(f.query.id);let l={};const t=u({}),d=async()=>{c.value=!0;const{data:o,error:e}=await R(p);e||(t.value=o,l=J(o)),c.value=!1},a=u(!1);y(()=>{i.clear(),i.setType(0),i.setId(p),d()}),S(()=>t.value,o=>{a.value=v(o,l)},{deep:!0});const w=async()=>{var e;const{error:o}=await T(t.value);o||((e=window.$message)==null||e.info(r("common.updateSuccess")),Object.assign(l,t.value),a.value=!1,m.push({path:"/workflow/task"}))};function v(o,e){const n=JSON.stringify(o),s=JSON.stringify({...o,...e});return n!==s}const g=()=>{m.push("/workflow/task")};return $((o,e,n)=>{var s;a.value?(s=window.$dialog)==null||s.warning({title:r("common.warning"),content:"有未保存的数据，是否确认离开？",positiveText:r("common.confirm"),negativeText:r("common.cancel"),onPositiveClick:()=>{n()}}):n()}),(o,e)=>(B(),x(C(I),{modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=n=>t.value=n),spinning:c.value,updated:a.value,onSave:w,onCancel:g},null,8,["modelValue","spinning","updated"]))}});export{Q as default};
