import{b0 as ee,br as te,d as X,b1 as qe,cy as pt,r as x,a as ne,i as Ye,bz as Kt,ak as q,cz as Zt,q as J,ao as ve,b5 as be,bq as K,cA as Qt,cB as eo,bw as Se,cC as to,cD as oo,aX as Dt,b_ as kt,b4 as He,cE as no,cF as mt,bx as ao,b7 as It,cG as lo,O as so,bJ as io,cs as rt,cH as ro,bO as Nt,bQ as Rt,cI as uo,aW as co,aY as po,aZ as mo,cJ as fo,bF as ho,bG as ft,D as ye,cK as vo,b6 as _o,b2 as go,B as ae,b8 as Ie,b9 as $t,cL as xt,cM as bo,cN as lt,cO as st,cP as yo,bb as it,o as m,b as L,e as w,bl as Ce,v as he,a3 as se,a1 as ue,x as Ve,s as re,l as _e,cQ as wo,c as M,w as a,g as B,t as D,f as n,cR as Fe,h,cS as ko,cT as ht,aa as Be,E as We,H as Xe,I as Ge,bo as me,bp as fe,$ as j,cU as Ut,cV as Lt,Z as No,a0 as dt,bj as Mt,bk as $o,ai as T,av as xo,cW as Ue,Y as Ae,cX as oe,cY as St,cZ as Vt,c_ as Ct,a4 as So,c$ as Vo,au as jt,aw as Co,F as Bo,d0 as Le,d1 as Me,G as vt,d2 as To,at as zt,_ as Je,a8 as je,C as Re,aG as Et,d3 as Do,d4 as At,d5 as Io,d6 as ut,d7 as Ro,aK as Uo,aL as Pt,d8 as Lo,d9 as Mo,aD as jo,da as zo}from"./index-D11HRvLC.js";import{h as Eo,i as Ao,j as Po,k as Oo}from"./workflow-B_Ogzjxw.js";import{h as qo,i as Yo,j as Ho}from"./job-DWJU1EVy.js";import{A as Fo,_ as Ke,a as Ze,h as Wo,d as Ot,c as qt}from"./Grid-BEQeOJ6_.js";import{_ as Te,a as De}from"./DescriptionsItem-QSQ4JSXU.js";import{_ as Xo}from"./log-drawer-Dqe3cuCl.js";import{H as Go,j as Jo,c as Ko,_ as Zo}from"./job-task-list-table.vue_vue_type_script_setup_true_lang-DFSIKcqE.js";import{_ as Qo}from"./table-oGN68_Ra.js";import{_ as en,s as tn,j as on,o as nn}from"./code-mirror.vue_vue_type_script_setup_true_lang--sv6Sl5J.js";import{_ as an}from"./cron-input.vue_vue_type_style_index_0_lang-CQfeC2zV.js";import{e as ln}from"./group-DBuDE6uz.js";function sn(e){return typeof e=="string"?document.querySelector(e):typeof e=="function"?e():e}function rn(e){return e instanceof HTMLElement?e.scrollTop:window.scrollY}function dn(e){return e instanceof HTMLElement?e.getBoundingClientRect():{top:0,bottom:window.innerHeight}}const un=ee("affix",[te("affixed",{position:"fixed"},[te("absolute-positioned",{position:"absolute"})])]),cn={listenTo:[String,Object,Function],top:Number,bottom:Number,triggerTop:Number,triggerBottom:Number,position:{type:String,default:"fixed"},offsetTop:{type:Number,validator:()=>!0,default:void 0},offsetBottom:{type:Number,validator:()=>!0,default:void 0},target:{type:Function,validator:()=>!0,default:void 0}},pn=X({name:"Affix",props:cn,setup(e){const{mergedClsPrefixRef:l}=qe(e);pt("-affix",un,l);let i=null;const u=x(!1),s=x(!1),t=x(null),o=x(null),c=ne(()=>s.value||u.value),r=ne(()=>{var y,k;return(k=(y=e.triggerTop)!==null&&y!==void 0?y:e.offsetTop)!==null&&k!==void 0?k:e.top}),f=ne(()=>{var y,k;return(k=(y=e.top)!==null&&y!==void 0?y:e.triggerTop)!==null&&k!==void 0?k:e.offsetTop}),p=ne(()=>{var y,k;return(k=(y=e.bottom)!==null&&y!==void 0?y:e.triggerBottom)!==null&&k!==void 0?k:e.offsetBottom}),d=ne(()=>{var y,k;return(k=(y=e.triggerBottom)!==null&&y!==void 0?y:e.offsetBottom)!==null&&k!==void 0?k:e.bottom}),v=x(null),g=()=>{const{target:y,listenTo:k}=e;y?i=y():k?i=sn(k):i=document,i&&(i.addEventListener("scroll",b),b())};function b(){Zt(I)}function I(){const{value:y}=v;if(!i||!y)return;const k=rn(i);if(c.value){o.value!==null&&k<o.value&&(u.value=!1,o.value=null),t.value!==null&&k>t.value&&(s.value=!1,t.value=null);return}const R=dn(i),z=y.getBoundingClientRect(),U=z.top-R.top,F=R.bottom-z.bottom,$=r.value,O=d.value;$!==void 0&&U<=$?(u.value=!0,o.value=k-($-U)):(u.value=!1,o.value=null),O!==void 0&&F<=O?(s.value=!0,t.value=k+O-F):(s.value=!1,t.value=null)}return Ye(()=>{g()}),Kt(()=>{i&&i.removeEventListener("scroll",b)}),{selfRef:v,affixed:c,mergedClsPrefix:l,mergedstyle:ne(()=>{const y={};return u.value&&r.value!==void 0&&f.value!==void 0&&(y.top=`${f.value}px`),s.value&&d.value!==void 0&&p.value!==void 0&&(y.bottom=`${p.value}px`),y})}},render(){const{mergedClsPrefix:e}=this;return q("div",{ref:"selfRef",class:[`${e}-affix`,{[`${e}-affix--affixed`]:this.affixed,[`${e}-affix--absolute-positioned`]:this.position==="absolute"}],style:this.mergedstyle},this.$slots)}}),mn=X({name:"ArrowUp",render(){return q("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},q("g",{fill:"none"},q("path",{d:"M3.13 9.163a.5.5 0 1 0 .74.674L9.5 3.67V17.5a.5.5 0 0 0 1 0V3.672l5.63 6.165a.5.5 0 0 0 .738-.674l-6.315-6.916a.746.746 0 0 0-.632-.24a.746.746 0 0 0-.476.24L3.131 9.163z",fill:"currentColor"})))}}),Bt=X({name:"SlotMachineNumber",props:{clsPrefix:{type:String,required:!0},value:{type:[Number,String],required:!0},oldOriginalNumber:{type:Number,default:void 0},newOriginalNumber:{type:Number,default:void 0}},setup(e){const l=x(null),i=x(e.value),u=x(e.value),s=x("up"),t=x(!1),o=ne(()=>t.value?`${e.clsPrefix}-base-slot-machine-current-number--${s.value}-scroll`:null),c=ne(()=>t.value?`${e.clsPrefix}-base-slot-machine-old-number--${s.value}-scroll`:null);J(be(e,"value"),(p,d)=>{i.value=d,u.value=p,ve(r)});function r(){const p=e.newOriginalNumber,d=e.oldOriginalNumber;d===void 0||p===void 0||(p>d?f("up"):d>p&&f("down"))}function f(p){s.value=p,t.value=!1,ve(()=>{var d;(d=l.value)===null||d===void 0||d.offsetWidth,t.value=!0})}return()=>{const{clsPrefix:p}=e;return q("span",{ref:l,class:`${p}-base-slot-machine-number`},i.value!==null?q("span",{class:[`${p}-base-slot-machine-old-number ${p}-base-slot-machine-old-number--top`,c.value]},i.value):null,q("span",{class:[`${p}-base-slot-machine-current-number`,o.value]},q("span",{ref:"numberWrapper",class:[`${p}-base-slot-machine-current-number__inner`,typeof e.value!="number"&&`${p}-base-slot-machine-current-number__inner--not-number`]},u.value)),i.value!==null?q("span",{class:[`${p}-base-slot-machine-old-number ${p}-base-slot-machine-old-number--bottom`,c.value]},i.value):null)}}}),{cubicBezierEaseOut:Ne}=Qt;function fn({duration:e=".2s"}={}){return[K("&.fade-up-width-expand-transition-leave-active",{transition:`
 opacity ${e} ${Ne},
 max-width ${e} ${Ne},
 transform ${e} ${Ne}
 `}),K("&.fade-up-width-expand-transition-enter-active",{transition:`
 opacity ${e} ${Ne},
 max-width ${e} ${Ne},
 transform ${e} ${Ne}
 `}),K("&.fade-up-width-expand-transition-enter-to",{opacity:1,transform:"translateX(0) translateY(0)"}),K("&.fade-up-width-expand-transition-enter-from",{maxWidth:"0 !important",opacity:0,transform:"translateY(60%)"}),K("&.fade-up-width-expand-transition-leave-from",{opacity:1,transform:"translateY(0)"}),K("&.fade-up-width-expand-transition-leave-to",{maxWidth:"0 !important",opacity:0,transform:"translateY(60%)"})]}const hn=K([K("@keyframes n-base-slot-machine-fade-up-in",`
 from {
 transform: translateY(60%);
 opacity: 0;
 }
 to {
 transform: translateY(0);
 opacity: 1;
 }
 `),K("@keyframes n-base-slot-machine-fade-down-in",`
 from {
 transform: translateY(-60%);
 opacity: 0;
 }
 to {
 transform: translateY(0);
 opacity: 1;
 }
 `),K("@keyframes n-base-slot-machine-fade-up-out",`
 from {
 transform: translateY(0%);
 opacity: 1;
 }
 to {
 transform: translateY(-60%);
 opacity: 0;
 }
 `),K("@keyframes n-base-slot-machine-fade-down-out",`
 from {
 transform: translateY(0%);
 opacity: 1;
 }
 to {
 transform: translateY(60%);
 opacity: 0;
 }
 `),ee("base-slot-machine",`
 overflow: hidden;
 white-space: nowrap;
 display: inline-block;
 height: 18px;
 line-height: 18px;
 `,[ee("base-slot-machine-number",`
 display: inline-block;
 position: relative;
 height: 18px;
 width: .6em;
 max-width: .6em;
 `,[fn({duration:".2s"}),eo({duration:".2s",delay:"0s"}),ee("base-slot-machine-old-number",`
 display: inline-block;
 opacity: 0;
 position: absolute;
 left: 0;
 right: 0;
 `,[te("top",{transform:"translateY(-100%)"}),te("bottom",{transform:"translateY(100%)"}),te("down-scroll",{animation:"n-base-slot-machine-fade-down-out .2s cubic-bezier(0, 0, .2, 1)",animationIterationCount:1}),te("up-scroll",{animation:"n-base-slot-machine-fade-up-out .2s cubic-bezier(0, 0, .2, 1)",animationIterationCount:1})]),ee("base-slot-machine-current-number",`
 display: inline-block;
 position: absolute;
 left: 0;
 top: 0;
 bottom: 0;
 right: 0;
 opacity: 1;
 transform: translateY(0);
 width: .6em;
 `,[te("down-scroll",{animation:"n-base-slot-machine-fade-down-in .2s cubic-bezier(0, 0, .2, 1)",animationIterationCount:1}),te("up-scroll",{animation:"n-base-slot-machine-fade-up-in .2s cubic-bezier(0, 0, .2, 1)",animationIterationCount:1}),Se("inner",`
 display: inline-block;
 position: absolute;
 right: 0;
 top: 0;
 width: .6em;
 `,[te("not-number",`
 right: unset;
 left: 0;
 `)])])])])]),vn=X({name:"BaseSlotMachine",props:{clsPrefix:{type:String,required:!0},value:{type:[Number,String],default:0},max:{type:Number,default:void 0},appeared:{type:Boolean,required:!0}},setup(e){pt("-base-slot-machine",hn,be(e,"clsPrefix"));const l=x(),i=x(),u=ne(()=>{if(typeof e.value=="string")return[];if(e.value<1)return[0];const s=[];let t=e.value;for(e.max!==void 0&&(t=Math.min(e.max,t));t>=1;)s.push(t%10),t/=10,t=Math.floor(t);return s.reverse(),s});return J(be(e,"value"),(s,t)=>{typeof s=="string"?(i.value=void 0,l.value=void 0):typeof t=="string"?(i.value=s,l.value=void 0):(i.value=s,l.value=t)}),()=>{const{value:s,clsPrefix:t}=e;return typeof s=="number"?q("span",{class:`${t}-base-slot-machine`},q(oo,{name:"fade-up-width-expand-transition",tag:"span"},{default:()=>u.value.map((o,c)=>q(Bt,{clsPrefix:t,key:u.value.length-c-1,oldOriginalNumber:l.value,newOriginalNumber:i.value,value:o}))}),q(to,{key:"+",width:!0},{default:()=>e.max!==void 0&&e.max<s?q(Bt,{clsPrefix:t,value:"+"}):null})):q("span",{class:`${t}-base-slot-machine`},s)}}}),_n=e=>{const{errorColor:l,infoColor:i,successColor:u,warningColor:s,fontFamily:t}=e;return{color:l,colorInfo:i,colorSuccess:u,colorError:l,colorWarning:s,fontSize:"12px",fontFamily:t}},gn={name:"Badge",common:Dt,self:_n},bn=K([K("@keyframes badge-wave-spread",{from:{boxShadow:"0 0 0.5px 0px var(--n-ripple-color)",opacity:.6},to:{boxShadow:"0 0 0.5px 4.5px var(--n-ripple-color)",opacity:0}}),ee("badge",`
 display: inline-flex;
 position: relative;
 vertical-align: middle;
 font-family: var(--n-font-family);
 `,[te("as-is",[ee("badge-sup",{position:"static",transform:"translateX(0)"},[kt({transformOrigin:"left bottom",originalTransform:"translateX(0)"})])]),te("dot",[ee("badge-sup",`
 height: 8px;
 width: 8px;
 padding: 0;
 min-width: 8px;
 left: 100%;
 bottom: calc(100% - 4px);
 `,[K("::before","border-radius: 4px;")])]),ee("badge-sup",`
 background: var(--n-color);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 color: #FFF;
 position: absolute;
 height: 18px;
 line-height: 18px;
 border-radius: 9px;
 padding: 0 6px;
 text-align: center;
 font-size: var(--n-font-size);
 transform: translateX(-50%);
 left: 100%;
 bottom: calc(100% - 9px);
 font-variant-numeric: tabular-nums;
 z-index: 1;
 display: flex;
 align-items: center;
 `,[kt({transformOrigin:"left bottom",originalTransform:"translateX(-50%)"}),ee("base-wave",{zIndex:1,animationDuration:"2s",animationIterationCount:"infinite",animationDelay:"1s",animationTimingFunction:"var(--n-ripple-bezier)",animationName:"badge-wave-spread"}),K("&::before",`
 opacity: 0;
 transform: scale(1);
 border-radius: 9px;
 content: "";
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `)])])]),yn=Object.assign(Object.assign({},He.props),{value:[String,Number],max:Number,dot:Boolean,type:{type:String,default:"default"},show:{type:Boolean,default:!0},showZero:Boolean,processing:Boolean,color:String,offset:Array}),Qe=X({name:"Badge",props:yn,setup(e,{slots:l}){const{mergedClsPrefixRef:i,inlineThemeDisabled:u,mergedRtlRef:s}=qe(e),t=He("Badge","-badge",bn,gn,e,i),o=x(!1),c=()=>{o.value=!0},r=()=>{o.value=!1},f=ne(()=>e.show&&(e.dot||e.value!==void 0&&!(!e.showZero&&Number(e.value)<=0)||!no(l.value)));Ye(()=>{f.value&&(o.value=!0)});const p=mt("Badge",s,i),d=ne(()=>{const{type:b,color:I}=e,{common:{cubicBezierEaseInOut:y,cubicBezierEaseOut:k},self:{[ao("color",b)]:R,fontFamily:z,fontSize:U}}=t.value;return{"--n-font-size":U,"--n-font-family":z,"--n-color":I||R,"--n-ripple-color":I||R,"--n-bezier":y,"--n-ripple-bezier":k}}),v=u?It("badge",ne(()=>{let b="";const{type:I,color:y}=e;return I&&(b+=I[0]),y&&(b+=lo(y)),b}),d,e):void 0,g=ne(()=>{const{offset:b}=e;if(!b)return;const[I,y]=b,k=typeof I=="number"?`${I}px`:I,R=typeof y=="number"?`${y}px`:y;return{transform:`translate(calc(${p!=null&&p.value?"50%":"-50%"} + ${k}), ${R})`}});return{rtlEnabled:p,mergedClsPrefix:i,appeared:o,showBadge:f,handleAfterEnter:c,handleAfterLeave:r,cssVars:u?void 0:d,themeClass:v==null?void 0:v.themeClass,onRender:v==null?void 0:v.onRender,offsetStyle:g}},render(){var e;const{mergedClsPrefix:l,onRender:i,themeClass:u,$slots:s}=this;i==null||i();const t=(e=s.default)===null||e===void 0?void 0:e.call(s);return q("div",{class:[`${l}-badge`,this.rtlEnabled&&`${l}-badge--rtl`,u,{[`${l}-badge--dot`]:this.dot,[`${l}-badge--as-is`]:!t}],style:this.cssVars},t,q(so,{name:"fade-in-scale-up-transition",onAfterEnter:this.handleAfterEnter,onAfterLeave:this.handleAfterLeave},{default:()=>this.showBadge?q("sup",{class:`${l}-badge-sup`,title:io(this.value),style:this.offsetStyle},rt(s.value,()=>[this.dot?null:q(vn,{clsPrefix:l,appeared:this.appeared,max:this.max,value:this.value})]),this.processing?q(ro,{clsPrefix:l}):null):null}))}}),Z="0!important",Yt="-1px!important";function $e(e){return te(e+"-type",[K("& +",[ee("button",{},[te(e+"-type",[Se("border",{borderLeftWidth:Z}),Se("state-border",{left:Yt})])])])])}function xe(e){return te(e+"-type",[K("& +",[ee("button",[te(e+"-type",[Se("border",{borderTopWidth:Z}),Se("state-border",{top:Yt})])])])])}const wn=ee("button-group",`
 flex-wrap: nowrap;
 display: inline-flex;
 position: relative;
`,[Nt("vertical",{flexDirection:"row"},[Nt("rtl",[ee("button",[K("&:first-child:not(:last-child)",`
 margin-right: ${Z};
 border-top-right-radius: ${Z};
 border-bottom-right-radius: ${Z};
 `),K("&:last-child:not(:first-child)",`
 margin-left: ${Z};
 border-top-left-radius: ${Z};
 border-bottom-left-radius: ${Z};
 `),K("&:not(:first-child):not(:last-child)",`
 margin-left: ${Z};
 margin-right: ${Z};
 border-radius: ${Z};
 `),$e("default"),te("ghost",[$e("primary"),$e("info"),$e("success"),$e("warning"),$e("error")])])])]),te("vertical",{flexDirection:"column"},[ee("button",[K("&:first-child:not(:last-child)",`
 margin-bottom: ${Z};
 margin-left: ${Z};
 margin-right: ${Z};
 border-bottom-left-radius: ${Z};
 border-bottom-right-radius: ${Z};
 `),K("&:last-child:not(:first-child)",`
 margin-top: ${Z};
 margin-left: ${Z};
 margin-right: ${Z};
 border-top-left-radius: ${Z};
 border-top-right-radius: ${Z};
 `),K("&:not(:first-child):not(:last-child)",`
 margin: ${Z};
 border-radius: ${Z};
 `),xe("default"),te("ghost",[xe("primary"),xe("info"),xe("success"),xe("warning"),xe("error")])])])]),kn={size:{type:String,default:void 0},vertical:Boolean},Nn=X({name:"ButtonGroup",props:kn,setup(e){const{mergedClsPrefixRef:l,mergedRtlRef:i}=qe(e);return pt("-button-group",wn,l),Rt(uo,e),{rtlEnabled:mt("ButtonGroup",i,l),mergedClsPrefix:l}},render(){const{mergedClsPrefix:e}=this;return q("div",{class:[`${e}-button-group`,this.rtlEnabled&&`${e}-button-group--rtl`,this.vertical&&`${e}-button-group--vertical`],role:"group"},this.$slots)}}),$n=()=>fo,xn=co({name:"DynamicInput",common:Dt,peers:{Input:po,Button:mo},self:$n}),_t=ho("n-dynamic-input"),Sn=X({name:"DynamicInputInputPreset",props:{clsPrefix:{type:String,required:!0},value:{type:String,default:""},disabled:Boolean,parentPath:String,path:String,onUpdateValue:{type:Function,required:!0}},setup(){const{mergedThemeRef:e,placeholderRef:l}=ft(_t);return{mergedTheme:e,placeholder:l}},render(){const{mergedTheme:e,placeholder:l,value:i,clsPrefix:u,onUpdateValue:s,disabled:t}=this;return q("div",{class:`${u}-dynamic-input-preset-input`},q(ye,{theme:e.peers.Input,"theme-overrides":e.peerOverrides.Input,value:i,placeholder:l,onUpdateValue:s,disabled:t}))}}),Vn=X({name:"DynamicInputPairPreset",props:{clsPrefix:{type:String,required:!0},value:{type:Object,default:()=>({key:"",value:""})},disabled:Boolean,parentPath:String,path:String,onUpdateValue:{type:Function,required:!0}},setup(e){const{mergedThemeRef:l,keyPlaceholderRef:i,valuePlaceholderRef:u}=ft(_t);return{mergedTheme:l,keyPlaceholder:i,valuePlaceholder:u,handleKeyInput(s){e.onUpdateValue({key:s,value:e.value.value})},handleValueInput(s){e.onUpdateValue({key:e.value.key,value:s})}}},render(){const{mergedTheme:e,keyPlaceholder:l,valuePlaceholder:i,value:u,clsPrefix:s,disabled:t}=this;return q("div",{class:`${s}-dynamic-input-preset-pair`},q(ye,{theme:e.peers.Input,"theme-overrides":e.peerOverrides.Input,value:u.key,class:`${s}-dynamic-input-pair-input`,placeholder:l,onUpdateValue:this.handleKeyInput,disabled:t}),q(ye,{theme:e.peers.Input,"theme-overrides":e.peerOverrides.Input,value:u.value,class:`${s}-dynamic-input-pair-input`,placeholder:i,onUpdateValue:this.handleValueInput,disabled:t}))}}),Cn=ee("dynamic-input",{width:"100%"},[ee("dynamic-input-item",`
 margin-bottom: 10px;
 display: flex;
 flex-wrap: nowrap;
 `,[ee("dynamic-input-preset-input",{flex:1,alignItems:"center"}),ee("dynamic-input-preset-pair",`
 flex: 1;
 display: flex;
 align-items: center;
 `,[ee("dynamic-input-pair-input",[K("&:first-child",{"margin-right":"12px"})])]),Se("action",`
 align-self: flex-start;
 display: flex;
 justify-content: flex-end;
 flex-shrink: 0;
 flex-grow: 0;
 margin: var(--action-margin);
 `,[te("icon",{cursor:"pointer"})]),K("&:last-child",{marginBottom:0})]),ee("form-item",`
 padding-top: 0 !important;
 margin-right: 0 !important;
 `,[ee("form-item-blank",{paddingTop:"0 !important"})])]),Pe=new WeakMap,Bn=Object.assign(Object.assign({},He.props),{max:Number,min:{type:Number,default:0},value:Array,defaultValue:{type:Array,default:()=>[]},preset:{type:String,default:"input"},keyField:String,itemClass:String,itemStyle:[String,Object],keyPlaceholder:{type:String,default:""},valuePlaceholder:{type:String,default:""},placeholder:{type:String,default:""},disabled:Boolean,showSortButton:Boolean,createButtonProps:Object,onCreate:Function,onRemove:Function,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onClear:Function,onInput:[Function,Array]}),Tn=X({name:"DynamicInput",props:Bn,setup(e,{slots:l}){const{mergedComponentPropsRef:i,mergedClsPrefixRef:u,mergedRtlRef:s,inlineThemeDisabled:t}=qe(),o=ft(vo,null),c=x(e.defaultValue),r=be(e,"value"),f=_o(r,c),p=He("DynamicInput","-dynamic-input",Cn,xn,e,u),d=ne(()=>{const{value:S}=f;if(Array.isArray(S)){const{max:V}=e;return V!==void 0&&S.length>=V}return!1}),v=ne(()=>{const{value:S}=f;return Array.isArray(S)?S.length<=e.min:!0}),g=ne(()=>{var S,V;return(V=(S=i==null?void 0:i.value)===null||S===void 0?void 0:S.DynamicInput)===null||V===void 0?void 0:V.buttonSize});function b(S){const{onInput:V,"onUpdate:value":N,onUpdateValue:_}=e;V&&it(V,S),N&&it(N,S),_&&it(_,S),c.value=S}function I(S,V){if(S==null||typeof S!="object")return V;const N=lt(S)?st(S):S;let _=Pe.get(N);return _===void 0&&Pe.set(N,_=yo()),_}function y(S,V){const{value:N}=f,_=Array.from(N??[]),A=_[S];if(_[S]=V,A&&V&&typeof A=="object"&&typeof V=="object"){const W=lt(A)?st(A):A,P=lt(V)?st(V):V,Y=Pe.get(W);Y!==void 0&&Pe.set(P,Y)}b(_)}function k(){R(-1)}function R(S){const{value:V}=f,{onCreate:N}=e,_=Array.from(V??[]);if(N)_.splice(S+1,0,N(S+1)),b(_);else if(l.default)_.splice(S+1,0,null),b(_);else switch(e.preset){case"input":_.splice(S+1,0,""),b(_);break;case"pair":_.splice(S+1,0,{key:"",value:""}),b(_);break}}function z(S){const{value:V}=f;if(!Array.isArray(V))return;const{min:N}=e;if(V.length<=N)return;const{onRemove:_}=e;_&&_(S);const A=Array.from(V);A.splice(S,1),b(A)}function U(S,V,N){if(V<0||N<0||V>=S.length||N>=S.length||V===N)return;const _=S[V];S[V]=S[N],S[N]=_}function F(S,V){const{value:N}=f;if(!Array.isArray(N))return;const _=Array.from(N);S==="up"&&U(_,V,V-1),S==="down"&&U(_,V,V+1),b(_)}Rt(_t,{mergedThemeRef:p,keyPlaceholderRef:be(e,"keyPlaceholder"),valuePlaceholderRef:be(e,"valuePlaceholder"),placeholderRef:be(e,"placeholder")});const $=mt("DynamicInput",s,u),O=ne(()=>{const{self:{actionMargin:S,actionMarginRtl:V}}=p.value;return{"--action-margin":S,"--action-margin-rtl":V}}),E=t?It("dynamic-input",void 0,O,e):void 0;return{locale:go("DynamicInput").localeRef,rtlEnabled:$,buttonSize:g,mergedClsPrefix:u,NFormItem:o,uncontrolledValue:c,mergedValue:f,insertionDisabled:d,removeDisabled:v,handleCreateClick:k,ensureKey:I,handleValueChange:y,remove:z,move:F,createItem:R,mergedTheme:p,cssVars:t?void 0:O,themeClass:E==null?void 0:E.themeClass,onRender:E==null?void 0:E.onRender}},render(){const{$slots:e,itemClass:l,buttonSize:i,mergedClsPrefix:u,mergedValue:s,locale:t,mergedTheme:o,keyField:c,itemStyle:r,preset:f,showSortButton:p,NFormItem:d,ensureKey:v,handleValueChange:g,remove:b,createItem:I,move:y,onRender:k,disabled:R}=this;return k==null||k(),q("div",{class:[`${u}-dynamic-input`,this.rtlEnabled&&`${u}-dynamic-input--rtl`,this.themeClass],style:this.cssVars},!Array.isArray(s)||s.length===0?q(ae,Object.assign({block:!0,ghost:!0,dashed:!0,size:i},this.createButtonProps,{disabled:this.insertionDisabled||R,theme:o.peers.Button,themeOverrides:o.peerOverrides.Button,onClick:this.handleCreateClick}),{default:()=>rt(e["create-button-default"],()=>[t.create]),icon:()=>rt(e["create-button-icon"],()=>[q(Ie,{clsPrefix:u},{default:()=>q($t,null)})])}):s.map((z,U)=>q("div",{key:c?z[c]:v(z,U),"data-key":c?z[c]:v(z,U),class:[`${u}-dynamic-input-item`,l],style:r},xt(e.default,{value:s[U],index:U},()=>[f==="input"?q(Sn,{disabled:R,clsPrefix:u,value:s[U],parentPath:d?d.path.value:void 0,path:d!=null&&d.path.value?`${d.path.value}[${U}]`:void 0,onUpdateValue:F=>{g(U,F)}}):f==="pair"?q(Vn,{disabled:R,clsPrefix:u,value:s[U],parentPath:d?d.path.value:void 0,path:d!=null&&d.path.value?`${d.path.value}[${U}]`:void 0,onUpdateValue:F=>{g(U,F)}}):null]),xt(e.action,{value:s[U],index:U,create:I,remove:b,move:y},()=>[q("div",{class:`${u}-dynamic-input-item__action`},q(Nn,{size:i},{default:()=>[q(ae,{disabled:this.removeDisabled||R,theme:o.peers.Button,themeOverrides:o.peerOverrides.Button,circle:!0,onClick:()=>{b(U)}},{icon:()=>q(Ie,{clsPrefix:u},{default:()=>q(bo,null)})}),q(ae,{disabled:this.insertionDisabled||R,circle:!0,theme:o.peers.Button,themeOverrides:o.peerOverrides.Button,onClick:()=>{I(U)}},{icon:()=>q(Ie,{clsPrefix:u},{default:()=>q($t,null)})}),p?q(ae,{disabled:U===0||R,circle:!0,theme:o.peers.Button,themeOverrides:o.peerOverrides.Button,onClick:()=>{y("up",U)}},{icon:()=>q(Ie,{clsPrefix:u},{default:()=>q(mn,null)})}):null,p?q(ae,{disabled:U===s.length-1||R,circle:!0,theme:o.peers.Button,themeOverrides:o.peerOverrides.Button,onClick:()=>{y("down",U)}},{icon:()=>q(Ie,{clsPrefix:u},{default:()=>q(Fo,null)})}):null]}))]))))}}),Dn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},In=w("path",{fill:"currentColor",d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8"},null,-1),Rn=w("path",{fill:"currentColor",d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8Z"},null,-1),Un=[In,Rn];function Ln(e,l){return m(),L("svg",Dn,[...Un])}const Ht={name:"ant-design-plus-outlined",render:Ln},Mn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},jn=w("path",{fill:"currentColor",d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8"},null,-1),zn=[jn];function En(e,l){return m(),L("svg",Mn,[...zn])}const An={name:"ant-design-minus-outlined",render:En},Tt={y:{t:"top",m:"marginTop",b:"bottom"},x:{l:"left",m:"marginLeft",r:"right"}};function Pn(e){e.forEach((l,i)=>{document.documentElement.addEventListener(i,l)})}function On(e){e.forEach((l,i)=>{document.documentElement.removeEventListener(i,l)})}const qn={name:"vue-drag-resize",emits:["clicked","dragging","dragstop","resizing","resizestop","activated","deactivated"],props:{stickSize:{type:Number,default:8},parentScaleX:{type:Number,default:1},parentScaleY:{type:Number,default:1},isActive:{type:Boolean,default:!1},preventActiveBehavior:{type:Boolean,default:!1},isDraggable:{type:Boolean,default:!0},isResizable:{type:Boolean,default:!0},aspectRatio:{type:Boolean,default:!1},parentLimitation:{type:Boolean,default:!1},snapToGrid:{type:Boolean,default:!1},gridX:{type:Number,default:50,validator(e){return e>=0}},gridY:{type:Number,default:50,validator(e){return e>=0}},parentW:{type:Number,default:0,validator(e){return e>=0}},parentH:{type:Number,default:0,validator(e){return e>=0}},w:{type:[String,Number],default:200,validator(e){return typeof e=="string"?e==="auto":e>=0}},h:{type:[String,Number],default:200,validator(e){return typeof e=="string"?e==="auto":e>=0}},minw:{type:Number,default:50,validator(e){return e>=0}},minh:{type:Number,default:50,validator(e){return e>=0}},x:{type:Number,default:0,validator(e){return typeof e=="number"}},y:{type:Number,default:0,validator(e){return typeof e=="number"}},z:{type:[String,Number],default:"auto",validator(e){return typeof e=="string"?e==="auto":e>=0}},dragHandle:{type:String,default:null},dragCancel:{type:String,default:null},sticks:{type:Array,default(){return["tl","tm","tr","mr","br","bm","bl","ml"]}},axis:{type:String,default:"both",validator(e){return["x","y","both","none"].indexOf(e)!==-1}},contentClass:{type:String,required:!1,default:""}},data(){return{fixAspectRatio:null,active:null,zIndex:null,parentWidth:null,parentHeight:null,left:null,top:null,right:null,bottom:null,minHeight:null}},beforeCreate(){this.stickDrag=!1,this.bodyDrag=!1,this.dimensionsBeforeMove={pointerX:0,pointerY:0,x:0,y:0,w:0,h:0},this.limits={left:{min:null,max:null},right:{min:null,max:null},top:{min:null,max:null},bottom:{min:null,max:null}},this.currentStick=null},mounted(){this.parentElement=this.$el.parentNode,this.parentWidth=this.parentW?this.parentW:this.parentElement.clientWidth,this.parentHeight=this.parentH?this.parentH:this.parentElement.clientHeight,this.left=this.x,this.top=this.y,this.right=this.parentWidth-(this.w==="auto"?this.$refs.container.scrollWidth:this.w)-this.left,this.bottom=this.parentHeight-(this.h==="auto"?this.$refs.container.scrollHeight:this.h)-this.top,this.domEvents=new Map([["mousemove",this.move],["mouseup",this.up],["mouseleave",this.up],["mousedown",this.deselect],["touchmove",this.move],["touchend",this.up],["touchcancel",this.up],["touchstart",this.up]]),Pn(this.domEvents),this.dragHandle&&[...this.$el.querySelectorAll(this.dragHandle)].forEach(e=>{e.setAttribute("data-drag-handle",this._uid)}),this.dragCancel&&[...this.$el.querySelectorAll(this.dragCancel)].forEach(e=>{e.setAttribute("data-drag-cancel",this._uid)})},beforeDestroy(){On(this.domEvents)},methods:{deselect(){this.preventActiveBehavior||(this.active=!1)},move(e){if(!this.stickDrag&&!this.bodyDrag)return;e.stopPropagation();const l=typeof e.pageX<"u"?e.pageX:e.touches[0].pageX,i=typeof e.pageY<"u"?e.pageY:e.touches[0].pageY,{dimensionsBeforeMove:u}=this,s={x:(u.pointerX-l)/this.parentScaleX,y:(u.pointerY-i)/this.parentScaleY};if(this.stickDrag&&this.stickMove(s),this.bodyDrag){if(this.axis==="x")s.y=0;else if(this.axis==="y")s.x=0;else if(this.axis==="none")return;this.bodyMove(s)}},up(e){this.stickDrag?this.stickUp(e):this.bodyDrag&&this.bodyUp(e)},bodyDown(e){const{target:l,button:i}=e;if(this.preventActiveBehavior||(this.active=!0),i&&i!==0||(this.$emit("clicked",e),!this.active)||this.dragHandle&&l.getAttribute("data-drag-handle")!==this._uid.toString()||this.dragCancel&&l.getAttribute("data-drag-cancel")===this._uid.toString())return;typeof e.stopPropagation<"u"&&e.stopPropagation(),typeof e.preventDefault<"u"&&e.preventDefault(),this.isDraggable&&(this.bodyDrag=!0);const u=typeof e.pageX<"u"?e.pageX:e.touches[0].pageX,s=typeof e.pageY<"u"?e.pageY:e.touches[0].pageY;this.saveDimensionsBeforeMove({pointerX:u,pointerY:s}),this.parentLimitation&&(this.limits=this.calcDragLimitation())},bodyMove(e){const{dimensionsBeforeMove:l,parentWidth:i,parentHeight:u,gridX:s,gridY:t,width:o,height:c}=this;let r=l.top-e.y,f=l.bottom+e.y,p=l.left-e.x,d=l.right+e.x;if(this.snapToGrid){let v=!0,g=!0,b=r-Math.floor(r/t)*t,I=u-f-Math.floor((u-f)/t)*t,y=p-Math.floor(p/s)*s,k=i-d-Math.floor((i-d)/s)*s;b>t/2&&(b-=t),I>t/2&&(I-=t),y>s/2&&(y-=s),k>s/2&&(k-=s),Math.abs(I)<Math.abs(b)&&(v=!1),Math.abs(k)<Math.abs(y)&&(g=!1),r-=v?b:I,f=u-c-r,p-=g?y:k,d=i-o-p}({newLeft:this.left,newRight:this.right,newTop:this.top,newBottom:this.bottom}=this.rectCorrectionByLimit({newLeft:p,newRight:d,newTop:r,newBottom:f})),this.$emit("dragging",this.rect)},bodyUp(){this.bodyDrag=!1,this.$emit("dragging",this.rect),this.$emit("dragstop",this.rect),this.dimensionsBeforeMove={pointerX:0,pointerY:0,x:0,y:0,w:0,h:0},this.limits={left:{min:null,max:null},right:{min:null,max:null},top:{min:null,max:null},bottom:{min:null,max:null}}},stickDown(e,l,i=!1){if((!this.isResizable||!this.active)&&!i)return;this.stickDrag=!0;const u=typeof l.pageX<"u"?l.pageX:l.touches[0].pageX,s=typeof l.pageY<"u"?l.pageY:l.touches[0].pageY;this.saveDimensionsBeforeMove({pointerX:u,pointerY:s}),this.currentStick=e,this.limits=this.calcResizeLimits()},saveDimensionsBeforeMove({pointerX:e,pointerY:l}){this.dimensionsBeforeMove.pointerX=e,this.dimensionsBeforeMove.pointerY=l,this.dimensionsBeforeMove.left=this.left,this.dimensionsBeforeMove.right=this.right,this.dimensionsBeforeMove.top=this.top,this.dimensionsBeforeMove.bottom=this.bottom,this.dimensionsBeforeMove.width=this.width,this.dimensionsBeforeMove.height=this.height,this.aspectFactor=this.width/this.height},stickMove(e){const{currentStick:l,dimensionsBeforeMove:i,gridY:u,gridX:s,snapToGrid:t,parentHeight:o,parentWidth:c}=this;let r=i.top,f=i.bottom,p=i.left,d=i.right;switch(l[0]){case"b":f=i.bottom+e.y,t&&(f=o-Math.round((o-f)/u)*u);break;case"t":r=i.top-e.y,t&&(r=Math.round(r/u)*u);break}switch(l[1]){case"r":d=i.right+e.x,t&&(d=c-Math.round((c-d)/s)*s);break;case"l":p=i.left-e.x,t&&(p=Math.round(p/s)*s);break}({newLeft:p,newRight:d,newTop:r,newBottom:f}=this.rectCorrectionByLimit({newLeft:p,newRight:d,newTop:r,newBottom:f})),this.aspectRatio&&({newLeft:p,newRight:d,newTop:r,newBottom:f}=this.rectCorrectionByAspectRatio({newLeft:p,newRight:d,newTop:r,newBottom:f})),this.left=p,this.right=d,this.top=r,this.bottom=f,this.$emit("resizing",this.rect)},stickUp(){this.stickDrag=!1,this.dimensionsBeforeMove={pointerX:0,pointerY:0,x:0,y:0,w:0,h:0},this.limits={left:{min:null,max:null},right:{min:null,max:null},top:{min:null,max:null},bottom:{min:null,max:null}},this.$emit("resizing",this.rect),this.$emit("resizestop",this.rect)},calcDragLimitation(){const{parentWidth:e,parentHeight:l}=this;return{left:{min:0,max:e-this.width},right:{min:0,max:e-this.width},top:{min:0,max:l-this.height},bottom:{min:0,max:l-this.height}}},calcResizeLimits(){const{aspectFactor:e,width:l,height:i,bottom:u,top:s,left:t,right:o}=this;let{minh:c,minw:r}=this;const f=this.parentLimitation?0:null;this.aspectRatio&&(r/c>e?c=r/e:r=e*c);const p={left:{min:f,max:t+(l-r)},right:{min:f,max:o+(l-r)},top:{min:f,max:s+(i-c)},bottom:{min:f,max:u+(i-c)}};if(this.aspectRatio){const d={left:{min:t-Math.min(s,u)*e*2,max:t+(i-c)/2*e*2},right:{min:o-Math.min(s,u)*e*2,max:o+(i-c)/2*e*2},top:{min:s-Math.min(t,o)/e*2,max:s+(l-r)/2/e*2},bottom:{min:u-Math.min(t,o)/e*2,max:u+(l-r)/2/e*2}};this.currentStick[0]==="m"?(p.left={min:Math.max(p.left.min,d.left.min),max:Math.min(p.left.max,d.left.max)},p.right={min:Math.max(p.right.min,d.right.min),max:Math.min(p.right.max,d.right.max)}):this.currentStick[1]==="m"&&(p.top={min:Math.max(p.top.min,d.top.min),max:Math.min(p.top.max,d.top.max)},p.bottom={min:Math.max(p.bottom.min,d.bottom.min),max:Math.min(p.bottom.max,d.bottom.max)})}return p},sideCorrectionByLimit(e,l){let i=l;return e.min!==null&&l<e.min?i=e.min:e.max!==null&&e.max<l&&(i=e.max),i},rectCorrectionByLimit(e){const{limits:l}=this;let{newRight:i,newLeft:u,newBottom:s,newTop:t}=e;return u=this.sideCorrectionByLimit(l.left,u),i=this.sideCorrectionByLimit(l.right,i),t=this.sideCorrectionByLimit(l.top,t),s=this.sideCorrectionByLimit(l.bottom,s),{newLeft:u,newRight:i,newTop:t,newBottom:s}},rectCorrectionByAspectRatio(e){let{newLeft:l,newRight:i,newTop:u,newBottom:s}=e;const{parentWidth:t,parentHeight:o,currentStick:c,aspectFactor:r,dimensionsBeforeMove:f}=this;let p=t-l-i,d=o-u-s;if(c[1]==="m"){const v=d-f.height;l-=v*r/2,i-=v*r/2}else if(c[0]==="m"){const v=p-f.width;u-=v/r/2,s-=v/r/2}else p/d>r?(p=r*d,c[1]==="l"?l=t-i-p:i=t-l-p):(d=p/r,c[0]==="t"?u=o-s-d:s=o-u-d);return{newLeft:l,newRight:i,newTop:u,newBottom:s}}},computed:{positionStyle(){return{top:this.top+"px",left:this.left+"px",zIndex:this.zIndex}},sizeStyle(){return{width:this.w=="auto"?"auto":this.width+"px",height:this.h=="auto"?"auto":this.height+"px"}},vdrStick(){return e=>{const l={width:`${this.stickSize/this.parentScaleX}px`,height:`${this.stickSize/this.parentScaleY}px`};return l[Tt.y[e[0]]]=`${this.stickSize/this.parentScaleX/-2}px`,l[Tt.x[e[1]]]=`${this.stickSize/this.parentScaleX/-2}px`,l}},width(){return this.parentWidth-this.left-this.right},height(){return this.parentHeight-this.top-this.bottom},rect(){return{left:Math.round(this.left),top:Math.round(this.top),width:Math.round(this.width),height:Math.round(this.height)}}},watch:{active(e){e?this.$emit("activated"):this.$emit("deactivated")},isActive:{immediate:!0,handler(e){this.active=e}},z:{immediate:!0,handler(e){(e>=0||e==="auto")&&(this.zIndex=e)}},x:{handler(e,l){if(this.stickDrag||this.bodyDrag||e===this.left)return;const i=l-e;this.bodyDown({pageX:this.left,pageY:this.top}),this.bodyMove({x:i,y:0}),this.$nextTick(()=>{this.bodyUp()})}},y:{handler(e,l){if(this.stickDrag||this.bodyDrag||e===this.top)return;const i=l-e;this.bodyDown({pageX:this.left,pageY:this.top}),this.bodyMove({x:0,y:i}),this.$nextTick(()=>{this.bodyUp()})}},w:{handler(e,l){if(this.stickDrag||this.bodyDrag||e===this.width)return;const i="mr",u=l-e;this.stickDown(i,{pageX:this.right,pageY:this.top+this.height/2},!0),this.stickMove({x:u,y:0}),this.$nextTick(()=>{this.stickUp()})}},h:{handler(e,l){if(this.stickDrag||this.bodyDrag||e===this.height)return;const i="bm",u=l-e;this.stickDown(i,{pageX:this.left+this.width/2,pageY:this.bottom},!0),this.stickMove({x:0,y:u}),this.$nextTick(()=>{this.stickUp()})}},parentW(e){this.right=e-this.width-this.left,this.parentWidth=e},parentH(e){this.bottom=e-this.height-this.top,this.parentHeight=e}}},Yn=["onMousedown","onTouchstart"];function Hn(e,l,i,u,s,t){return m(),L("div",{class:Ve(["vdr",`${e.active||e.isActive?"active":"inactive"} ${e.contentClass?e.contentClass:""}`]),style:he(e.positionStyle),onMousedown:l[0]||(l[0]=o=>e.bodyDown(o)),onTouchstart:l[1]||(l[1]=o=>e.bodyDown(o)),onTouchend:l[2]||(l[2]=o=>e.up(o))},[w("div",{style:he(e.sizeStyle),class:"content-container",ref:"container"},[Ce(e.$slots,"default")],4),(m(!0),L(se,null,ue(e.sticks,o=>(m(),L("div",{class:Ve(["vdr-stick",["vdr-stick-"+o,e.isResizable?"":"not-resizable"]]),onMousedown:re(c=>e.stickDown(o,c),["stop","prevent"]),onTouchstart:re(c=>e.stickDown(o,c),["stop","prevent"]),style:he(e.vdrStick(o))},null,46,Yn))),256))],38)}const Ft=_e(qn,[["render",Hn]]);function ct(e){ct.installed||(ct.installed=!0,e.component("vue-drag-resize",Ft))}const Fn={install:ct};let Oe=null;typeof window<"u"?Oe=window.Vue:typeof global<"u"&&(Oe=global.Vue);Oe&&Oe.use(Fn);const Wn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},Xn=w("path",{fill:"currentColor",d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1l-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4"},null,-1),Gn=[Xn];function Jn(e,l){return m(),L("svg",Wn,[...Gn])}const Wt={name:"ant-design-right-outlined",render:Jn},Kn={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},Zn=w("path",{fill:"currentColor","fill-rule":"evenodd",d:"M799.855 166.312c.023.007.043.018.084.059l57.69 57.69c.041.041.052.06.059.084a.1.1 0 0 1 0 .069c-.007.023-.018.042-.059.083L569.926 512l287.703 287.703c.041.04.052.06.059.083a.12.12 0 0 1 0 .07c-.007.022-.018.042-.059.083l-57.69 57.69c-.041.041-.06.052-.084.059a.1.1 0 0 1-.069 0c-.023-.007-.042-.018-.083-.059L512 569.926L224.297 857.629c-.04.041-.06.052-.083.059a.12.12 0 0 1-.07 0c-.022-.007-.042-.018-.083-.059l-57.69-57.69c-.041-.041-.052-.06-.059-.084a.1.1 0 0 1 0-.069c.007-.023.018-.042.059-.083L454.073 512L166.371 224.297c-.041-.04-.052-.06-.059-.083a.12.12 0 0 1 0-.07c.007-.022.018-.042.059-.083l57.69-57.69c.041-.041.06-.052.084-.059a.1.1 0 0 1 .069 0c.023.007.042.018.083.059L512 454.073l287.703-287.702c.04-.041.06-.052.083-.059a.12.12 0 0 1 .07 0Z"},null,-1),Qn=[Zn];function ea(e,l){return m(),L("svg",Kn,[...Qn])}const gt={name:"ant-design-close-outlined",render:ea},ta={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},oa=w("path",{fill:"currentColor",d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281l360-281.1c3.8-3 6.1-7.7 6.1-12.6"},null,-1),na=[oa];function aa(e,l){return m(),L("svg",ta,[...na])}const Xt={name:"ant-design-left-outlined",render:aa},la={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},sa=w("path",{fill:"currentColor",d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448s448-200.6 448-448S759.4 64 512 64m0 820c-205.4 0-372-166.6-372-372c0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884m288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372c0 89-31.3 170.8-83.5 234.8"},null,-1),ia=[sa];function ra(e,l){return m(),L("svg",la,[...ia])}const da={name:"ant-design-stop-outlined",render:ra},ua={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},ca=w("path",{fill:"currentColor",d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9C912 303 733.5 124.3 512.6 124C291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2c3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1c-8.1-6.6-15.9-13.7-23.4-21.2a318.6 318.6 0 0 1-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7s63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6s52.5 63.6 68.6 101.7c16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.6 318.6 0 0 1-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 0 0-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9z"},null,-1),pa=[ca];function ma(e,l){return m(),L("svg",ua,[...pa])}const bt={name:"ant-design-redo-outlined",render:ma},ge=wo("workflow",()=>{const e=x(),l=x(),i=x(),u=x([]);function s(r){e.value=r}function t(r){l.value=r}async function o(r){i.value=r;const{data:f,error:p}=await qo({groupName:r});p||(u.value=f.map(d=>({id:d.id,jobName:d.jobName})))}function c(){e.value=void 0,l.value=void 0,i.value=void 0,u.value=[]}return{id:e,type:l,groupName:i,jobList:u,setJobList:o,setType:t,setId:s,clear:c}}),fa={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},ha=w("path",{fill:"currentColor",d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 0 0 0-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 0 0 9.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9m67.4-174.4L687.8 215l73.3 73.3l-362.7 362.6l-88.9 15.7zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32"},null,-1),va=[ha];function _a(e,l){return m(),L("svg",fa,[...va])}const ga={name:"ant-design-edit-outlined",render:_a},ba={class:"flex items-center"},et=X({name:"EditableInput",__name:"editable-input",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:l}){const i=e,u=l,s=x(),t=x(),o=x(!1);J(()=>i.modelValue,f=>{t.value=f},{immediate:!0});const c=()=>{o.value=!0,ve(()=>{var f;(f=s.value)==null||f.focus()})},r=()=>{u("update:modelValue",t.value),o.value=!1};return(f,p)=>{const d=ye,v=ga,g=ae,b=Fe;return o.value?(m(),M(d,{key:0,ref_key:"inputRef",ref:s,value:t.value,"onUpdate:value":p[0]||(p[0]=I=>t.value=I),type:"text",onBlur:r},null,8,["value"])):(m(),M(b,{key:1},{default:a(()=>[w("span",ba,[B(D(t.value)+" ",1),n(g,{text:"",type:"info",class:"m-l-6px",onClick:c},{icon:a(()=>[n(v,{class:"text-icon"})]),_:1})])]),_:1}))}}}),ya={class:"w-460px flex-center"},wa=X({name:"TaskDrawer",__name:"task-drawer",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1},len:{default:0}},emits:["update:open","save"],setup(e,{emit:l}){const i=e,u=l,s=ge(),t=x(!1),o=x({}),c=x([]);J(()=>s.jobList,g=>{c.value=g},{immediate:!0}),J(()=>i.open,g=>{t.value=g},{immediate:!0}),J(()=>i.modelValue,g=>{o.value=g},{immediate:!0});const r=x(),f=()=>{u("update:open",!1),t.value=!1},p=()=>{var g;(g=r.value)==null||g.validate(b=>{b||(f(),u("save",o.value))}).catch(()=>{var b;return(b=window.$message)==null?void 0:b.warning("请检查表单信息")})},d={failStrategy:[{required:!0,message:"请选择失败策略"}],workflowNodeStatus:[{required:!0,message:"请选择工作流状态"}],jobTask:{jobId:[{required:!0,message:"请选择任务"}]}},v=(g,b)=>{o.value.jobTask.jobName=b.label};return(g,b)=>{const I=Be,y=We,k=Ze,R=Xe,z=Ke,U=Ge,F=ae,$=me,O=fe;return m(),M(O,{show:t.value,"onUpdate:show":b[5]||(b[5]=E=>t.value=E),"display-directive":"if",width:500,onAfterLeave:f},{default:a(()=>[n($,null,{header:a(()=>[w("div",ya,[n(et,{modelValue:o.value.nodeName,"onUpdate:modelValue":b[0]||(b[0]=E=>o.value.nodeName=E),class:"mr-16px max-w-320px min-w-320px"},null,8,["modelValue"]),n(I,{value:o.value.priorityLevel,"onUpdate:value":b[1]||(b[1]=E=>o.value.priorityLevel=E),class:"max-w-110px",options:Array(g.len).fill(0).map((E,S)=>({label:"优先级 "+(S+1),value:S+1}))},null,8,["value","options"])])]),footer:a(()=>[n(F,{type:"primary",onClick:p},{default:a(()=>[B("保存")]),_:1}),n(F,{class:"ml-12px",onClick:f},{default:a(()=>[B("取消")]),_:1})]),default:a(()=>[n(U,{ref_key:"formRef",ref:r,model:o.value,rules:d,"label-align":"left","label-width":"100px"},{default:a(()=>[n(y,{path:"jobTask.jobId",label:"所属任务",placeholder:"请选择任务"},{default:a(()=>[n(I,{value:o.value.jobTask.jobId,"onUpdate:value":[b[2]||(b[2]=E=>o.value.jobTask.jobId=E),v],options:c.value.map(E=>({label:E.jobName,value:E.id}))},null,8,["value","options"])]),_:1}),n(y,{path:"failStrategy",label:"失败策略"},{default:a(()=>[n(z,{value:o.value.failStrategy,"onUpdate:value":b[3]||(b[3]=E=>o.value.failStrategy=E)},{default:a(()=>[n(R,null,{default:a(()=>[(m(!0),L(se,null,ue(h(ko),(E,S)=>(m(),M(k,{key:S,label:h(j)(E.label),value:E.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1}),n(y,{path:"workflowNodeStatus",label:"节点状态"},{default:a(()=>[n(z,{value:o.value.workflowNodeStatus,"onUpdate:value":b[4]||(b[4]=E=>o.value.workflowNodeStatus=E)},{default:a(()=>[n(R,null,{default:a(()=>[(m(!0),L(se,null,ue(h(ht),(E,S)=>(m(),M(k,{key:S,label:h(j)(E.label),value:E.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])}}}),ka=X({name:"TaskDetail",__name:"task-detail",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1}},emits:["update:open"],setup(e,{emit:l}){const i=e,u=l,s=ge(),t=x(!1);J(()=>i.open,r=>{t.value=r},{immediate:!0});const o=()=>{u("update:open",!1)},c=r=>{var p;return(p=s.jobList.find(d=>d.id===r))==null?void 0:p.jobName};return(r,f)=>{const p=Te,d=De,v=me,g=fe;return m(),M(g,{show:t.value,"onUpdate:show":f[0]||(f[0]=b=>t.value=b),placement:"right",width:500,"display-directive":"if",onAfterLeave:o},{default:a(()=>[n(v,{title:"工作流详情"},{default:a(()=>[n(d,{column:1,"label-placement":"left",bordered:"","label-style":{width:"120px"}},{default:a(()=>[n(p,{label:"节点名称"},{default:a(()=>[B(D(r.modelValue.nodeName),1)]),_:1}),n(p,{label:"任务 ID"},{default:a(()=>{var b;return[B(D((b=r.modelValue.jobTask)==null?void 0:b.jobId),1)]}),_:1}),n(p,{label:"任务名称"},{default:a(()=>{var b;return[B(D(c((b=r.modelValue.jobTask)==null?void 0:b.jobId)),1)]}),_:1}),n(p,{label:"失败策略"},{default:a(()=>[B(D(h(j)(h(Ut)[r.modelValue.failStrategy])),1)]),_:1}),n(p,{label:"工作流状态"},{default:a(()=>[B(D(h(j)(h(Lt)[r.modelValue.workflowNodeStatus])),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])}}}),Na=X({name:"FlowLogDrawer",__name:"flow-log-drawer",props:No({title:{default:j("workflow.node.log.title")},taskData:{}},{show:{type:Boolean,default:!0},showModifiers:{}}),emits:["update:show"],setup(e){const l=dt(e,"show");return(i,u)=>{const s=Xo;return m(),M(s,{show:l.value,"onUpdate:show":u[0]||(u[0]=t=>l.value=t),title:i.title,"task-data":i.taskData},null,8,["show","title","task-data"])}}}),$a={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},xa=w("path",{fill:"currentColor",d:"M168 504.2c1-43.7 10-86.1 26.9-126c17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 0 1 755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 0 0 3 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92C282.7 92 96.3 275.6 92 503.8a8 8 0 0 0 8 8.2h60c4.4 0 7.9-3.5 8-7.8m756 7.8h-60c-4.4 0-7.9 3.5-8 7.8c-1 43.7-10 86.1-26.9 126c-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 0 1 512.1 856a342.24 342.24 0 0 1-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 0 0-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 0 0-8-8.2"},null,-1),Sa=[xa];function Va(e,l){return m(),L("svg",$a,[...Sa])}const Ca={name:"ant-design-sync-outlined",render:Va},Ba=e=>(Le("data-v-ac0baa2a"),e=e(),Me(),e),Ta=Ba(()=>w("span",null,"任务项列表",-1)),Da=X({name:"DetailCard",__name:"detail-card",props:{id:{default:void 0},ids:{default:()=>[]},show:{type:Boolean,default:!1}},emits:["update:show"],setup(e,{emit:l}){Go.registerLanguage("json",Jo);const i=e,u=l,s=Mt(),t=ge(),o=x(!1),c=x(!1),r=x(!1),f=x(!1),p=x(1),d=x(),v=x({}),g=x([]),b=x({page:1,pageCount:0,pageSize:10,showSizePicker:!0,pageSizes:[10,15,20,25,30],onUpdatePage:async _=>{b.value.page=_;const A=i.ids[p.value-1];k(A),R(A,_)},onUpdatePageSize:async _=>{b.value.pageSize=_;const A=i.ids[p.value-1];k(A),R(A,b.value.page)}});J(()=>i.show,_=>{o.value=_,_&&F()},{immediate:!0});const I=()=>{u("update:show",!1)};async function y(_){r.value=!0;const{data:A,error:W}=await Ho(_);W||(v.value=A,r.value=!1)}async function k(_){r.value=!0;const{data:A,error:W}=await Ko(_);W||(v.value=A,r.value=!1)}async function R(_,A=1){f.value=!0;const{data:W,error:P}=await Yo({groupName:t.groupName,taskBatchId:_??"0",taskStatus:d.value,page:A,size:b.value.pageSize});P||(b.value.pageCount=W.total,g.value=W.data,f.value=!1)}async function z(_){d.value=null,await R(_)}const U=x([]);function F(){U.value=i.ids,ve(()=>{i.ids.length>0?(k(i.ids[0]),R(i.ids[0])):i.id&&(U.value=[v.value.taskBatchId],y(i.id),R(v.value.taskBatchId))})}const $=x({}),O=_=>{$.value=_,c.value=!0},E=async _=>{var W;const{error:A}=await Eo(t.id,_.workflowNodeId);A||(W=window.$message)==null||W.success("执行重试成功")},S=_=>_===4||_===5||_===6;function V(_){return{color:`${_}18`,textColor:_,borderColor:`${_}58`}}const N=_=>{p.value=_;const A=i.ids[_-1];k(A),R(A,_)};return(_,A)=>{const W=Te,P=De,Y=jt,C=Co,G=Be,de=Ca,ke=bt,ze=Zo,nt=Bo,Ee=xo,at=Wo,H=me,le=fe,ce=Na;return m(),L(se,null,[n(le,{show:o.value,"onUpdate:show":[A[4]||(A[4]=ie=>o.value=ie),I],width:800,"display-directive":"if"},{default:a(()=>[n(H,{title:"任务批次详情",closable:""},$o({default:a(()=>[U.value&&U.value.length>0?(m(),M(Ee,{key:0,value:p.value,"onUpdate:value":A[2]||(A[2]=ie=>p.value=ie),type:"segment",animated:""},{default:a(()=>[(m(!0),L(se,null,ue(U.value,(ie,pe)=>(m(),M(C,{key:pe,name:pe+1,tab:ie},{default:a(()=>[n(Ee,{class:"detail-tabs",type:"segment",animated:""},{default:a(()=>[n(C,{name:"info",tab:h(j)("page.log.info")},{default:a(()=>[n(Y,{show:r.value},{default:a(()=>[n(P,{class:"pt-12px","label-placement":"left",bordered:"",column:2},{default:a(()=>[n(W,{label:h(j)("page.jobBatch.groupName")},{default:a(()=>{var Q;return[B(D((Q=v.value)==null?void 0:Q.groupName),1)]}),_:1},8,["label"]),n(W,{label:h(j)("page.jobBatch.jobName")},{default:a(()=>{var Q;return[B(D((Q=v.value)==null?void 0:Q.jobName),1)]}),_:1},8,["label"]),n(W,{label:h(j)("page.jobBatch.taskBatchStatus")},{default:a(()=>[h(Ue)(v.value.taskBatchStatus)?(m(),M(h(Ae),{key:0,color:V(h(oe)[v.value.taskBatchStatus].color)},{default:a(()=>[B(D(h(oe)[v.value.taskBatchStatus].title),1)]),_:1},8,["color"])):T("",!0),h(Ue)(v.value.jobStatus)?(m(),M(h(Ae),{key:1,color:V(h(St)[v.value.jobStatus].color)},{default:a(()=>[B(D(h(j)(h(St)[v.value.jobStatus].name)),1)]),_:1},8,["color"])):T("",!0)]),_:1},8,["label"]),n(W,{label:h(j)("page.jobBatch.executionAt")},{default:a(()=>{var Q;return[B(D((Q=v.value)==null?void 0:Q.executionAt),1)]}),_:1},8,["label"]),n(W,{label:h(j)("page.jobBatch.operationReason")},{default:a(()=>[h(Ue)(v.value.operationReason)?(m(),M(h(Ae),{key:0,color:V(h(Vt)[v.value.operationReason].color)},{default:a(()=>[B(D(h(j)(h(Vt)[v.value.operationReason].name)),1)]),_:1},8,["color"])):T("",!0)]),_:1},8,["label"]),h(s).default?T("",!0):(m(),M(W,{key:0,label:h(j)("page.jobBatch.executorType")},{default:a(()=>[h(Ue)(v.value.executorType)?(m(),M(h(Ae),{key:0,color:V(h(Ct)[v.value.executorType].color)},{default:a(()=>[B(D(h(j)(h(Ct)[v.value.executorType].name)),1)]),_:1},8,["color"])):T("",!0)]),_:1},8,["label"])),n(W,{label:h(j)("page.jobBatch.executorInfo"),span:2},{default:a(()=>{var Q;return[B(D((Q=v.value)==null?void 0:Q.executorInfo),1)]}),_:1},8,["label"]),n(W,{label:h(j)("common.createDt"),span:2},{default:a(()=>{var Q;return[B(D((Q=v.value)==null?void 0:Q.createDt),1)]}),_:1},8,["label"])]),_:1})]),_:1},8,["show"]),Ce(_.$slots,"default",{},void 0,!0)]),_:3},8,["tab"]),n(C,{name:"task",disabled:v.value.taskBatchStatus===99},{tab:a(()=>[Ta]),default:a(()=>[n(nt,{bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper pt-16px","content-style":{padding:0},"header-style":{padding:0}},{header:a(()=>[n(G,{value:d.value,"onUpdate:value":[A[0]||(A[0]=Q=>d.value=Q),Q=>R(ie)],clearable:"",class:"max-w-180px",options:h(So)(h(Vo)),placeholder:"请选择状态"},null,8,["value","options","onUpdate:value"])]),"header-extra":a(()=>[n(h(ae),{class:"mr-16px",onClick:Q=>z(ie)},{icon:a(()=>[n(de,{class:"text-icon"})]),default:a(()=>[B(" 刷新 ")]),_:2},1032,["onClick"]),S(v.value.taskBatchStatus)?(m(),M(h(ae),{key:0,onClick:A[1]||(A[1]=Q=>E(v.value))},{icon:a(()=>[n(ke,{class:"text-icon"})]),default:a(()=>[B(" 重试 ")]),_:1})):T("",!0)]),default:a(()=>[n(ze,{class:"mt-16px","row-data":v.value,onShowLog:O},null,8,["row-data"])]),_:2},1024)]),_:2},1032,["disabled"])]),_:2},1024)]),_:2},1032,["name","tab"]))),128))]),_:3},8,["value"])):T("",!0)]),_:2},[_.ids&&_.ids.length>1?{name:"footer",fn:a(()=>[n(at,{page:p.value,"onUpdate:page":[A[3]||(A[3]=ie=>p.value=ie),N],class:"text-center","page-size":1,"page-count":_.ids.length},null,8,["page","page-count"])]),key:"0"}:void 0]),1024)]),_:3},8,["show"]),n(ce,{show:c.value,"onUpdate:show":A[5]||(A[5]=ie=>c.value=ie),title:"日志详情","task-data":$.value},null,8,["show","task-data"])],64)}}}),yt=_e(Da,[["__scopeId","data-v-ac0baa2a"]]),Ia={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},Ra=w("path",{fill:"currentColor",d:"M847.9 592H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h605.2L612.9 851c-4.1 5.2-.4 13 6.3 13h72.5c4.9 0 9.5-2.2 12.6-6.1l168.8-214.1c16.5-21 1.6-51.8-25.2-51.8M872 356H266.8l144.3-183c4.1-5.2.4-13-6.3-13h-72.5c-4.9 0-9.5 2.2-12.6 6.1L150.9 380.2c-16.5 21-1.6 51.8 25.1 51.8h696c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8"},null,-1),Ua=[Ra];function La(e,l){return m(),L("svg",Ia,[...Ua])}const Ma={name:"ant-design-swap-outlined",render:La},ja={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},za=w("path",{fill:"currentColor",d:"M752 664c-28.5 0-54.8 10-75.4 26.7L469.4 540.8a160.7 160.7 0 0 0 0-57.6l207.2-149.9C697.2 350 723.5 360 752 360c66.2 0 120-53.8 120-120s-53.8-120-120-120s-120 53.8-120 120c0 11.6 1.6 22.7 4.7 33.3L439.9 415.8C410.7 377.1 364.3 352 312 352c-88.4 0-160 71.6-160 160s71.6 160 160 160c52.3 0 98.7-25.1 127.9-63.8l196.8 142.5c-3.1 10.6-4.7 21.8-4.7 33.3c0 66.2 53.8 120 120 120s120-53.8 120-120s-53.8-120-120-120m0-476c28.7 0 52 23.3 52 52s-23.3 52-52 52s-52-23.3-52-52s23.3-52 52-52M312 600c-48.5 0-88-39.5-88-88s39.5-88 88-88s88 39.5 88 88s-39.5 88-88 88m440 236c-28.7 0-52-23.3-52-52s23.3-52 52-52s52 23.3 52 52s-23.3 52-52 52"},null,-1),Ea=[za];function Aa(e,l){return m(),L("svg",ja,[...Ea])}const Pa={name:"ant-design-share-alt-outlined",render:Aa},Oa={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},qa=w("path",{fill:"currentColor",d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8m0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8m0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8M104 228a56 56 0 1 0 112 0a56 56 0 1 0-112 0m0 284a56 56 0 1 0 112 0a56 56 0 1 0-112 0m0 284a56 56 0 1 0 112 0a56 56 0 1 0-112 0"},null,-1),Ya=[qa];function Ha(e,l){return m(),L("svg",Oa,[...Ya])}const Fa={name:"ant-design-unordered-list-outlined",render:Ha},Wa={class:"add-node-btn-box"},Xa={class:"add-node-btn"},Ga={class:"add-node-popover-body"},Ja={class:"icon"},Ka=X({name:"AddNode",__name:"add-node",props:{modelValue:{},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:l}){const i=e,u=l,s=t=>{let o={};t===1?o={nodeName:j("workflow.node.task.nodeName"),nodeType:1,conditionNodes:[{nodeName:j("workflow.node.task.conditionNodes.nodeName"),failStrategy:1,priorityLevel:1,workflowNodeStatus:1,jobTask:{jobId:void 0}}],childNode:i.modelValue}:t===2?o={nodeName:j("workflow.node.condition.nodeName"),nodeType:2,conditionNodes:[{nodeName:`${j("workflow.node.condition.conditionNodes.nodeName")} 1`,priorityLevel:1,decision:{expressionType:1,nodeExpression:void 0,logicalCondition:1,defaultDecision:0}},{nodeName:j("workflow.node.condition.conditionNodes.otherNodeName"),priorityLevel:2,decision:{expressionType:1,nodeExpression:"#true",logicalCondition:1,defaultDecision:1}}],childNode:i.modelValue}:t===3&&(o={nodeName:j("workflow.node.callback.nodeName"),nodeType:3,conditionNodes:[{nodeName:j("workflow.node.callback.conditionNodes.nodeName"),workflowNodeStatus:1,callback:{webhook:void 0,contentType:void 0,secret:void 0}}],childNode:i.modelValue}),u("update:modelValue",o)};return(t,o)=>{const c=Ht,r=ae,f=Fa,p=Pa,d=Ma,v=vt;return m(),L("div",Wa,[w("div",Xa,[t.disabled?T("",!0):(m(),M(v,{key:0,placement:"right-end",trigger:"click","overlay-style":{width:"296px"}},{trigger:a(()=>[n(r,{type:"primary",circle:"",strong:""},{default:a(()=>[n(c)]),_:1})]),default:a(()=>[w("div",Ga,[w("ul",Ja,[w("li",null,[n(r,{circle:"",size:"large",onClick:o[0]||(o[0]=g=>s(1))},{default:a(()=>[n(f,{class:"text-20px color-#3296fa"})]),_:1}),w("p",null,D(h(j)("workflow.node.task.nodeName")),1)]),w("li",null,[n(r,{circle:"",size:"large",onClick:o[1]||(o[1]=g=>s(2))},{default:a(()=>[n(p,{class:"text-20px color-#15bc83"})]),_:1}),w("p",null,D(h(j)("workflow.node.condition.nodeName")),1)]),w("li",null,[n(r,{circle:"",size:"large",onClick:o[2]||(o[2]=g=>s(3))},{default:a(()=>[n(d,{class:"text-20px color-#935af6"})]),_:1}),w("p",null,D(h(j)("workflow.node.callback.nodeName")),1)])])])]),_:1}))])])}}}),we=_e(Ka,[["__scopeId","data-v-f9b0541f"]]),wt=e=>(Le("data-v-eeba2f81"),e=e(),Me(),e),Za={class:"node-wrap"},Qa={class:"branch-box"},el={class:"condition-node"},tl={class:"condition-node-box"},ol={class:"popover"},nl={class:"popover-item"},al={class:"popover-item"},ll=["onClick"],sl=["onClick"],il={class:"title"},rl={class:"text color-#3296fa"},dl={key:0},ul={class:"priority-title"},cl={class:"content min-h-72px"},pl={key:0,class:"placeholder"},ml=wt(()=>w("span",{class:"content_label"},"任务名称: ",-1)),fl=wt(()=>w("span",{class:"content_label"},"失败策略: ",-1)),hl=wt(()=>w("div",null,".........",-1)),vl=["onClick"],_l={key:1,class:"top-left-cover-line"},gl={key:2,class:"bottom-left-cover-line"},bl={key:3,class:"top-right-cover-line"},yl={key:4,class:"bottom-right-cover-line"},wl=X({name:"TaskNode",__name:"task-node",props:{modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:l}){const i=e,u=l,s=ge(),t=To(),o=x({});J(()=>i.modelValue,N=>{o.value=N},{immediate:!0});const c=()=>{var _;const N=o.value.conditionNodes.length+1;(_=o.value.conditionNodes)==null||_.push({nodeName:`${j("workflow.node.task.name")} ${N}`,priorityLevel:N,failStrategy:1,workflowNodeStatus:1,jobTask:{jobId:void 0}}),u("update:modelValue",o.value)},r=(N,_)=>{N.childNode?r(N.childNode,_):N.childNode=_},f=N=>{var _;o.value.conditionNodes.length===1?(o.value.childNode&&(o.value.conditionNodes[0].childNode?r(o.value.conditionNodes[0].childNode,o.value.childNode):o.value.conditionNodes[0].childNode=o.value.childNode),ve(()=>{u("update:modelValue",o.value.conditionNodes[0].childNode)})):(_=o.value.conditionNodes)==null||_.splice(N,1)},p=(N,_=1)=>{var A;o.value.conditionNodes[N]=o.value.conditionNodes.splice(N+_,1,o.value.conditionNodes[N])[0],(A=o.value.conditionNodes)==null||A.map((W,P)=>W.priorityLevel=P+1),u("update:modelValue",o.value)},d=x(0),v=x(!1),g=x({}),b=N=>{const _=o.value.conditionNodes[d.value].priorityLevel,A=N.priorityLevel;o.value.conditionNodes[d.value]=N,_!==A&&p(d.value,A-_),u("update:modelValue",o.value)},I=N=>{i.disabled||(d.value=N,g.value=JSON.parse(JSON.stringify(o.value.conditionNodes[N])),v.value=!0)},y=N=>i.disabled?s.type===2?`node-error node-error-${N.taskBatchStatus&&oe[N.taskBatchStatus]?oe[N.taskBatchStatus].name:"default"}`:"node-error":"auto-judge-def auto-judge-hover",k=x(),R=x(),z=x(!1),U=x([]),F=(N,_)=>{var A,W,P,Y;R.value=[],s.type===2?((A=N.jobBatchList)==null||A.sort((C,G)=>C.taskBatchStatus-G.taskBatchStatus).forEach(C=>{var G,de;C.id?(G=R.value)==null||G.push(C.id):C.jobId&&(k.value=(de=C.jobId)==null?void 0:de.toString())}),(W=N.jobTask)!=null&&W.jobId&&(k.value=(Y=(P=N.jobTask)==null?void 0:P.jobId)==null?void 0:Y.toString()),z.value=!0):s.type===1?U.value[_]=!0:I(_)},$=async N=>{const{error:_}=await Ao(N.id,s.id);_||t.success("执行重试成功")},O=async N=>{const{error:_}=await Po(N.id,s.id);_||t.success("停止任务成功")},E=N=>N===4||N===5||N===6,S=N=>N===1||N===2,V=N=>E(N)||S(N);return(N,_)=>{const A=ae,W=bt,P=zt,Y=da,C=Xt,G=Qe,de=gt,ke=Fe,ze=Wt,nt=vt,Ee=Je,at=je;return m(),L("div",Za,[w("div",Qa,[N.disabled?T("",!0):(m(),M(A,{key:0,class:"add-branch",strong:"",type:"success",onClick:c},{default:a(()=>[B(D(h(j)("workflow.node.task.add")),1)]),_:1})),(m(!0),L(se,null,ue(o.value.conditionNodes,(H,le)=>(m(),L("div",{key:le,class:"col-box"},[w("div",el,[w("div",tl,[n(nt,{disabled:h(s).type!==2||!V(H.taskBatchStatus)},{trigger:a(()=>{var ce,ie;return[w("div",{class:Ve(["auto-judge cursor-pointer",y(H)]),onClick:pe=>F(H,le)},[le!=0?(m(),L("div",{key:0,class:"sort-left",onClick:re(pe=>p(le,-1),["stop"])},[n(C)],8,sl)):T("",!0),w("div",il,[w("span",rl,[n(G,{processing:"",dot:"",color:H.workflowNodeStatus===1?"#52c41a":"#ff4d4f"},null,8,["color"]),B("  "+D(H.nodeName)+" ",1),H.id?(m(),L("span",dl," ("+D(H.id)+")",1)):T("",!0)]),w("span",ul,D(h(j)("workflow.node.priority"))+D(H.priorityLevel),1),N.disabled?T("",!0):(m(),M(de,{key:0,class:"close",onClick:re(pe=>f(le),["stop"])},null,8,["onClick"]))]),w("div",cl,[(ce=H.jobTask)!=null&&ce.jobId?T("",!0):(m(),L("div",pl,"请选择任务")),(ie=H.jobTask)!=null&&ie.jobId?(m(),L(se,{key:1},[w("div",null,[ml,n(ke,{class:"max-w-123px"},{default:a(()=>{var pe,Q;return[B(D(`${(pe=H.jobTask)==null?void 0:pe.jobName}(${(Q=H.jobTask)==null?void 0:Q.jobId})`),1)]}),_:2},1024)]),w("div",null,[fl,B(" "+D(h(j)(h(Ut)[H.failStrategy])),1)]),hl],64)):T("",!0)]),le!=o.value.conditionNodes.length-1?(m(),L("div",{key:1,class:"sort-right",onClick:re(pe=>p(le),["stop"])},[n(ze)],8,vl)):T("",!0)],10,ll)]}),default:a(()=>[w("div",ol,[E(H.taskBatchStatus)?(m(),M(A,{key:0,text:"",onClick:ce=>$(H)},{default:a(()=>[w("span",nl,[n(W,{class:"mb-3px text-24px font-bold"}),B(" "+D(h(j)("common.retry")),1)])]),_:2},1032,["onClick"])):T("",!0),S(H.taskBatchStatus)&&E(H.taskBatchStatus)?(m(),M(P,{key:1,vertical:""})):T("",!0),S(H.taskBatchStatus)?(m(),M(A,{key:2,text:"",onClick:ce=>O(H)},{default:a(()=>[w("span",al,[n(Y),B(" "+D(h(j)("common.stop")),1)])]),_:2},1032,["onClick"])):T("",!0)])]),_:2},1032,["disabled"]),h(s).type===2&&H.taskBatchStatus?(m(),M(at,{key:0},{trigger:a(()=>[w("div",{class:"task-error-tip text-24px",style:he({color:h(oe)[H.taskBatchStatus].color})},[n(Ee,{icon:h(oe)[H.taskBatchStatus].icon},null,8,["icon"])],4)]),default:a(()=>[B(" "+D(h(oe)[H.taskBatchStatus].title),1)]),_:2},1024)):T("",!0),n(we,{modelValue:H.childNode,"onUpdate:modelValue":ce=>H.childNode=ce,disabled:N.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])])]),H.childNode?Ce(N.$slots,"default",{key:0,node:H},void 0,!0):T("",!0),le==0?(m(),L("div",_l)):T("",!0),le==0?(m(),L("div",gl)):T("",!0),le==o.value.conditionNodes.length-1?(m(),L("div",bl)):T("",!0),le==o.value.conditionNodes.length-1?(m(),L("div",yl)):T("",!0),h(s).type!==0?(m(),M(ka,{key:5,open:U.value[le],"onUpdate:open":ce=>U.value[le]=ce,"model-value":o.value.conditionNodes[le]},null,8,["open","onUpdate:open","model-value"])):T("",!0)]))),128))]),o.value.conditionNodes.length>1?(m(),M(we,{key:0,modelValue:o.value.childNode,"onUpdate:modelValue":_[0]||(_[0]=H=>o.value.childNode=H),disabled:N.disabled},null,8,["modelValue","disabled"])):T("",!0),h(s).type===0?(m(),M(wa,{key:1,open:v.value,"onUpdate:open":_[1]||(_[1]=H=>v.value=H),modelValue:g.value,"onUpdate:modelValue":_[2]||(_[2]=H=>g.value=H),len:o.value.conditionNodes.length,"onUpdate:len":_[3]||(_[3]=H=>o.value.conditionNodes.length=H),onSave:b},null,8,["open","modelValue","len"])):T("",!0),h(s).type!==0?(m(),M(yt,{key:2,id:k.value,show:z.value,"onUpdate:show":_[4]||(_[4]=H=>z.value=H),ids:R.value},null,8,["id","show","ids"])):T("",!0)])}}}),kl=_e(wl,[["__scopeId","data-v-eeba2f81"]]),Nl={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},$l=w("path",{fill:"currentColor",d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448s448-200.6 448-448S759.4 64 512 64m0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372s372 166.6 372 372s-166.6 372-372 372"},null,-1),xl=w("path",{fill:"currentColor",d:"M464 336a48 48 0 1 0 96 0a48 48 0 1 0-96 0m72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8"},null,-1),Sl=[$l,xl];function Vl(e,l){return m(),L("svg",Nl,[...Sl])}const Cl={name:"ant-design-info-circle-outlined",render:Vl},Bl=w("div",{class:"h-34px lh-34px"},"(",-1),Tl=w("div",{class:"h-34px lh-34px"},")",-1),Gt=X({__name:"dynamic-input",props:{value:{required:!0,default:()=>[]},valueModifiers:{},path:{required:!0},pathModifiers:{}},emits:["update:value","update:path"],setup(e){const l=dt(e,"value"),i=dt(e,"path"),u=()=>({key:"",value:"",type:"string"}),s=[{trigger:["input","blur"],validator(r,f){return!f&&f!==0?new Error("不能为空"):!0}}],t=[{label:"string",value:"string"},{label:"number",value:"number"},{label:"boolean",value:"boolean"}],o=[{label:"true",value:1},{label:"false",value:0}],c=r=>{l.value[r].type==="string"&&(l.value[r].value=""),l.value[r].type==="boolean"&&(l.value[r].value=0),l.value[r].type==="number"&&(l.value[r].value=0)};return(r,f)=>{const p=ye,d=Qo,v=Ot,g=Et,b=Be,I=qt,y=Tn;return m(),M(y,{value:l.value,"onUpdate:value":f[5]||(f[5]=k=>l.value=k),"item-style":"margin-bottom: 0;","on-create":u},{default:a(({index:k})=>[n(I,null,{default:a(()=>[n(d,{span:7,"ignore-path-change":"","show-label":!1,rule:s,path:`${i.value}[${k}].key`},{default:a(()=>[n(p,{value:l.value[k].key,"onUpdate:value":R=>l.value[k].key=R,placeholder:"key",onKeydown:f[0]||(f[0]=Re(re(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"])]),_:2},1032,["path"]),n(v,{span:2,class:"h-34px text-center lh-34px"},{default:a(()=>[B("=")]),_:1}),n(d,{span:7,"ignore-path-change":"","show-label":!1,rule:s,path:`${i.value}[${k}].value`},{default:a(()=>[l.value[k].type==="string"?(m(),M(p,{key:0,value:l.value[k].value,"onUpdate:value":R=>l.value[k].value=R,placeholder:"value",onKeydown:f[1]||(f[1]=Re(re(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"])):T("",!0),l.value[k].type==="number"?(m(),M(g,{key:1,value:l.value[k].value,"onUpdate:value":R=>l.value[k].value=R,class:"w-full",placeholder:"value",onKeydown:f[2]||(f[2]=Re(re(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"])):T("",!0),l.value[k].type==="boolean"?(m(),M(b,{key:2,value:l.value[k].value,"onUpdate:value":R=>l.value[k].value=R,class:"w-full",options:o,placeholder:"value",onKeydown:f[3]||(f[3]=Re(re(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"])):T("",!0)]),_:2},1032,["path"]),n(d,{span:3,class:"ml-12px w-115px","ignore-path-change":"","show-label":!1,path:`${i.value}[${k}].type`},{default:a(()=>[Bl,n(b,{value:l.value[k].type,"onUpdate:value":[R=>l.value[k].type=R,R=>c(k)],class:"mx-3px",options:t,placeholder:"字段类型",onKeydown:f[4]||(f[4]=Re(re(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"]),Tl]),_:2},1032,["path"])]),_:2},1024)]),_:1},8,["value"])}}}),Dl={class:"w-460px flex-center"},Il=X({name:"BranchDrawer",__name:"branch-drawer",props:{open:{type:Boolean,default:!1},len:{default:0},modelValue:{default:()=>({})}},emits:["update:open","save"],setup(e,{emit:l}){const i=e,u=l,s=x(!1),t=x({decision:{logicalCondition:1,expressionType:1,nodeExpression:"",checkContents:[]}});J(()=>i.open,v=>{s.value=v},{immediate:!0}),J(()=>i.modelValue,v=>{t.value=v},{immediate:!0});const o=x(),c=()=>{u("update:open",!1),s.value=!1},r=()=>{var v;(v=o.value)==null||v.validate(g=>{g||(c(),u("save",t.value))}).catch(()=>{var g;return(g=window.$message)==null?void 0:g.warning("请检查表单信息")})},f=x(""),p=async()=>{var b;if(!((b=t.value.decision)!=null&&b.nodeExpression)){f.value="请填写条件表达式";return}const{error:v,data:g}=await Oo(t.value.decision);if(v){f.value="接口请求失败";return}else if(g.key!==1){f.value=g.value||"请检查条件表达式";return}f.value=""},d={decision:{expressionType:[{required:!0,message:"请选择表达式类型",trigger:"change",type:"number"}],nodeExpression:[{required:!0,message:"请填写条件表达式",trigger:"blur"}]}};return(v,g)=>{const b=Be,I=Ze,y=Xe,k=Ke,R=We,z=en,U=Gt,F=ae,$=Ge,O=me,E=fe;return m(),M(E,{show:s.value,"onUpdate:show":g[5]||(g[5]=S=>s.value=S),"display-directive":"if",width:500,onAfterLeave:c},{default:a(()=>[n(O,null,{header:a(()=>[w("div",Dl,[n(et,{modelValue:t.value.nodeName,"onUpdate:modelValue":g[0]||(g[0]=S=>t.value.nodeName=S),class:"mr-16px max-w-320px min-w-320px"},null,8,["modelValue"]),n(b,{value:t.value.priorityLevel,"onUpdate:value":g[1]||(g[1]=S=>t.value.priorityLevel=S),class:"max-w-110px",options:Array(v.len).fill(0).map((S,V)=>({label:"优先级 "+(V+1),value:V+1}))},null,8,["value","options"])])]),footer:a(()=>[n(F,{type:"primary",onClick:r},{default:a(()=>[B("保存")]),_:1}),n(F,{class:"ml-12px",onClick:c},{default:a(()=>[B("取消")]),_:1})]),default:a(()=>[n($,{ref_key:"formRef",ref:o,rules:d,model:t.value,"label-align":"left","label-width":"100px"},{default:a(()=>{var S;return[n(R,{path:"decision.expressionType",label:"表达式类型"},{default:a(()=>[n(k,{value:t.value.decision.expressionType,"onUpdate:value":g[2]||(g[2]=V=>t.value.decision.expressionType=V)},{default:a(()=>[n(y,null,{default:a(()=>[(m(!0),L(se,null,ue(h(Do),V=>(m(),M(I,{key:V.value,label:V.label,value:V.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1}),n(R,{path:"decision.nodeExpression",label:"条件表达式","validation-status":"error",feedback:f.value},{default:a(()=>[n(z,{modelValue:t.value.decision.nodeExpression,"onUpdate:modelValue":g[3]||(g[3]=V=>t.value.decision.nodeExpression=V),placeholder:"请输入条件表达式"},null,8,["modelValue"])]),_:1},8,["feedback"]),n(R,{path:"decision.checkContents",label:"模拟上下文","show-feedback":((S=t.value.decision)==null?void 0:S.checkContents)&&t.value.decision.checkContents.length===0},{default:a(()=>[n(U,{value:t.value.decision.checkContents,"onUpdate:value":g[4]||(g[4]=V=>t.value.decision.checkContents=V),path:"decision.checkContents"},null,8,["value"])]),_:1},8,["show-feedback"]),n(R,{"show-label":!1,"show-feedback":!1},{default:a(()=>[n(F,{type:"primary",ghost:"",block:"",onClick:p},{default:a(()=>[B("校验条件表达式")]),_:1})]),_:1})]}),_:1},8,["model"])]),_:1})]),_:1},8,["show"])}}}),Rl=_e(Il,[["__scopeId","data-v-e7f14d8d"]]),Jt=X({name:"BranchDesc",__name:"branch-desc",props:{modelValue:{default:()=>({})}},setup(e){const l=e,i=x(""),u=x({".cm-line":{fontSize:"18px"},".cm-scroller":{minHeight:"180px",overflowY:"auto",overflowX:"hidden"}}),s=()=>{var g;const t=document.getElementById("branch-desc"),o=t==null?void 0:t.querySelector(".n-descriptions-table"),c=o==null?void 0:o.querySelector("tbody"),r=document.createElement("tr");r.className="n-descriptions-table-row";const f=document.createElement("th");f.className="n-descriptions-table-header",f.innerHTML="条件表达式",f.setAttribute("colspan","4"),r.appendChild(f),c==null||c.insertBefore(r,c==null?void 0:c.childNodes[4]);const d=c.getElementsByClassName("n-descriptions-table-row")[3];(g=d.querySelector(".n-descriptions-table-header"))==null||g.remove();const v=d.querySelector(".n-descriptions-table-content");v.setAttribute("style","padding: 0"),v==null||v.setAttribute("colspan","4")};return Ye(()=>{var t;ve(()=>{s()}),(t=l.modelValue.decision)!=null&&t.nodeExpression&&(i.value=l.modelValue.decision.nodeExpression)}),(t,o)=>{const c=Te,r=De;return m(),M(r,{id:"branch-desc",column:2,"label-placement":"left",bordered:"","label-style":{width:"120px"}},{default:a(()=>[n(c,{label:"节点名称",span:2},{default:a(()=>[B(D(t.modelValue.nodeName),1)]),_:1}),n(c,{label:"表达式类型"},{default:a(()=>{var f;return[B(D(h(At)[(f=t.modelValue.decision)==null?void 0:f.expressionType]),1)]}),_:1}),n(c,{label:"条件表达式",span:2,"content-style":{padding:0}},{default:a(()=>[n(h(tn),{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=f=>i.value=f),readonly:"",disabled:"",theme:u.value,basic:"",lang:h(on)(),extensions:[h(nn)]},null,8,["modelValue","theme","lang","extensions"])]),_:1})]),_:1})}}}),Ul=X({name:"BranchDetail",__name:"branch-detail",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1}},emits:["update:open"],setup(e,{emit:l}){const i=e,u=l,s=x(!1),t=()=>{u("update:open",!1)};return J(()=>i.open,o=>{s.value=o},{immediate:!0}),(o,c)=>{const r=me,f=fe;return m(),M(f,{show:s.value,"onUpdate:show":c[0]||(c[0]=p=>s.value=p),placement:"right",width:500,"display-directive":"if",onAfterLeave:t},{default:a(()=>[n(r,{title:"决策详情"},{default:a(()=>[s.value?(m(),M(Jt,{key:0,"model-value":o.modelValue},null,8,["model-value"])):T("",!0)]),_:1})]),_:1},8,["show"])}}}),Ll=e=>(Le("data-v-61d296a2"),e=e(),Me(),e),Ml={class:"branch-wrap"},jl={class:"branch-box-wrap"},zl={class:"branch-box"},El={class:"condition-node"},Al={class:"condition-node-box"},Pl=["onClick"],Ol=["onClick"],ql={class:"title"},Yl={class:"node-title"},Hl={key:0},Fl={class:"priority-title"},Wl={class:"content"},Xl=["innerHTML"],Gl={key:1,class:"placeholder"},Jl=["onClick"],Kl={key:1,class:"top-left-cover-line"},Zl={key:2,class:"bottom-left-cover-line"},Ql={key:3,class:"top-right-cover-line"},es={key:4,class:"bottom-right-cover-line"},ts=Ll(()=>w("div",{class:"header-border"},[w("span",{class:"pl-12px"},"决策节点详情")],-1)),os=X({name:"BranchNode",__name:"branch-node",props:{modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:l}){const i=e,u=l,s=ge(),t=x({});J(()=>i.modelValue,$=>{t.value=$},{immediate:!0});const o=()=>{const $=t.value.conditionNodes.length;t.value.conditionNodes.splice(-1,0,{nodeName:`${j("workflow.node.condition.conditionNodes.nodeName")} ${$}`,priorityLevel:$,decision:{expressionType:1,nodeExpression:void 0,logicalCondition:1,defaultDecision:0}}),t.value.conditionNodes[$].priorityLevel=$+1},c=($,O)=>{$.childNode?c($.childNode,O):$.childNode=O},r=$=>{var O;(O=t.value.conditionNodes)==null||O.splice($,1),t.value.conditionNodes.length===1&&(t.value.childNode&&(t.value.conditionNodes[0].childNode?c(t.value.conditionNodes[0].childNode,t.value.childNode):t.value.conditionNodes[0].childNode=t.value.childNode),ve(()=>{u("update:modelValue",t.value.conditionNodes[0].childNode)}))},f=($,O=1)=>{var E;t.value.conditionNodes[$]=t.value.conditionNodes.splice($+O,1,t.value.conditionNodes[$])[0],(E=t.value.conditionNodes)==null||E.map((S,V)=>S.priorityLevel=V+1),u("update:modelValue",t.value)},p=($,O)=>{const{nodeName:E,decision:S}=$.conditionNodes[O],{expressionType:V,nodeExpression:N}=S;return N?E!==j("workflow.node.condition.conditionNodes.otherNodeName")?`<span class="content_label">${j("workflow.node.condition.conditionNodes.expressionType")}: </span>${At[V]}
<span class="content_label">${j("workflow.node.condition.conditionNodes.nodeExpression")}: </span><span style="display: inline-block; vertical-align: bottom; width: 120px; overflow: hidden; text-overflow: ellipsis">${N}<span/>`:j("workflow.node.condition.conditionNodes.otherNodeTip"):E===j("workflow.node.condition.conditionNodes.otherNodeName")?j("workflow.node.condition.conditionNodes.otherNodeTip"):null},d=x(0),v=x(!1),g=x([]),b=x({}),I=$=>{const O=t.value.conditionNodes[d.value].priorityLevel,E=$.priorityLevel;t.value.conditionNodes[d.value]=$,O!==E&&f(d.value,E-O),u("update:modelValue",t.value)},y=$=>{!i.disabled&&$!==t.value.conditionNodes.length-1?(d.value=$,b.value=JSON.parse(JSON.stringify(t.value.conditionNodes[$])),v.value=!0):s.type!==0&&(g.value[$]=!0)},k=x([]),R=x(""),z=x([]),U=($,O)=>{var E;if(z.value=[],$.nodeName!==j("workflow.node.condition.conditionNodes.otherNodeName"))if(s.type===2){if((E=$.jobBatchList)==null||E.forEach(S=>{var V,N;S.id?(V=z.value)==null||V.push(S.id):S.jobId&&(R.value=(N=S.jobId)==null?void 0:N.toString())}),z.value.length===0){g.value[O]=!0;return}k.value[O]=!0}else s.type===1?g.value[O]=!0:y(O)},F=$=>i.disabled?s.type===2?$.nodeName===j("workflow.node.condition.conditionNodes.otherNodeName")?`node-disabled node-error node-error-${$.taskBatchStatus?oe[$.taskBatchStatus].name:"default"}`:`node-error node-error-${$.taskBatchStatus?oe[$.taskBatchStatus].name:"default"}`:$.nodeName===j("workflow.node.condition.conditionNodes.otherNodeName")?"node-disabled":"node-error":$.nodeName===j("workflow.node.condition.conditionNodes.otherNodeName")?"node-disabled":"auto-judge-def auto-judge-hover";return($,O)=>{const E=ae,S=Xt,V=Qe,N=Cl,_=je,A=gt,W=Wt,P=Je;return m(),L("div",Ml,[w("div",jl,[w("div",zl,[$.disabled?T("",!0):(m(),M(E,{key:0,strong:"",type:"success",class:"add-branch",onClick:o},{default:a(()=>[B(D(h(j)("workflow.node.condition.addBranch")),1)]),_:1})),(m(!0),L(se,null,ue(t.value.conditionNodes,(Y,C)=>(m(),L("div",{key:C,class:"col-box"},[w("div",El,[w("div",Al,[w("div",{class:Ve(["auto-judge",F(Y)]),onClick:G=>U(Y,C)},[C!==0?(m(),L("div",{key:0,class:"sort-left",onClick:re(G=>f(C,-1),["stop"])},[n(S)],8,Ol)):T("",!0),w("div",ql,[w("span",Yl,[n(V,{dot:"",processing:"",color:"#52c41a"}),B("  "+D(Y.nodeName)+" ",1),Y.id&&Y.nodeName!==h(j)("workflow.node.condition.conditionNodes.otherNodeName")?(m(),L("span",Hl,"  ("+D(Y.id)+") ",1)):T("",!0),Y.nodeName===h(j)("workflow.node.condition.conditionNodes.otherNodeName")?(m(),M(_,{key:1},{trigger:a(()=>[n(N,{class:"ml-3px text-16px"})]),default:a(()=>[B(" "+D(h(j)("workflow.node.condition.conditionNodes.otherTip")),1)]),_:1})):T("",!0)]),w("span",Fl,D(h(j)("workflow.node.condition.conditionNodes.priority"))+D(Y.priorityLevel),1),$.disabled?T("",!0):(m(),M(A,{key:0,class:"close",onClick:re(G=>r(C),["stop"])},null,8,["onClick"]))]),w("div",Wl,[p(t.value,C)?(m(),L("span",{key:0,innerHTML:p(t.value,C)},null,8,Xl)):(m(),L("span",Gl,D(h(j)("workflow.node.condition.conditionNodes.conditionTip")),1))]),C!==t.value.conditionNodes.length-2?(m(),L("div",{key:1,class:"sort-right",onClick:re(G=>f(C),["stop"])},[n(W)],8,Jl)):T("",!0),h(s).type===2&&Y.taskBatchStatus?(m(),M(_,{key:2},{trigger:a(()=>[w("div",{class:"error-tip text-24px",style:he({color:h(oe)[Y.taskBatchStatus].color})},[n(P,{icon:h(oe)[Y.taskBatchStatus].icon},null,8,["icon"])],4)]),default:a(()=>[B(" "+D(h(oe)[Y.taskBatchStatus].title),1)]),_:2},1024)):T("",!0)],10,Pl),n(we,{modelValue:Y.childNode,"onUpdate:modelValue":G=>Y.childNode=G,disabled:$.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])])]),Y.childNode?Ce($.$slots,"default",{key:0,node:Y},void 0,!0):T("",!0),C==0?(m(),L("div",Kl)):T("",!0),C==0?(m(),L("div",Zl)):T("",!0),C==t.value.conditionNodes.length-1?(m(),L("div",Ql)):T("",!0),C==t.value.conditionNodes.length-1?(m(),L("div",es)):T("",!0),n(Ul,{open:g.value[C],"onUpdate:open":G=>g.value[C]=G,modelValue:t.value.conditionNodes[C],"onUpdate:modelValue":G=>t.value.conditionNodes[C]=G},null,8,["open","onUpdate:open","modelValue","onUpdate:modelValue"]),n(yt,{id:R.value,show:k.value[C],"onUpdate:show":G=>k.value[C]=G,ids:z.value},{default:a(()=>[ts,n(Jt,{"model-value":t.value.conditionNodes[C]},null,8,["model-value"])]),_:2},1032,["id","show","onUpdate:show","ids"])]))),128))]),n(we,{modelValue:t.value.childNode,"onUpdate:modelValue":O[0]||(O[0]=Y=>t.value.childNode=Y),disabled:$.disabled},null,8,["modelValue","disabled"])]),n(Rl,{open:v.value,"onUpdate:open":O[1]||(O[1]=Y=>v.value=Y),modelValue:b.value,"onUpdate:modelValue":O[2]||(O[2]=Y=>b.value=Y),len:t.value.conditionNodes.length,"onUpdate:len":O[3]||(O[3]=Y=>t.value.conditionNodes.length=Y),onSave:I},null,8,["open","modelValue","len"])])}}}),ns=_e(os,[["__scopeId","data-v-61d296a2"]]),as={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},ls=w("path",{fill:"currentColor",d:"M112 476h160v72H112zm320 0h160v72H432zm320 0h160v72H752z"},null,-1),ss=[ls];function is(e,l){return m(),L("svg",as,[...ss])}const rs={name:"ant-design-dash-outlined",render:is},ds={class:"w-460px flex-center"},us=X({name:"CallbackDrawer",__name:"callback-drawer",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1}},emits:["update:open","save"],setup(e,{emit:l}){const i=e,u=l,s=x(!1),t=x({});J(()=>i.open,p=>{s.value=p},{immediate:!0}),J(()=>i.modelValue,p=>{t.value=p},{immediate:!0});const o=x(),c=()=>{u("update:open",!1),s.value=!1},r=()=>{var p;(p=o.value)==null||p.validate(d=>{d||(c(),u("save",t.value))}).catch(()=>{var d;return(d=window.$message)==null?void 0:d.warning("请检查表单信息")})},f={workflowNodeStatus:[{required:!0,message:"请选择工作流状态",trigger:"change"}],callback:{webhook:[{required:!0,message:"请输入 webhook",trigger:"change"}],contentType:[{required:!0,message:"请选择请求类型",trigger:"change",type:"number"}],secret:[{required:!0,message:"请输入秘钥",trigger:"change"}]}};return(p,d)=>{const v=ye,g=We,b=Be,I=Ze,y=Xe,k=Ke,R=Ge,z=ae,U=me,F=fe;return m(),M(F,{show:s.value,"onUpdate:show":d[5]||(d[5]=$=>s.value=$),"display-directive":"if",width:500,onAfterLeave:c},{default:a(()=>[n(U,null,{header:a(()=>[w("div",ds,[n(et,{modelValue:t.value.nodeName,"onUpdate:modelValue":d[0]||(d[0]=$=>t.value.nodeName=$),class:"mr-16px max-w-320px min-w-320px"},null,8,["modelValue"])])]),footer:a(()=>[n(z,{type:"primary",onClick:r},{default:a(()=>[B("保存")]),_:1}),n(z,{class:"ml-12px",onClick:c},{default:a(()=>[B("取消")]),_:1})]),default:a(()=>[n(R,{ref_key:"formRef",ref:o,model:t.value,rules:f,"label-align":"left","label-width":"100px"},{default:a(()=>[n(g,{path:"callback.webhook",label:"webhook"},{default:a(()=>[n(v,{value:t.value.callback.webhook,"onUpdate:value":d[1]||(d[1]=$=>t.value.callback.webhook=$),placeholder:"请输入 webhook"},null,8,["value"])]),_:1}),n(g,{path:"callback.contentType",label:"请求类型"},{default:a(()=>[n(b,{value:t.value.callback.contentType,"onUpdate:value":d[2]||(d[2]=$=>t.value.callback.contentType=$),options:h(Io),placeholder:"请选择请求类型"},null,8,["value","options"])]),_:1}),n(g,{path:"callback.secret",label:"秘钥"},{default:a(()=>[n(v,{value:t.value.callback.secret,"onUpdate:value":d[3]||(d[3]=$=>t.value.callback.secret=$),placeholder:"请输入秘钥"},null,8,["value"])]),_:1}),n(g,{name:"workflowNodeStatus",label:"工作流状态",rules:[{required:!0,message:"请选择工作流状态",trigger:"change"}]},{default:a(()=>[n(k,{value:t.value.workflowNodeStatus,"onUpdate:value":d[4]||(d[4]=$=>t.value.workflowNodeStatus=$)},{default:a(()=>[n(y,null,{default:a(()=>[(m(!0),L(se,null,ue(h(ht),($,O)=>(m(),M(I,{key:O,label:h(j)($.label),value:$.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])}}}),cs=X({name:"CallbackDetail",__name:"callback-detail",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1}},emits:["update:open"],setup(e,{emit:l}){const i=e,u=l,s=x(!1);J(()=>i.open,o=>{s.value=o},{immediate:!0});const t=()=>{u("update:open",!1)};return(o,c)=>{const r=Te,f=De,p=me,d=fe;return m(),M(d,{show:s.value,"onUpdate:show":c[0]||(c[0]=v=>s.value=v),placement:"right",width:500,"display-directive":"if",onAfterLeave:t},{default:a(()=>[n(p,{title:"工作流详情"},{default:a(()=>[n(f,{column:1,"label-placement":"left",bordered:"","label-style":{width:"120px"}},{default:a(()=>[n(r,{label:"节点名称"},{default:a(()=>[B(D(o.modelValue.nodeName),1)]),_:1}),n(r,{label:"webhook"},{default:a(()=>{var v;return[B(D((v=o.modelValue.callback)==null?void 0:v.webhook),1)]}),_:1}),n(r,{label:"请求类型"},{default:a(()=>{var v;return[B(D(h(ut)[(v=o.modelValue.callback)==null?void 0:v.contentType]),1)]}),_:1}),n(r,{label:"密钥"},{default:a(()=>{var v;return[B(D((v=o.modelValue.callback)==null?void 0:v.secret),1)]}),_:1})]),_:1})]),_:1})]),_:1},8,["show"])}}}),tt=e=>(Le("data-v-84fc8365"),e=e(),Me(),e),ps={class:"node-wrap"},ms={class:"branch-box"},fs={class:"condition-node min-h-230px"},hs={class:"condition-node-box pt-0px"},vs={class:"popover"},_s={class:"popover-item"},gs={class:"popover-item"},bs=tt(()=>w("span",null,"忽略",-1)),ys=["onClick"],ws={class:"title"},ks={class:"text text-#935af6"},Ns={key:0},$s={class:"content min-h-81px"},xs={key:0,class:"placeholder"},Ss={class:"flex justify-between"},Vs=tt(()=>w("span",{class:"content_label"},"Webhook:",-1)),Cs={class:"content_label"},Bs=tt(()=>w("div",null,".........",-1)),Ts={key:1,class:"top-left-cover-line"},Ds={key:2,class:"bottom-left-cover-line"},Is={key:3,class:"top-right-cover-line"},Rs={key:4,class:"bottom-right-cover-line"},Us=tt(()=>w("div",{class:"header-border"},[w("span",{class:"pl-18px"},"回调节点详情")],-1)),Ls=X({name:"CallbackNode",__name:"callback-node",props:{modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:l}){const i=e,u=l,s=ge(),t=x({});J(()=>i.modelValue,z=>{t.value=z},{immediate:!0});const o=(z,U)=>{z.childNode?o(z.childNode,U):z.childNode=U},c=()=>{t.value.childNode&&(t.value.conditionNodes[0].childNode?o(t.value.conditionNodes[0].childNode,t.value.childNode):t.value.conditionNodes[0].childNode=t.value.childNode),ve(()=>{u("update:modelValue",t.value.conditionNodes[0].childNode)})},r=x(0),f=x(!1),p=x(!1),d=x({}),v=z=>{t.value.conditionNodes[r.value]=z,u("update:modelValue",t.value)},g=z=>{s.type===0?(r.value=z,d.value=JSON.parse(JSON.stringify(t.value.conditionNodes[z])),f.value=!0):p.value=!0},b=x(!1),I=x(""),y=x([]),k=(z,U)=>{var F;if(y.value=[],s.type===2){if((F=z.jobBatchList)==null||F.forEach($=>{var O,E;$.id?(O=y.value)==null||O.push($.id):$.jobId&&(I.value=(E=$.jobId)==null?void 0:E.toString())}),y.value.length===0){p.value=!0;return}b.value=!0}else s.type===1?p.value=!0:g(U)},R=z=>i.disabled?s.type===2?`node-error node-error-${z.taskBatchStatus?oe[z.taskBatchStatus].name:"default"}`:"node-error":"auto-judge-def auto-judge-hover";return(z,U)=>{const F=bt,$=ae,O=zt,E=rs,S=Qe,V=gt,N=Fe,_=Je,A=je,W=vt,P=Te,Y=De;return m(),L("div",ps,[w("div",ms,[(m(!0),L(se,null,ue(t.value.conditionNodes,(C,G)=>(m(),L("div",{key:G,class:"col-box"},[w("div",fs,[w("div",hs,[n(W,{disabled:h(s).type!==2||!0},{trigger:a(()=>{var de,ke;return[w("div",{class:Ve(["auto-judge",R(C)]),onClick:ze=>k(C,G)},[w("div",ws,[w("span",ks,[n(S,{processing:"",dot:"",color:C.workflowNodeStatus===1?"#52c41a":"#ff4d4f"},null,8,["color"]),B("  "+D(C.nodeName)+" ",1),C.id?(m(),L("span",Ns," ("+D(C.id)+")",1)):T("",!0)]),z.disabled?T("",!0):(m(),M(V,{key:0,class:"close",onClick:re(c,["stop"])}))]),w("div",$s,[(de=C.callback)!=null&&de.webhook?T("",!0):(m(),L("div",xs,D(h(j)("workflow.node.callback.conditionNodes.webhookTip")),1)),(ke=C.callback)!=null&&ke.webhook?(m(),L(se,{key:1},[w("div",Ss,[Vs,n(N,{class:"w-116px"},{default:a(()=>[B(D(C.callback.webhook),1)]),_:2},1024)]),w("div",null,[w("span",Cs,D(h(j)("workflow.node.callback.conditionNodes.contentType"))+": ",1),B(" "+D(h(ut)[C.callback.contentType]),1)]),Bs],64)):T("",!0)]),h(s).type===2&&C.taskBatchStatus?(m(),M(A,{key:0},{trigger:a(()=>[w("div",{class:"error-tip text-24px",style:he({color:h(oe)[C.taskBatchStatus].color})},[n(_,{icon:h(oe)[C.taskBatchStatus].icon},null,8,["icon"])],4)]),default:a(()=>[B(" "+D(h(oe)[C.taskBatchStatus].title),1)]),_:2},1024)):T("",!0)],10,ys)]}),default:a(()=>[w("div",vs,[n($,{text:""},{default:a(()=>[w("span",_s,[n(F,{class:"mb-3px text-24px font-bold"}),B(" "+D(h(j)("common.retry")),1)])]),_:1}),n(O,{vertical:""}),n($,{text:""},{default:a(()=>[w("span",gs,[n(E,{class:"mb-3px text-24px font-bold"}),bs])]),_:1})])]),_:2},1032,["disabled"]),n(we,{modelValue:C.childNode,"onUpdate:modelValue":de=>C.childNode=de,disabled:z.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])])]),C.childNode?Ce(z.$slots,"default",{key:0,node:C},void 0,!0):T("",!0),G==0?(m(),L("div",Ts)):T("",!0),G==0?(m(),L("div",Ds)):T("",!0),G==t.value.conditionNodes.length-1?(m(),L("div",Is)):T("",!0),G==t.value.conditionNodes.length-1?(m(),L("div",Rs)):T("",!0)]))),128))]),t.value.conditionNodes.length>1?(m(),M(we,{key:0,modelValue:t.value.childNode,"onUpdate:modelValue":U[0]||(U[0]=C=>t.value.childNode=C),disabled:z.disabled},null,8,["modelValue","disabled"])):T("",!0),h(s).type!==0?(m(),M(cs,{key:1,open:p.value,"onUpdate:open":U[1]||(U[1]=C=>p.value=C),modelValue:t.value.conditionNodes[0],"onUpdate:modelValue":U[2]||(U[2]=C=>t.value.conditionNodes[0]=C)},null,8,["open","modelValue"])):T("",!0),n(us,{open:f.value,"onUpdate:open":U[3]||(U[3]=C=>f.value=C),modelValue:d.value,"onUpdate:modelValue":U[4]||(U[4]=C=>d.value=C),onSave:v},null,8,["open","modelValue"]),h(s).type!==0?(m(),M(yt,{key:2,id:I.value,show:b.value,"onUpdate:show":U[5]||(U[5]=C=>b.value=C),ids:y.value},{default:a(()=>[Us,n(Y,{column:1,bordered:"","label-style":{width:"120px"}},{default:a(()=>[n(P,{label:"节点名称"},{default:a(()=>[B(D(t.value.conditionNodes[0].nodeName),1)]),_:1}),n(P,{label:"webhook"},{default:a(()=>{var C;return[B(D((C=t.value.conditionNodes[0].callback)==null?void 0:C.webhook),1)]}),_:1}),n(P,{label:"请求类型"},{default:a(()=>{var C;return[B(D(h(ut)[(C=t.value.conditionNodes[0].callback)==null?void 0:C.contentType]),1)]}),_:1}),n(P,{label:"密钥"},{default:a(()=>{var C;return[B(D((C=t.value.conditionNodes[0].callback)==null?void 0:C.secret),1)]}),_:1})]),_:1})]),_:1},8,["id","show","ids"])):T("",!0)])}}}),Ms=_e(Ls,[["__scopeId","data-v-84fc8365"]]),js=X({name:"NodeWrap",__name:"node-wrap",props:{modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:l}){const i=e,u=l,s=x({});return J(()=>i.modelValue,t=>{s.value=t},{immediate:!0}),J(()=>s.value,t=>{u("update:modelValue",t)}),(t,o)=>{const c=Ro("NodeWrap",!0);return m(),L(se,null,[s.value.nodeType==1?(m(),M(kl,{key:0,modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=r=>s.value=r),disabled:t.disabled},{default:a(r=>[r.node?(m(),M(c,{key:0,modelValue:r.node.childNode,"onUpdate:modelValue":f=>r.node.childNode=f,disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])):T("",!0)]),_:1},8,["modelValue","disabled"])):T("",!0),s.value.nodeType==2?(m(),M(ns,{key:1,modelValue:s.value,"onUpdate:modelValue":o[1]||(o[1]=r=>s.value=r),disabled:t.disabled},{default:a(r=>[r.node?(m(),M(c,{key:0,modelValue:r.node.childNode,"onUpdate:modelValue":f=>r.node.childNode=f,disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])):T("",!0)]),_:1},8,["modelValue","disabled"])):T("",!0),s.value.nodeType==3?(m(),M(Ms,{key:2,modelValue:s.value,"onUpdate:modelValue":o[2]||(o[2]=r=>s.value=r),disabled:t.disabled},{default:a(r=>[r.node?(m(),M(c,{key:0,modelValue:r.node.childNode,"onUpdate:modelValue":f=>r.node.childNode=f,disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])):T("",!0)]),_:1},8,["modelValue","disabled"])):T("",!0),s.value.childNode?(m(),M(c,{key:3,modelValue:s.value.childNode,"onUpdate:modelValue":o[3]||(o[3]=r=>s.value.childNode=r),disabled:t.disabled},null,8,["modelValue","disabled"])):T("",!0)],64)}}}),zs=X({name:"StartDetail",__name:"start-detail",props:{modelValue:{default:()=>({})},open:{type:Boolean,default:!1}},emits:["update:open"],setup(e,{emit:l}){const i=e,u=l,s=x(!1);J(()=>i.open,o=>{s.value=o},{immediate:!0});const t=()=>{u("update:open",!1)};return(o,c)=>{const r=Te,f=De,p=me,d=fe;return m(),M(d,{show:s.value,"onUpdate:show":c[0]||(c[0]=v=>s.value=v),placement:"right",width:500,"display-directive":"if",onAfterLeave:t},{default:a(()=>[n(p,{title:"工作流详情"},{default:a(()=>[n(f,{column:1,"label-placement":"left",bordered:"","label-style":{width:"120px"}},{default:a(()=>[n(r,{label:"工作流名称"},{default:a(()=>[B(D(o.modelValue.workflowName),1)]),_:1}),n(r,{label:"组名称"},{default:a(()=>[B(D(o.modelValue.groupName),1)]),_:1}),n(r,{label:"触发类型"},{default:a(()=>[B(D(h(j)(h(Uo)[o.modelValue.triggerType])),1)]),_:1}),n(r,{label:"触发间隔"},{default:a(()=>[B(D(o.modelValue.triggerInterval)+" "+D(o.modelValue.triggerType===2?"秒":null),1)]),_:1}),n(r,{label:"执行超时时间"},{default:a(()=>[B(D(o.modelValue.executorTimeout)+" 秒",1)]),_:1}),n(r,{label:"阻塞策略"},{default:a(()=>[B(D(h(j)(h(Pt)[o.modelValue.blockStrategy])),1)]),_:1}),n(r,{label:"工作流上下文"},{default:a(()=>[B(D(o.modelValue.wfContext),1)]),_:1}),n(r,{label:"工作流状态"},{default:a(()=>[B(D(h(j)(h(Lt)[o.modelValue.workflowStatus])),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])}}}),Es=X({name:"StartDrawer",__name:"start-drawer",props:{modelValue:{default:()=>({wfContexts:[]})},open:{type:Boolean,default:!1}},emits:["update:open","save"],setup(e,{emit:l}){const i=e,u=l,s=ge();let t="";const o=x(!1),c=x({wfContexts:[]}),r=x([]);J(()=>i.open,I=>{o.value=I},{immediate:!0}),J(()=>i.modelValue,I=>{c.value=I,I.triggerType===2&&(c.value.triggerInterval=Number(I.triggerInterval)),I.workflowName?t=I.workflowName:I.groupName?t=I.groupName:t="请选择组",I.wfContext&&(c.value.wfContext=JSON.parse(I.wfContext),c.value.wfContexts=Lo(I.wfContext))},{immediate:!0});const f=x(),p=()=>{u("update:open",!1),o.value=!1},d=()=>{var I;(I=f.value)==null||I.validate(y=>{y||(c.value.wfContext=JSON.stringify(zo(c.value.wfContexts)||{}),p(),u("save",c.value))}).catch(()=>{var y;return(y=window.$message)==null?void 0:y.warning("请检查表单信息")})};(async()=>{const{data:I,error:y}=await ln();y||(r.value=I)})();const g=I=>{I===3?c.value.triggerInterval="* * * * * ?":I===2&&(c.value.triggerInterval=60)},b={groupName:{required:!0,message:"请选择组"},triggerType:{required:!0,message:"请选择触发类型"},triggerInterval:{required:!0,message:"请输入触发间隔"},executorTimeout:{required:!0,message:"请输入执行超时时间"},blockStrategy:{required:!0,message:"请选择阻塞策略"},workflowStatus:{required:!0,message:"请选择工作流状态"}};return(I,y)=>{const k=Be,R=We,z=Ot,U=Et,F=qt,$=Ze,O=Xe,E=Ke,S=Gt,V=ye,N=Ge,_=ae,A=me,W=fe;return m(),M(W,{show:o.value,"onUpdate:show":y[10]||(y[10]=P=>o.value=P),"display-directive":"if",width:610,onAfterLeave:p},{default:a(()=>[n(A,{title:h(t)},{header:a(()=>[n(et,{modelValue:c.value.workflowName,"onUpdate:modelValue":y[0]||(y[0]=P=>c.value.workflowName=P),class:"max-w-570px min-w-570px"},null,8,["modelValue"])]),footer:a(()=>[n(_,{type:"primary",onClick:d},{default:a(()=>[B("保存")]),_:1}),n(_,{class:"ml-12px",onClick:p},{default:a(()=>[B("取消")]),_:1})]),default:a(()=>[n(N,{ref_key:"formRef",ref:f,model:c.value,rules:b,"label-align":"left","label-width":"100px"},{default:a(()=>[n(R,{path:"groupName",label:"组名称"},{default:a(()=>[n(k,{value:c.value.groupName,"onUpdate:value":y[1]||(y[1]=P=>c.value.groupName=P),placeholder:"请选择组",disabled:h(s).type===0&&h(Ue)(h(s).id),options:r.value.map(P=>({label:P,value:P}))},null,8,["value","disabled","options"])]),_:1}),n(F,{cols:24,"x-gap":"20"},{default:a(()=>[n(z,{span:8},{default:a(()=>[n(R,{path:"triggerType",label:"触发类型"},{default:a(()=>[n(k,{value:c.value.triggerType,"onUpdate:value":[y[2]||(y[2]=P=>c.value.triggerType=P),g],placeholder:"请选择触发类型",options:h(Mo).map(P=>({label:h(j)(P.label),value:P.value}))},null,8,["value","options"])]),_:1})]),_:1}),n(z,{span:16},{default:a(()=>[n(R,{path:"triggerInterval",label:"触发间隔"},{default:a(()=>[c.value.triggerType===3?(m(),M(h(an),{key:0,modelValue:c.value.triggerInterval,"onUpdate:modelValue":y[3]||(y[3]=P=>c.value.triggerInterval=P),placeholder:"请输入Cron表达式"},null,8,["modelValue"])):(m(),M(U,{key:1,value:c.value.triggerInterval,"onUpdate:value":y[4]||(y[4]=P=>c.value.triggerInterval=P),min:1,class:"w-full",placeholder:"请输入触发间隔"},{suffix:a(()=>[B("秒")]),_:1},8,["value"]))]),_:1})]),_:1})]),_:1}),n(F,{cols:24,"x-gap":"20"},{default:a(()=>[n(z,{span:8},{default:a(()=>[n(R,{path:"executorTimeout",label:"执行超时时间"},{default:a(()=>[n(U,{value:c.value.executorTimeout,"onUpdate:value":y[5]||(y[5]=P=>c.value.executorTimeout=P),placeholder:"请输入超时时间",min:1},{suffix:a(()=>[B("秒")]),_:1},8,["value"])]),_:1})]),_:1}),n(z,{span:16},{default:a(()=>[n(R,{path:"blockStrategy",label:"阻塞策略"},{default:a(()=>[n(E,{value:c.value.blockStrategy,"onUpdate:value":y[6]||(y[6]=P=>c.value.blockStrategy=P)},{default:a(()=>[n(O,null,{default:a(()=>[(m(!0),L(se,null,ue(h(jo),(P,Y)=>(m(),M($,{key:Y,label:h(j)(P.label),value:P.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),n(R,{path:"wfContext",label:"工作流上下文","show-feedback":!1},{default:a(()=>[n(S,{value:c.value.wfContexts,"onUpdate:value":y[7]||(y[7]=P=>c.value.wfContexts=P),path:"wfContexts"},null,8,["value"])]),_:1}),n(R,{path:"workflowStatus",label:"节点状态"},{default:a(()=>[n(E,{value:c.value.workflowStatus,"onUpdate:value":y[8]||(y[8]=P=>c.value.workflowStatus=P)},{default:a(()=>[n(O,null,{default:a(()=>[(m(!0),L(se,null,ue(h(ht),(P,Y)=>(m(),M($,{key:Y,label:h(j)(P.label),value:P.value},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["value"])]),_:1}),n(R,{path:"description",label:"描述"},{default:a(()=>[n(V,{value:c.value.description,"onUpdate:value":y[9]||(y[9]=P=>c.value.description=P),type:"textarea",autosize:{minRows:5},placeholder:"请输入描述"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),ot=e=>(Le("data-v-e0e4d99d"),e=e(),Me(),e),As={class:"node-wrap"},Ps={class:"title"},Os={class:"text"},qs={class:"text-#ff943e"},Ys={key:0,class:"content"},Hs=ot(()=>w("span",{class:"content_label"},"组名称: ",-1)),Fs=ot(()=>w("span",{class:"content_label"},"阻塞策略: ",-1)),Ws=ot(()=>w("div",null,".........",-1)),Xs={key:1,class:"content min-h-85px"},Gs=ot(()=>w("span",{class:"placeholder"},"请配置工作流",-1)),Js=[Gs],Ks=X({name:"StartNode",__name:"start-node",props:{modelValue:{default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:l}){const i=e,u=l,s=ge(),t=x({}),o=x({});J(()=>i.modelValue,d=>{o.value=d},{immediate:!0}),J(()=>o.value,d=>{u("update:modelValue",d)}),J(()=>{var d;return(d=o.value)==null?void 0:d.groupName},d=>{d&&s.setJobList(d)},{immediate:!0});const c=x(!1),r=x(!1),f=d=>{o.value=d},p=()=>{s.type===0?(t.value=JSON.parse(JSON.stringify(o.value)),c.value=!0):r.value=!0};return(d,v)=>{const g=Qe,b=Fe,I=Je,y=je;return m(),L("div",As,[w("div",{class:Ve([`${d.disabled?"start-node-disabled":"node-wrap-box-hover"} ${h(s).type===2?"node-error-success":""}`,"node-wrap-box start-node"]),onClick:p},[w("div",Ps,[w("span",Os,[n(g,{dot:"",color:o.value.workflowStatus===1?"#52c41a":"#ff000d"},null,8,["color"]),w("span",qs,"  "+D(o.value.workflowName?`${o.value.workflowName} ${o.value.id?` (${o.value.id})`:""}`:"请选择组"),1)])]),o.value.groupName?(m(),L("div",Ys,[w("div",null,[Hs,n(b,{class:"max-w-132px"},{default:a(()=>[B(D(o.value.groupName),1)]),_:1})]),w("div",null,[Fs,B(" "+D(h(j)(h(Pt)[o.value.blockStrategy])),1)]),Ws])):(m(),L("div",Xs,Js)),h(s).type===2?(m(),M(y,{key:2},{trigger:a(()=>[w("div",{class:"error-tip text-24px",style:he({color:h(oe)[3].color})},[n(I,{icon:h(oe)[3].icon},null,8,["icon"])],4)]),default:a(()=>[B(" "+D(h(oe)[3].title),1)]),_:1})):T("",!0)],2),n(we,{modelValue:o.value.nodeConfig,"onUpdate:modelValue":v[0]||(v[0]=k=>o.value.nodeConfig=k),disabled:d.disabled},null,8,["modelValue","disabled"]),h(s).type!==0?(m(),M(zs,{key:0,open:r.value,"onUpdate:open":v[1]||(v[1]=k=>r.value=k),modelValue:o.value,"onUpdate:modelValue":v[2]||(v[2]=k=>o.value=k)},null,8,["open","modelValue"])):T("",!0),n(Es,{open:c.value,"onUpdate:open":v[3]||(v[3]=k=>c.value=k),modelValue:t.value,"onUpdate:modelValue":v[4]||(v[4]=k=>t.value=k),onSave:f},null,8,["open","modelValue"])])}}}),Zs=_e(Ks,[["__scopeId","data-v-e0e4d99d"]]),Qs={class:"workflow"},ei={class:"workflow-affix"},ti={class:"header"},oi={class:"ml-8px mr-8px text-18px text-#333639 dark:text-#d6d6d6"},ni={key:0,class:"buttons"},ai={key:1,class:"buttons"},li={class:"workflow-body"},si={class:"box-scale"},ii={class:"end-node"},ri=w("div",{class:"end-node-circle"},null,-1),di={class:"end-node-text"},wi=X({name:"SnailWorkflow",__name:"workflow",props:{modelValue:{default:()=>({})},spinning:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","save","cancel"],setup(e,{emit:l}){const i=e,u=l,s=Mt(),t=x(100),o=x({}),c=async()=>{u("save")},r=()=>{u("cancel")};J(()=>i.modelValue,g=>{o.value=g},{immediate:!0}),J(()=>o.value,g=>{u("update:modelValue",g)});const f=g=>{if(t.value+=10*g,g>0){const b=document.querySelector(".workflow-body");b&&(t.value<=160&&b.scrollTo({left:280*t.value/100,behavior:"smooth"}),t.value>160&&b.scrollTo({left:420*t.value/100,behavior:"smooth"}),t.value>200&&b.scrollTo({left:520*t.value/100,behavior:"smooth"}))}t.value<=10?t.value=10:t.value>=300&&(t.value=300)},p=g=>{g.preventDefault(),g.wheelDelta<0?f(-1):f(1)};Ye(()=>{const g=document.querySelector(".workflow");g&&(g.onwheel=b=>p(b))});const d=()=>{const g=document.querySelector(".workflow-design");g&&g.setAttribute("style",`cursor: grabbing; transform: scale(${t.value/100})`)},v=()=>{const g=document.querySelector(".workflow-design");g&&g.setAttribute("style",`cursor: grab; transform: scale(${t.value/100})`)};return(g,b)=>{const I=An,y=ae,k=je,R=Ht,z=pn,U=jt;return m(),L("div",Qs,[w("div",ei,[n(z,{"trigger-top":0,class:"position-sticky z-2"},{default:a(()=>[w("div",ti,[w("div",null,[n(k,null,{trigger:a(()=>[n(y,{size:"small",strong:"",circle:"",onClick:b[0]||(b[0]=F=>f(-1))},{default:a(()=>[n(I)]),_:1})]),default:a(()=>[B(" 缩小 ")]),_:1}),w("span",oi,D(t.value)+"%",1),n(k,null,{trigger:a(()=>[n(y,{size:"small",strong:"",circle:"",onClick:b[1]||(b[1]=F=>f(1))},{default:a(()=>[n(R)]),_:1})]),default:a(()=>[B(" 放大 ")]),_:1})]),g.disabled?T("",!0):(m(),L("div",ni,[n(y,{type:"info",onClick:c},{default:a(()=>[B("保存")]),_:1}),n(y,{class:"ml-16px",onClick:r},{default:a(()=>[B("取消")]),_:1})])),g.disabled&&h(s).buttons?(m(),L("div",ai,[Ce(g.$slots,"buttons")])):T("",!0)])]),_:3}),n(U,{show:g.spinning},{default:a(()=>[w("div",li,[n(h(Ft),{class:"vue-drag","is-draggable":!0,"is-resizable":!1,z:1,onDragging:d,onDragstop:v},{default:a(()=>[w("div",{class:"workflow-design",style:he(`transform: scale(${t.value/100})`)},[w("div",si,[n(Zs,{modelValue:o.value,"onUpdate:modelValue":b[2]||(b[2]=F=>o.value=F),disabled:g.disabled},null,8,["modelValue","disabled"]),o.value.nodeConfig?(m(),M(js,{key:0,modelValue:o.value.nodeConfig,"onUpdate:modelValue":b[3]||(b[3]=F=>o.value.nodeConfig=F),disabled:g.disabled},null,8,["modelValue","disabled"])):T("",!0),w("div",ii,[ri,w("div",di,D(h(j)("workflow.node.endNode")),1)])])],4)]),_:1})])]),_:1},8,["show"])])])}}});export{wi as _,ge as u};
