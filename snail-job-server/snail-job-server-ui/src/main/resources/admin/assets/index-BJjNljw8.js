import{_ as L,a as Z,b as W}from"./search-form.vue_vue_type_script_setup_true_lang-B9DCSIZj.js";import{aM as M,d as V,Z as F,y as O,a0 as E,z as J,A as Q,a as X,$ as t,p as Y,q as ee,o as j,c as P,w as l,f as a,g as U,t as C,h as e,ab as ae,aN as te,D as G,B as A,a8 as ne,a9 as oe,E as se,I as le,H as ie,L as re,r as ue,K as ce,b as de,ah as T,_ as z,a3 as pe,at as me,F as _e,aj as fe}from"./index-D11HRvLC.js";import{_ as ge,u as he,a as ye}from"./table-oGN68_Ra.js";import{b as be}from"./Grid-BEQeOJ6_.js";function ve(i){return M({url:"/namespace/list",method:"get",params:i})}function we(i){return M({url:"/namespace",method:"post",data:i})}function ke(i){return M({url:"/namespace",method:"put",data:i})}const xe=V({name:"NamespaceOperateDrawer",__name:"namespace-operate-drawer",props:F({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:F(["submitted"],["update:visible"]),setup(i,{emit:b}){const r=i,p=b,v=O(),m=E(i,"visible"),{formRef:h,validate:g,restoreValidation:f}=J(),{defaultRequiredRule:y}=Q(),w=X(()=>({add:t("page.namespace.addNamespace"),edit:t("page.namespace.editNamespace")})[r.operateType]),s=Y(N());function N(){return{name:"",uniqueId:""}}const k={name:y,uniqueId:{required:!1,pattern:/^[A-Za-z0-9_-]{1,64}$/,trigger:"change",message:t("page.namespace.form.uniqueIdRule")}};function R(){s.uniqueId=te(32)}function $(){if(r.operateType==="add"){Object.assign(s,N());return}r.operateType==="edit"&&r.rowData&&Object.assign(s,r.rowData)}function S(){m.value=!1}async function q(){var _,d;if(await g(),r.operateType==="add"){const{name:n,uniqueId:o}=s,{error:u}=await we({name:n,uniqueId:o});if(u)return;(_=window.$message)==null||_.success(t("common.addSuccess"))}if(r.operateType==="edit"){const{id:n,name:o,uniqueId:u}=s,{error:x}=await ke({id:n,name:o,uniqueId:u});if(x)return;(d=window.$message)==null||d.success(t("common.updateSuccess"))}await v.getUserInfo(),S(),p("submitted")}return ee(m,()=>{m.value&&($(),f())}),(_,d)=>{const n=G,o=L,u=A,x=ne,D=oe,c=se,K=le,H=ie;return j(),P(ae,{modelValue:m.value,"onUpdate:modelValue":d[2]||(d[2]=I=>m.value=I),title:w.value,onSubmitted:q},{footer:l(()=>[a(H,{size:16},{default:l(()=>[a(u,{onClick:S},{default:l(()=>[U(C(e(t)("common.cancel")),1)]),_:1}),a(u,{type:"primary",onClick:q},{default:l(()=>[U(C(e(t)("common.save")),1)]),_:1})]),_:1})]),default:l(()=>[a(K,{ref_key:"formRef",ref:h,model:s,rules:k},{default:l(()=>[a(c,{label:e(t)("page.namespace.uniqueId"),path:"uniqueId"},{default:l(()=>[a(D,null,{default:l(()=>[a(n,{value:s.uniqueId,"onUpdate:value":d[0]||(d[0]=I=>s.uniqueId=I),disabled:r.operateType==="edit",placeholder:e(t)("page.namespace.form.uniqueId")},null,8,["value","disabled","placeholder"]),a(x,{trigger:"hover"},{trigger:l(()=>[a(u,{type:"default",ghost:"",disabled:r.operateType==="edit",onClick:R},{default:l(()=>[a(o,{class:"text-icon"})]),_:1},8,["disabled"])]),default:l(()=>[U(" "+C(e(t)("common.generateRandomly")),1)]),_:1})]),_:1})]),_:1},8,["label"]),a(c,{label:e(t)("page.namespace.name"),path:"name"},{default:l(()=>[a(n,{value:s.name,"onUpdate:value":d[1]||(d[1]=I=>s.name=I),placeholder:e(t)("page.namespace.form.name")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Ie=V({name:"NamespaceSearch",__name:"namespace-search",props:{model:{required:!0},modelModifiers:{}},emits:F(["reset","search"],["update:model"]),setup(i,{emit:b}){const r=b,p=E(i,"model");function v(){r("reset")}function m(){r("search")}return(h,g)=>{const f=G,y=ge,w=Z;return j(),P(w,{model:p.value,onSearch:m,onReset:v},{default:l(()=>[a(y,{span:"24 s:12 m:6",label:e(t)("page.namespace.keyword"),path:"keyword",class:"pr-24px"},{default:l(()=>[a(f,{value:p.value.keyword,"onUpdate:value":g[0]||(g[0]=s=>p.value.keyword=s),placeholder:e(t)("page.namespace.form.keyword"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])}}}),Ne={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function B(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Object]"&&!fe(i)}const $e=V({name:"namespace",__name:"index",setup(i){const b=re(),r=O(),p=ue(ce.get("namespaceId")),v=n=>{p.value=n,r.setNamespaceId(n)},{columns:m,columnChecks:h,data:g,getData:f,loading:y,mobilePagination:w,searchParams:s,resetSearchParams:N}=he({apiFn:ve,apiParams:{page:1,size:10,keyword:null},columns:()=>[{key:"name",title:t("page.namespace.name"),align:"left",width:120},{key:"status",title:t("common.active"),align:"center",width:40,render:n=>a("div",{class:"flex justify-center"},[p.value===n.uniqueId?a(z,{icon:"material-symbols:check-circle",class:"text-20px color-success"},null):a(z,{icon:"material-symbols:cancel",class:"text-20px color-gray400"},null)])},{key:"uniqueId",title:t("page.namespace.uniqueId"),align:"left",width:180},{key:"createDt",title:t("page.common.createTime"),align:"left",width:130},{key:"updateDt",title:t("page.common.upadteTime"),align:"left",width:130},{key:"operate",title:t("common.operate"),align:"center",width:64,render:n=>{let o,u;return a("div",{class:"flex-center gap-8px"},[a(A,{type:"primary",text:!0,ghost:!0,size:"small",onClick:()=>d(n.id)},B(o=t("common.edit"))?o:{default:()=>[o]}),p.value!==n.uniqueId?a(pe,null,[a(me,{vertical:!0},null),a(A,{type:"warning",text:!0,ghost:!0,size:"small",onClick:()=>v(n.uniqueId)},B(u=t("common.switch"))?u:{default:()=>[u]})]):""])}}]}),{drawerVisible:k,operateType:R,editingData:$,handleAdd:S,handleEdit:q,checkedRowKeys:_}=ye(g,f);function d(n){q(n)}return(n,o)=>{const u=W,x=be,D=_e;return j(),de("div",Ne,[a(Ie,{model:e(s),"onUpdate:model":o[0]||(o[0]=c=>T(s)?s.value=c:null),onReset:e(N),onSearch:e(f)},null,8,["model","onReset","onSearch"]),a(D,{title:e(t)("page.namespace.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper","header-class":"view-card-header"},{"header-extra":l(()=>[a(u,{columns:e(h),"onUpdate:columns":o[1]||(o[1]=c=>T(h)?h.value=c:null),"disabled-delete":e(_).length===0,loading:e(y),"show-delete":!1,onAdd:e(S),onRefresh:e(f)},null,8,["columns","disabled-delete","loading","onAdd","onRefresh"])]),default:l(()=>[a(x,{"checked-row-keys":e(_),"onUpdate:checkedRowKeys":o[2]||(o[2]=c=>T(_)?_.value=c:null),columns:e(m),data:e(g),"flex-height":!e(b).isMobile,"scroll-x":962,loading:e(y),remote:"","row-key":c=>c.id,pagination:e(w),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),a(xe,{visible:e(k),"onUpdate:visible":o[3]||(o[3]=c=>T(k)?k.value=c:null),"operate-type":e(R),"row-data":e($),onSubmitted:e(f)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1},8,["title"])])}}});export{$e as default};
